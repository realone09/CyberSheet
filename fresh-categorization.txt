npm warn Unknown global config "tmp". This will stop working in the next major version of npm.

> cyber-sheet-excel-monorepo@0.1.0 test
> jest --passWithNoTests --config jest.config.js

ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
(node:75181) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/test/CellLayout.test.ts
  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ single-line text ‚Ä∫ should align to top when valign is "top"

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      14 |       it('should align to top when valign is "top"', () => {
      15 |         const offset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 16 |         expect(offset).toBe(paddingTop);
         |                        ^
      17 |       });
      18 |
      19 |       it('should align to middle when valign is "middle"', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:16:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ single-line text ‚Ä∫ should align to middle when valign is "middle"

    expect(received).toBe(expected) // Object.is equality

    Expected: 6
    Received: 17

      20 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      21 |         const expected = (cellHeight - contentHeight) / 2;
    > 22 |         expect(offset).toBe(expected);
         |                        ^
      23 |       });
      24 |
      25 |       it('should align to bottom when valign is "bottom"', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:22:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ single-line text ‚Ä∫ should align to bottom when valign is "bottom"

    expect(received).toBe(expected) // Object.is equality

    Expected: 8
    Received: 20

      26 |         const offset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      27 |         const expected = cellHeight - contentHeight - paddingBottom;
    > 28 |         expect(offset).toBe(expected);
         |                        ^
      29 |       });
      30 |
      31 |       it('should default to bottom when valign is undefined', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:28:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ single-line text ‚Ä∫ should default to bottom when valign is undefined

    expect(received).toBe(expected) // Object.is equality

    Expected: 8
    Received: 20

      32 |         const offset = computeVerticalOffset(undefined, cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      33 |         const expected = cellHeight - contentHeight - paddingBottom;
    > 34 |         expect(offset).toBe(expected);
         |                        ^
      35 |       });
      36 |     });
      37 |

      at Object.<anonymous> (test/CellLayout.test.ts:34:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ wrapped text (multi-line) ‚Ä∫ should align to top when valign is "top"

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      44 |       it('should align to top when valign is "top"', () => {
      45 |         const offset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 46 |         expect(offset).toBe(paddingTop);
         |                        ^
      47 |       });
      48 |
      49 |       it('should center multi-line content when valign is "middle"', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:46:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ wrapped text (multi-line) ‚Ä∫ should center multi-line content when valign is "middle"

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: 44

      50 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      51 |         const expected = (cellHeight - contentHeight) / 2;
    > 52 |         expect(offset).toBe(expected);
         |                        ^
      53 |       });
      54 |
      55 |       it('should align to bottom when valign is "bottom"', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:52:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ wrapped text (multi-line) ‚Ä∫ should align to bottom when valign is "bottom"

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 44

      56 |         const offset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      57 |         const expected = cellHeight - contentHeight - paddingBottom;
    > 58 |         expect(offset).toBe(expected);
         |                        ^
      59 |       });
      60 |     });
      61 |

      at Object.<anonymous> (test/CellLayout.test.ts:58:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ edge cases ‚Ä∫ should handle content taller than cell (no negative offset)

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      66 |         
      67 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 68 |         expect(topOffset).toBe(paddingTop);
         |                           ^
      69 |
      70 |         const middleOffset = computeVerticalOffset('middle', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      71 |         // When content > cell, middle produces negative offset, but still valid

      at Object.<anonymous> (test/CellLayout.test.ts:68:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ edge cases ‚Ä∫ should handle zero cell height

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      83 |
      84 |         const offset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 85 |         expect(offset).toBe(paddingTop);
         |                        ^
      86 |       });
      87 |
      88 |       it('should handle exact fit (content equals cell minus padding)', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:85:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ edge cases ‚Ä∫ should handle exact fit (content equals cell minus padding)

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      91 |
      92 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 93 |         expect(topOffset).toBe(paddingTop);
         |                           ^
      94 |
      95 |         const bottomOffset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      96 |         expect(bottomOffset).toBe(paddingTop); // Should equal top when exact fit

      at Object.<anonymous> (test/CellLayout.test.ts:93:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different cell dimensions ‚Ä∫ should handle standard Excel row height (20.25px)

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      120 |         
      121 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 122 |         expect(topOffset).toBe(paddingTop);
          |                           ^
      123 |
      124 |         const middleOffset = computeVerticalOffset('middle', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      125 |         expect(middleOffset).toBeCloseTo((cellHeight - contentHeight) / 2, 2);

      at Object.<anonymous> (test/CellLayout.test.ts:122:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different cell dimensions ‚Ä∫ should handle tall cells (e.g., merged or manually resized)

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      133 |         
      134 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 135 |         expect(topOffset).toBe(paddingTop);
          |                           ^
      136 |
      137 |         const middleOffset = computeVerticalOffset('middle', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      138 |         expect(middleOffset).toBe((cellHeight - contentHeight) / 2);

      at Object.<anonymous> (test/CellLayout.test.ts:135:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different cell dimensions ‚Ä∫ should handle small cells

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      147 |         const cellHeight = 10;
      148 |         const offset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 149 |         expect(offset).toBe(paddingTop);
          |                        ^
      150 |       });
      151 |     });
      152 |

      at Object.<anonymous> (test/CellLayout.test.ts:149:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different font sizes and padding ‚Ä∫ should handle large font size

    expect(received).toBe(expected) // Object.is equality

    Expected: 8
    Received: 31

      159 |
      160 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, largeFontSize, paddingTop, paddingBottom);
    > 161 |         expect(offset).toBe((cellHeight - contentHeight) / 2);
          |                        ^
      162 |       });
      163 |
      164 |       it('should handle small font size', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:161:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different font sizes and padding ‚Ä∫ should handle small font size

    expect(received).toBe(expected) // Object.is equality

    Expected: 16
    Received: 23

      167 |
      168 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, smallFontSize, paddingTop, paddingBottom);
    > 169 |         expect(offset).toBe((cellHeight - contentHeight) / 2);
          |                        ^
      170 |       });
      171 |
      172 |       it('should respect custom padding values', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:169:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different font sizes and padding ‚Ä∫ should respect custom padding values

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 22

      176 |
      177 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, customPaddingTop, customPaddingBottom);
    > 178 |         expect(topOffset).toBe(customPaddingTop);
          |                           ^
      179 |
      180 |         const bottomOffset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, customPaddingTop, customPaddingBottom);
      181 |         expect(bottomOffset).toBe(cellHeight - contentHeight - customPaddingBottom);

      at Object.<anonymous> (test/CellLayout.test.ts:178:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different font sizes and padding ‚Ä∫ should handle zero padding

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: 12

      186 |
      187 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, 0, 0);
    > 188 |         expect(topOffset).toBe(0);
          |                           ^
      189 |
      190 |         const bottomOffset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, 0, 0);
      191 |         expect(bottomOffset).toBe(cellHeight - contentHeight);

      at Object.<anonymous> (test/CellLayout.test.ts:188:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ Excel compatibility ‚Ä∫ should match Excel default alignment (bottom with Excel padding)

    expect(received).toBeCloseTo(expected, precision)

    Expected: 1.583333333333334
    Received: 16.666666666666664

    Expected precision:    2
    Expected difference: < 0.005
    Received difference:   15.08333333333333

      202 |         const offset = computeVerticalOffset(undefined, excelRowHeight, contentHeight, excelFontSize, 2, 4);
      203 |         const expected = excelRowHeight - contentHeight - 4;
    > 204 |         expect(offset).toBeCloseTo(expected, 2);
          |                        ^
      205 |       });
      206 |
      207 |       it('should match Excel middle alignment calculation', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:204:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ Excel compatibility ‚Ä∫ should match Excel middle alignment calculation

    expect(received).toBe(expected) // Object.is equality

    Expected: 9
    Received: 20

      211 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, 12, 2, 4);
      212 |         // Excel centers ignoring padding
    > 213 |         expect(offset).toBe((cellHeight - contentHeight) / 2);
          |                        ^
      214 |       });
      215 |     });
      216 |

      at Object.<anonymous> (test/CellLayout.test.ts:213:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ boundary conditions ‚Ä∫ should handle fractional pixel values

    expect(received).toBeCloseTo(expected, precision)

    Expected: 4.125
    Received: 15.625

    Expected precision:    2
    Expected difference: < 0.005
    Received difference:   11.5

      221 |
      222 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, 12, 2, 4);
    > 223 |         expect(offset).toBeCloseTo((cellHeight - contentHeight) / 2, 2);
          |                        ^
      224 |       });
      225 |
      226 |       it('should handle very large cells', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:223:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ boundary conditions ‚Ä∫ should handle very large cells

    expect(received).toBe(expected) // Object.is equality

    Expected: 984
    Received: 996

      229 |
      230 |         const bottomOffset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 231 |         expect(bottomOffset).toBe(cellHeight - contentHeight - paddingBottom);
          |                              ^
      232 |         expect(bottomOffset).toBeGreaterThan(900);
      233 |       });
      234 |

      at Object.<anonymous> (test/CellLayout.test.ts:231:30)

(node:75098) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/src/formatting/__tests__/NumberFormatter.test.ts
  ‚óè Console

    console.log
        ‚è±Ô∏è  Single format: 1.457¬µs per call

      at Object.<anonymous> (src/formatting/__tests__/NumberFormatter.test.ts:321:15)

    console.log
        ‚è±Ô∏è  10,000 formats: 9.85ms

      at Object.<anonymous> (src/formatting/__tests__/NumberFormatter.test.ts:341:15)

    console.log
        ‚è±Ô∏è  10,000 mixed formats: 23.52ms

      at Object.<anonymous> (src/formatting/__tests__/NumberFormatter.test.ts:361:15)

  ‚óè NumberFormatter ‚Ä∫ Performance: Precompiled Intl Formatters ‚Ä∫ should format single value in <0.5¬µs (target: <1¬µs)

    expect(received).toBeLessThan(expected)

    Expected: < 1
    Received:   1.456843999999819

      322 |       
      323 |       // Target: <1¬µs per call (achievable with precompiled formatters)
    > 324 |       expect(perCall).toBeLessThan(1.0);
          |                       ^
      325 |     });
      326 |   });
      327 |   

      at Object.<anonymous> (src/formatting/__tests__/NumberFormatter.test.ts:324:23)

  ‚óè NumberFormatter ‚Ä∫ Performance: Large Grid Fast Scroll ‚Ä∫ should handle mixed formats efficiently

    expect(received).toBeLessThan(expected)

    Expected: < 10
    Received:   23.52401400000008

      361 |       console.log(`  ‚è±Ô∏è  10,000 mixed formats: ${elapsed.toFixed(2)}ms`);
      362 |       
    > 363 |       expect(elapsed).toBeLessThan(10.0); // Allow slightly more time for mixed formats
          |                       ^
      364 |     });
      365 |   });
      366 |   

      at Object.<anonymous> (src/formatting/__tests__/NumberFormatter.test.ts:363:23)

(node:75169) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/error-strategy-enforcement.test.ts
  ‚óè Console

    console.log
      
      ‚úÖ ErrorStrategy Distribution:

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:446:13)

    console.log
         SKIP_ERRORS: 54 functions (~28%)

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:447:13)

    console.log
         LAZY_EVALUATION: 5 functions (~3%)

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:448:13)

    console.log
         SHORT_CIRCUIT: 2 functions (<1%)

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:449:13)

    console.log
         LOOKUP_STRICT: 7 functions (~4%)

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:450:13)

    console.log
         FINANCIAL_STRICT: 19 functions (~10%)

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:451:13)

    console.log
         PROPAGATE_FIRST: 107 functions (~55%)

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:452:13)

    console.log
         TOTAL: 194 functions validated

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:453:13)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.SKIP_ERRORS - Aggregations ‚Ä∫ Metadata: COUNT has SKIP_ERRORS strategy

    expect(received).toBeDefined()

    Received: undefined

      74 |     test('Metadata: COUNT has SKIP_ERRORS strategy', () => {
      75 |       const countMeta = STATISTICAL_METADATA.find(m => m.name === 'COUNT');
    > 76 |       expect(countMeta).toBeDefined();
         |                         ^
      77 |       expect(countMeta?.errorStrategy).toBe(ErrorStrategy.SKIP_ERRORS);
      78 |     });
      79 |

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:76:25)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.SKIP_ERRORS - Aggregations ‚Ä∫ Metadata: COUNTA has SKIP_ERRORS strategy

    expect(received).toBeDefined()

    Received: undefined

      80 |     test('Metadata: COUNTA has SKIP_ERRORS strategy', () => {
      81 |       const countaMeta = STATISTICAL_METADATA.find(m => m.name === 'COUNTA');
    > 82 |       expect(countaMeta).toBeDefined();
         |                          ^
      83 |       expect(countaMeta?.errorStrategy).toBe(ErrorStrategy.SKIP_ERRORS);
      84 |     });
      85 |

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:82:26)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.SKIP_ERRORS - Aggregations ‚Ä∫ Metadata: SUMIF has SKIP_ERRORS strategy

    expect(received).toBeDefined()

    Received: undefined

      104 |     test('Metadata: SUMIF has SKIP_ERRORS strategy', () => {
      105 |       const sumifMeta = MATH_METADATA.find(m => m.name === 'SUMIF');
    > 106 |       expect(sumifMeta).toBeDefined();
          |                         ^
      107 |       expect(sumifMeta?.errorStrategy).toBe(ErrorStrategy.SKIP_ERRORS);
      108 |     });
      109 |

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:106:25)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.SKIP_ERRORS - Aggregations ‚Ä∫ All SKIP_ERRORS functions are aggregations

    expect(received).toBeTruthy()

    Received: false

      132 |           'AVEDEV', 'DEVSQ', 'CORREL', 'PEARSON', 'COVARIANCE.P', 'COVARIANCE.S',
      133 |           'RSQ', 'STEYX', 'STDEVA', 'STDEVPA', 'VARA', 'VARPA', 'MAXA', 'MINA'
    > 134 |         ].some(name => func.name.toUpperCase().includes(name))).toBeTruthy();
          |                                                                 ^
      135 |       });
      136 |     });
      137 |   });

      at __tests__/error-strategy-enforcement.test.ts:134:65
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:125:23)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.LAZY_EVALUATION - Conditionals ‚Ä∫ Metadata: CHOOSE has LAZY_EVALUATION strategy

    expect(received).toBeDefined()

    Received: undefined

      174 |     test('Metadata: CHOOSE has LAZY_EVALUATION strategy', () => {
      175 |       const chooseMeta = LOGICAL_METADATA.find(m => m.name === 'CHOOSE');
    > 176 |       expect(chooseMeta).toBeDefined();
          |                          ^
      177 |       expect(chooseMeta?.errorStrategy).toBe(ErrorStrategy.LAZY_EVALUATION);
      178 |     });
      179 |

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:176:26)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.LAZY_EVALUATION - Conditionals ‚Ä∫ All LAZY_EVALUATION functions are conditionals

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 6
    Received:    5

      182 |       
      183 |       // Should have ~9 LAZY_EVALUATION functions
    > 184 |       expect(lazyFuncs.length).toBeGreaterThanOrEqual(6);
          |                                ^
      185 |       expect(lazyFuncs.length).toBeLessThanOrEqual(12);
      186 |       
      187 |       // All should be conditional-type functions

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:184:32)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.LOOKUP_STRICT - Lookup Functions ‚Ä∫ All 12 lookup functions have LOOKUP_STRICT strategy

    expect(received).toBe(expected) // Object.is equality

    Expected: 12
    Received: 7

      271 |       
      272 |       // Should have exactly 12 LOOKUP_STRICT functions
    > 273 |       expect(lookupStrictFuncs.length).toBe(12);
          |                                        ^
      274 |       
      275 |       // All should be in LOOKUP category
      276 |       lookupStrictFuncs.forEach(func => {

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:273:40)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.PROPAGATE_FIRST - Standard Functions ‚Ä∫ PROPAGATE_FIRST is the most common strategy

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 150
    Received:    107

      370 |       
      371 |       // Should have ~178 PROPAGATE_FIRST functions (default behavior)
    > 372 |       expect(propagateFuncs.length).toBeGreaterThanOrEqual(150);
          |                                     ^
      373 |       expect(propagateFuncs.length).toBeLessThanOrEqual(200);
      374 |     });
      375 |   });

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:372:37)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy Distribution Consistency ‚Ä∫ LAZY_EVALUATION: All conditionals use this strategy

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 6
    Received:    5

      393 |       
      394 |       // Should be ~3% of total functions (9/279)
    > 395 |       expect(lazyFuncs.length).toBeGreaterThanOrEqual(6);
          |                                ^
      396 |       expect(lazyFuncs.length).toBeLessThanOrEqual(12);
      397 |     });
      398 |

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:395:32)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy Distribution Consistency ‚Ä∫ LOOKUP_STRICT: All lookup functions use this strategy

    expect(received).toBe(expected) // Object.is equality

    Expected: 12
    Received: 7

      409 |       
      410 |       // Should be ~4% of total functions (12/279)
    > 411 |       expect(lookupStrictFuncs.length).toBe(12);
          |                                        ^
      412 |     });
      413 |
      414 |     test('FINANCIAL_STRICT: ALL financial functions use this strategy', () => {

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:411:40)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy Distribution Consistency ‚Ä∫ PROPAGATE_FIRST: Most functions use this strategy

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 150
    Received:    107

      424 |       
      425 |       // Should be ~64% of total functions (178/279)
    > 426 |       expect(propagateFuncs.length).toBeGreaterThanOrEqual(150);
          |                                     ^
      427 |       expect(propagateFuncs.length).toBeLessThanOrEqual(200);
      428 |     });
      429 |   });

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:426:37)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy Enforcement: Summary

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 6
    Received:    5

      460 |     expect(skipErrors).toBeGreaterThanOrEqual(50);
      461 |     expect(skipErrors).toBeLessThanOrEqual(70);
    > 462 |     expect(lazyEval).toBeGreaterThanOrEqual(6);
          |                      ^
      463 |     expect(lazyEval).toBeLessThanOrEqual(12);
      464 |     expect(shortCircuit).toBe(2);
      465 |     expect(lookupStrict).toBe(12);

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:462:22)

[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
(node:75160) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/autocomplete/FormulaAutocomplete.test.ts
  ‚óè FormulaAutocomplete ‚Ä∫ Basic Autocomplete ‚Ä∫ getSuggestions returns suggestions for "SU"

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Basic Autocomplete ‚Ä∫ getSuggestions returns XLOOKUP for "XLOOK"

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Basic Autocomplete ‚Ä∫ getSuggestions returns FILTER for "FIL"

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Basic Autocomplete ‚Ä∫ getSuggestions handles empty input

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Basic Autocomplete ‚Ä∫ getSuggestions is case insensitive

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Match Types and Ranking ‚Ä∫ exact match has highest score

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Match Types and Ranking ‚Ä∫ startsWith match has high score

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Match Types and Ranking ‚Ä∫ contains match has medium score

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Match Types and Ranking ‚Ä∫ suggestions are sorted by match score

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Match Types and Ranking ‚Ä∫ startsWith is prioritized over contains

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Fuzzy Matching ‚Ä∫ fuzzy match for typo "XLOKUP" suggests XLOOKUP

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Fuzzy Matching ‚Ä∫ fuzzy match for "FITER" suggests FILTER

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Fuzzy Matching ‚Ä∫ fuzzy threshold controls strictness

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ suggestion includes function name

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ suggestion includes category

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ suggestion includes description

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ suggestion includes syntax

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ syntax includes argument information

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ suggestion includes minArgs and maxArgs

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Filtering ‚Ä∫ includeCategory filters to specific categories

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Filtering ‚Ä∫ excludeCategory filters out specific categories

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Filtering ‚Ä∫ includeCategory with multiple categories

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Options and Limits ‚Ä∫ maxSuggestions limits results

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Options and Limits ‚Ä∫ default maxSuggestions is 10

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Options and Limits ‚Ä∫ maxSuggestions can return more than 10

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Browsing ‚Ä∫ getSuggestionsByCategory returns functions in category

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Browsing ‚Ä∫ getSuggestionsByCategory respects limit

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Browsing ‚Ä∫ getSuggestionsByCategory returns alphabetically sorted

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Common Use Cases ‚Ä∫ typing "=SU" suggests SUM family functions

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Common Use Cases ‚Ä∫ typing "=IF" suggests IF family functions

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Common Use Cases ‚Ä∫ typing "=XL" suggests XLOOKUP

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Common Use Cases ‚Ä∫ typing "=LAM" suggests LAMBDA

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Common Use Cases ‚Ä∫ typing "=DAT" suggests DATE functions

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Financial Functions Autocomplete ‚Ä∫ typing "=NP" suggests NPV or NPER

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Financial Functions Autocomplete ‚Ä∫ typing "=RATE" finds RATE function

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Financial Functions Autocomplete ‚Ä∫ all 13 financial functions are available

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Custom Descriptions ‚Ä∫ setDescription updates function description

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Custom Descriptions ‚Ä∫ setDescription is case insensitive

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Edge Cases ‚Ä∫ handles single character input

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Edge Cases ‚Ä∫ handles very long input

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Edge Cases ‚Ä∫ handles special characters gracefully

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Edge Cases ‚Ä∫ handles numeric input

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Performance ‚Ä∫ autocomplete completes within reasonable time

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Performance ‚Ä∫ handles large result sets efficiently

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
(node:75083) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/renderer-canvas/__tests__/pipeline-performance.test.ts
  ‚óè Console

    console.log
      
      üìä Formatting Performance (10k cells):

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:70:15)

    console.log
         Time: 25.04ms

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:71:15)

    console.log
         Budget: <3.33ms (20% of 16.67ms frame)

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:72:15)

    console.log
         Per cell: 2.504¬µs

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:73:15)

    console.log
         Status: ‚ùå FAIL

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:74:15)

    console.log
      
      üìä Mixed Format Performance (5000 cells):

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:150:15)

    console.log
         Total: 29.08ms

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:151:15)

    console.log
         Per cell: 5.817¬µs

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:152:15)

    console.log
         Format types: 20 unique formats

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:153:15)

    console.log
         Registered: 16 (spec-based)

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:154:15)

    console.log
         Fallback: 4 (runtime interpreter)

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:155:15)

    console.log
         Status: ‚ùå FAIL

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:156:15)

    console.log
      
      üìä Fast Scroll Simulation (10 frames √ó 600 cells):

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:232:15)

    console.log
         Avg frame format: 0.99ms

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:233:15)

    console.log
         Min frame: 0.93ms

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:234:15)

    console.log
         Max frame: 1.18ms

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:235:15)

    console.log
         Budget: <3.33ms (20% of frame)

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:236:15)

    console.log
         Pass rate: 100% (10/10)

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:237:15)

    console.log
         Status: ‚úÖ PASS

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:238:15)

    console.log
      
      üìä Regression Detection (1000 cells √ó 5 iterations):

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:289:15)

    console.log
         Avg iteration: 2.15ms

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:290:15)

    console.log
         Per cell: 2.152¬µs

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:291:15)

    console.log
         Baseline: ~0.868¬µs (from NumberFormatter unit tests)

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:292:15)

    console.log
         Threshold: <1.0¬µs

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:293:15)

    console.log
         Status: ‚ùå FAIL - REGRESSION!

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:294:15)

  ‚óè Pipeline Performance: Formatting Stack ‚Ä∫ 10k Cell Formatting (Fast Scroll Simulation) ‚Ä∫ should format 10,000 mixed cells in <3.3ms (20% frame budget)

    expect(received).toBeLessThan(expected)

    Expected: < 3.3340000000000005
    Received:   25.0416409999998

      74 |       console.log(`   Status: ${formatTime < FORMAT_BUDGET_MS ? '‚úÖ PASS' : '‚ùå FAIL'}`);
      75 |       
    > 76 |       expect(formatTime).toBeLessThan(FORMAT_BUDGET_MS);
         |                          ^
      77 |     });
      78 |     
      79 |     it('should maintain <1¬µs per cell under mixed format load', () => {

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:76:26)

  ‚óè Pipeline Performance: Formatting Stack ‚Ä∫ 10k Cell Formatting (Fast Scroll Simulation) ‚Ä∫ should maintain <1¬µs per cell under mixed format load

    expect(received).toBeLessThan(expected)

    Expected: < 1
    Received:   5.816603000000032

      157 |       
      158 |       // Each cell should format in <1¬µs on average
    > 159 |       expect(perCellTime).toBeLessThan(1.0);
          |                           ^
      160 |     });
      161 |     
      162 |     it('should handle fast scroll simulation (10 frames)', () => {

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:159:27)

  ‚óè Pipeline Performance: Formatting Stack ‚Ä∫ Performance Regression Detection ‚Ä∫ should detect if spec-based formatter degrades to >1¬µs

    expect(received).toBeLessThan(expected)

    Expected: < 1
    Received:   2.151909999999771

      295 |       
      296 |       // If this fails, the spec-based formatter has regressed
    > 297 |       expect(perCellTime).toBeLessThan(1.0);
          |                           ^
      298 |     });
      299 |   });
      300 | });

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:297:27)

ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
(node:75056) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
FAIL packages/core/__tests__/compatibility/excel-parity.test.ts
  ‚óè Console

    console.log
      
      ‚ùå Test Failed: WEEK3-TEXT-001

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:108:21)

    console.log
      Formula: =TEXTBEFORE("user@example.com", "@")

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:109:21)

    console.log
      Expected: "user"

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:110:21)

    console.log
      Actual: {}

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:111:21)

    console.log
      Tolerance: 0

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:112:21)

    console.log
      
      ‚ùå Test Failed: WEEK3-TEXT-002

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:108:21)

    console.log
      Formula: =TEXTAFTER("user@example.com", "@")

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:109:21)

    console.log
      Expected: "example.com"

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:110:21)

    console.log
      Actual: {}

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:111:21)

    console.log
      Tolerance: 0

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:112:21)

    console.log
      
      ‚ùå Test Failed: WEEK3-WEB-001

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:108:21)

    console.log
      Formula: =ENCODEURL("hello world")

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:109:21)

    console.log
      Expected: "hello%20world"

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:110:21)

    console.log
      Actual: {}

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:111:21)

    console.log
      Tolerance: 0

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:112:21)

    console.log
      
      ‚ùå Test Failed: WEEK3-WEB-002

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:108:21)

    console.log
      Formula: =ENCODEURL("user@example.com")

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:109:21)

    console.log
      Expected: "user%40example.com"

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:110:21)

    console.log
      Actual: {}

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:111:21)

    console.log
      Tolerance: 0

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:112:21)

    console.log
      
      ‚ùå Test Failed: WEEK3-WEB-003

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:108:21)

    console.log
      Formula: =ENCODEURL("„Åì„Çì„Å´„Å°„ÅØ")

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:109:21)

    console.log
      Expected: "%E3%81%93%E3%82%93%E3%81%AB%E3%81%A1%E3%81%AF"

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:110:21)

    console.log
      Actual: {}

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:111:21)

    console.log
      Tolerance: 0

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:112:21)

    console.log
      
      ‚ùå Test Failed: EDGE-BOUND-005

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:108:21)

    console.log
      Formula: =SUM()

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:109:21)

    console.log
      Expected: 0

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:110:21)

    console.log
      Actual: undefined

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:111:21)

    console.log
      Tolerance: 0

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:112:21)

    console.log
      
      üìä Excel Compatibility Test Summary

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:129:15)

    console.log
      =====================================

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:130:15)

    console.log
      Total test cases: 80

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:131:15)

    console.log
      Excel version: Microsoft 365

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:132:15)

    console.log
      Generated: 2026-02-09

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:133:15)

    console.log
      =====================================

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:134:15)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Week 3 - Text Advanced ‚Ä∫ WEEK3-TEXT-001: TEXTBEFORE delimiter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Week 3 - Text Advanced ‚Ä∫ WEEK3-TEXT-002: TEXTAFTER delimiter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Week 3 - Web Functions ‚Ä∫ WEEK3-WEB-001: ENCODEURL with space

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Week 3 - Web Functions ‚Ä∫ WEEK3-WEB-002: ENCODEURL with special characters

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Week 3 - Web Functions ‚Ä∫ WEEK3-WEB-003: ENCODEURL with Unicode

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Edge Cases - Boundaries ‚Ä∫ EDGE-BOUND-005: SUM with no arguments

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

FAIL packages/core/__tests__/functions/statistical-week2-day3.test.ts
  ‚óè Statistical Functions - Week 2 Day 3 (Chi-Square) ‚Ä∫ CHISQ.TEST - Chi-Square Test ‚Ä∫ Oracle Test 1: Good fit (high p-value)

    expect(received).toBeGreaterThan(expected)

    Expected: > 0.5
    Received:   0.005089698416889221

      262 |       const result = evaluate('=CHISQ.TEST(A1:A5, B1:B5)');
      263 |       expect(typeof result).toBe('number');
    > 264 |       expect(result as number).toBeGreaterThan(0.5); // Good fit
          |                                ^
      265 |       expect(result as number).toBeLessThan(1);
      266 |     });
      267 |

      at Object.<anonymous> (__tests__/functions/statistical-week2-day3.test.ts:264:32)

  ‚óè Statistical Functions - Week 2 Day 3 (Chi-Square) ‚Ä∫ CHISQ.TEST - Chi-Square Test ‚Ä∫ Oracle Test 2: Poor fit (low p-value)

    expect(received).toBeLessThan(expected)

    Expected: < 0.1
    Received:   0.9842614960883287

      271 |       expect(typeof result).toBe('number');
      272 |       expect(result as number).toBeGreaterThan(0);
    > 273 |       expect(result as number).toBeLessThan(0.1); // Poor fit
          |                                ^
      274 |     });
      275 |
      276 |     test('Oracle Test 3: Perfect fit (p ‚âà 1)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-week2-day3.test.ts:273:32)

  ‚óè Statistical Functions - Week 2 Day 3 (Chi-Square) ‚Ä∫ CHISQ.TEST - Chi-Square Test ‚Ä∫ Oracle Test 3: Perfect fit (p ‚âà 1)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      277 |       // CHISQ.TEST with identical arrays
      278 |       const result = evaluate('=CHISQ.TEST(A1:A5, D1:D5)');
    > 279 |       expect(typeof result).toBe('number');
          |                             ^
      280 |       expect(result as number).toBeCloseTo(1, 1); // Perfect fit
      281 |     });
      282 |

      at Object.<anonymous> (__tests__/functions/statistical-week2-day3.test.ts:279:29)

  ‚óè Statistical Functions - Week 2 Day 3 (Chi-Square) ‚Ä∫ CHISQ.TEST - Chi-Square Test ‚Ä∫ Oracle Test 7: Calculation verification

    expect(received).toBeGreaterThan(expected)

    Expected: > 0.9
    Received:   0.005089698416889221

      314 |       const result = evaluate('=CHISQ.TEST(A1:A5, B1:B5)');
      315 |       expect(typeof result).toBe('number');
    > 316 |       expect(result as number).toBeGreaterThan(0.9); // High p-value
          |                                ^
      317 |     });
      318 |   });
      319 |

      at Object.<anonymous> (__tests__/functions/statistical-week2-day3.test.ts:316:32)

(node:75139) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/functions/datetime-fixes.test.ts
  ‚óè Date & Time Fixes - Week 7 Days 3-4 ‚Ä∫ Date Serial Number Fix (UTC-based) ‚Ä∫ TODAY returns correct day

    expect(received).toBe(expected) // Object.is equality

    Expected: 29
    Received: 17

      75 |       // This test assumes January 29, 2026
      76 |       const day = evaluate('=DAY(TODAY())');
    > 77 |       expect(day).toBe(29);
         |                   ^
      78 |     });
      79 |
      80 |     test('sequential dates are exactly 1 apart', () => {

      at Object.<anonymous> (__tests__/functions/datetime-fixes.test.ts:77:19)

  ‚óè Date & Time Fixes - Week 7 Days 3-4 ‚Ä∫ Integration: Date Serial + TIME Wrap ‚Ä∫ TODAY + wrapped TIME gives correct datetime

    expect(received).toBe(expected) // Object.is equality

    Expected: 29
    Received: 17

      278 |       const hour = evaluate(`=HOUR(${result})`);
      279 |
    > 280 |       expect(day).toBe(29); // Same day (wrapped time doesn't add days)
          |                   ^
      281 |       expect(hour).toBe(6); // 30 hours mod 24 = 6 AM
      282 |     });
      283 |

      at Object.<anonymous> (__tests__/functions/datetime-fixes.test.ts:280:19)

  ‚óè Date & Time Fixes - Week 7 Days 3-4 ‚Ä∫ Integration: Date Serial + TIME Wrap ‚Ä∫ NOW extraction works with both fixes

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      291 |
      292 |       expect(year).toBe(2026);
    > 293 |       expect(month).toBe(1);
          |                     ^
      294 |       expect(day).toBe(29);
      295 |     });
      296 |   });

      at Object.<anonymous> (__tests__/functions/datetime-fixes.test.ts:293:21)

(node:75117) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:75108) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/functions/datetime-basic.test.ts (5.005 s)
  ‚óè Date & Time Functions - Basic ‚Ä∫ TODAY ‚Ä∫ extracting month from TODAY

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      235 |     test('extracting month from TODAY', () => {
      236 |       const result = evaluate('=MONTH(TODAY())');
    > 237 |       expect(result).toBe(1); // Current month (January)
          |                      ^
      238 |     });
      239 |
      240 |     test('extracting day from TODAY', () => {

      at Object.<anonymous> (__tests__/functions/datetime-basic.test.ts:237:22)

  ‚óè Date & Time Functions - Basic ‚Ä∫ TODAY ‚Ä∫ extracting day from TODAY

    expect(received).toBe(expected) // Object.is equality

    Expected: 29
    Received: 17

      241 |       const result = evaluate('=DAY(TODAY())');
      242 |       // Fixed: Should now return correct day (29) with UTC-based conversion
    > 243 |       expect(result).toBe(29);
          |                      ^
      244 |     });
      245 |   });
      246 |

      at Object.<anonymous> (__tests__/functions/datetime-basic.test.ts:243:22)

(node:75075) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:75038) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:75124) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:75049) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:75099) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/functions/financial-extended.test.ts (5.207 s)
  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT with quarterly compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      135 |       // 5% nominal compounded quarterly
      136 |       const result = evaluate('=EFFECT(0.05, 4)');
    > 137 |       expect(typeof result).toBe('number');
          |                             ^
      138 |       expect(result as number).toBeCloseTo(0.050945, 6); // ~5.0945%
      139 |     });
      140 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:137:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT with monthly compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      142 |       // 12% nominal compounded monthly
      143 |       const result = evaluate('=EFFECT(0.12, 12)');
    > 144 |       expect(typeof result).toBe('number');
          |                             ^
      145 |       expect(result as number).toBeCloseTo(0.126825, 6); // ~12.68%
      146 |     });
      147 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:144:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT with annual compounding

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NAME?]

      149 |       // Annual compounding = no change
      150 |       const result = evaluate('=EFFECT(0.05, 1)');
    > 151 |       expect(result).toBeCloseTo(0.05, 6);
          |                      ^
      152 |     });
      153 |
      154 |     test('EFFECT with daily compounding', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:151:22)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT with daily compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      155 |       // 10% nominal compounded daily (365 times)
      156 |       const result = evaluate('=EFFECT(0.10, 365)');
    > 157 |       expect(typeof result).toBe('number');
          |                             ^
      158 |       expect(result as number).toBeCloseTo(0.105156, 6); // ~10.52%
      159 |     });
      160 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:157:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT returns #NUM! for non-positive nominal rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      162 |       const result = evaluate('=EFFECT(-0.05, 4)');
      163 |       expect(result).toBeInstanceOf(Error);
    > 164 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      165 |     });
      166 |
      167 |     test('EFFECT returns #NUM! for npery < 1', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:164:41)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT returns #NUM! for npery < 1

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      168 |       const result = evaluate('=EFFECT(0.05, 0)');
      169 |       expect(result).toBeInstanceOf(Error);
    > 170 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      171 |     });
      172 |
      173 |     test('EFFECT truncates npery to integer', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:170:41)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT truncates npery to integer

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: expected value must be a number

    Expected has type:  object
    Expected has value: [Error: #NAME?]

      175 |       const result1 = evaluate('=EFFECT(0.05, 4.7)');
      176 |       const result2 = evaluate('=EFFECT(0.05, 4)');
    > 177 |       expect(result1).toBeCloseTo(result2 as number, 6);
          |                       ^
      178 |     });
      179 |   });
      180 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:177:23)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL with quarterly compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      183 |       // 5.0945% effective ‚Üí 5% nominal quarterly
      184 |       const result = evaluate('=NOMINAL(0.050945, 4)');
    > 185 |       expect(typeof result).toBe('number');
          |                             ^
      186 |       expect(result as number).toBeCloseTo(0.05, 4);
      187 |     });
      188 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:185:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL with monthly compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      190 |       // 12.68% effective ‚Üí 12% nominal monthly
      191 |       const result = evaluate('=NOMINAL(0.126825, 12)');
    > 192 |       expect(typeof result).toBe('number');
          |                             ^
      193 |       expect(result as number).toBeCloseTo(0.12, 4);
      194 |     });
      195 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:192:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL with annual compounding

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NAME?]

      197 |       // Annual compounding = no change
      198 |       const result = evaluate('=NOMINAL(0.05, 1)');
    > 199 |       expect(result).toBeCloseTo(0.05, 6);
          |                      ^
      200 |     });
      201 |
      202 |     test('NOMINAL with daily compounding', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:199:22)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL with daily compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      203 |       // 10.52% effective ‚Üí 10% nominal daily
      204 |       const result = evaluate('=NOMINAL(0.105156, 365)');
    > 205 |       expect(typeof result).toBe('number');
          |                             ^
      206 |       expect(result as number).toBeCloseTo(0.10, 4);
      207 |     });
      208 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:205:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL returns #NUM! for non-positive effective rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      210 |       const result = evaluate('=NOMINAL(-0.05, 4)');
      211 |       expect(result).toBeInstanceOf(Error);
    > 212 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      213 |     });
      214 |
      215 |     test('NOMINAL returns #NUM! for npery < 1', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:212:41)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL returns #NUM! for npery < 1

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      216 |       const result = evaluate('=NOMINAL(0.05, 0)');
      217 |       expect(result).toBeInstanceOf(Error);
    > 218 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      219 |     });
      220 |
      221 |     test('NOMINAL truncates npery to integer', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:218:41)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL truncates npery to integer

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: expected value must be a number

    Expected has type:  object
    Expected has value: [Error: #NAME?]

      223 |       const result1 = evaluate('=NOMINAL(0.050945, 4.7)');
      224 |       const result2 = evaluate('=NOMINAL(0.050945, 4)');
    > 225 |       expect(result1).toBeCloseTo(result2 as number, 6);
          |                       ^
      226 |     });
      227 |   });
      228 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:225:23)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ Integration: EFFECT and NOMINAL are inverses ‚Ä∫ EFFECT then NOMINAL returns original

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NAME?]

      234 |       const backToNominal = evaluate(`=NOMINAL(${effective}, ${npery})`) as number;
      235 |       
    > 236 |       expect(backToNominal).toBeCloseTo(nominal, 6);
          |                             ^
      237 |     });
      238 |
      239 |     test('NOMINAL then EFFECT returns original', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:236:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ Integration: EFFECT and NOMINAL are inverses ‚Ä∫ NOMINAL then EFFECT returns original

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NAME?]

      243 |       const backToEffective = evaluate(`=EFFECT(${nominal}, ${npery})`) as number;
      244 |       
    > 245 |       expect(backToEffective).toBeCloseTo(effective, 6);
          |                               ^
      246 |     });
      247 |   });
      248 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:245:31)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ Excel Compatibility ‚Ä∫ EFFECT matches Excel: =EFFECT(0.05, 4)

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NAME?]

      293 |     test('EFFECT matches Excel: =EFFECT(0.05, 4)', () => {
      294 |       const result = evaluate('=EFFECT(0.05, 4)');
    > 295 |       expect(result as number).toBeCloseTo(0.050945, 6);
          |                                ^
      296 |     });
      297 |
      298 |     test('NOMINAL matches Excel: =NOMINAL(0.053543, 4)', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:295:32)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ Excel Compatibility ‚Ä∫ NOMINAL matches Excel: =NOMINAL(0.053543, 4)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      298 |     test('NOMINAL matches Excel: =NOMINAL(0.053543, 4)', () => {
      299 |       const result = evaluate('=NOMINAL(0.053543, 4)');
    > 300 |       expect(typeof result).toBe('number');
          |                             ^
      301 |       expect(result as number).toBeCloseTo(0.0525, 4);
      302 |     });
      303 |   });

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:300:29)

(node:75068) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/conditional-formatting-engine.test.ts
  ‚óè ConditionalFormattingEngine ‚Ä∫ Duplicate/Unique rules ‚Ä∫ handles mixed text and number types

    expect(received).toBe(expected) // Object.is equality

    Expected: "#ff0000"
    Received: undefined

      411 | 			// 123 and '123' are treated as equal (string comparison)
      412 | 			const result1 = engine.applyRules(123, [rule], { address: { row: 1, col: 1 }, getValue: mockGetValue });
    > 413 | 			expect(result1.style?.fillColor).toBe('#ff0000');
          | 			                                 ^
      414 |
      415 | 			const result2 = engine.applyRules('123', [rule], { address: { row: 1, col: 2 }, getValue: mockGetValue });
      416 | 			expect(result2.style?.fillColor).toBe('#ff0000');

      at Object.<anonymous> (__tests__/conditional-formatting-engine.test.ts:413:37)

FAIL packages/core/__tests__/integration-week6-7.test.ts (5.099 s)
  ‚óè Week 6-7 Integration - Real-World Scenarios ‚Ä∫ Scenario 1: Monthly Payroll with Dates & Overtime ‚Ä∫ calculate days since hire date (date serial fix)

    expect(received).toBe(expected) // Object.is equality

    Expected: 24
    Received: 43

      57 |       const daysSinceHire = (today as number) - (aliceStart as number);
      58 |
    > 59 |       expect(daysSinceHire).toBe(24); // Jan 29 - Jan 5 = 24 days
         |                             ^
      60 |     });
      61 |
      62 |     test('calculate pay manually (testing formulas)', () => {

      at Object.<anonymous> (__tests__/integration-week6-7.test.ts:59:29)

(node:75146) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:75055) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/information-type-checking.test.ts
  ‚óè Week 11 Day 1: Information & Type Checking Functions ‚Ä∫ ISBLANK Function ‚Ä∫ returns TRUE for empty string

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      103 |   describe('ISBLANK Function', () => {
      104 |     test('returns TRUE for empty string', () => {
    > 105 |       expect(engine.evaluate('=ISBLANK("")', context)).toBe(true);
          |                                                        ^
      106 |     });
      107 |
      108 |     test('returns TRUE for empty cells', () => {

      at Object.<anonymous> (__tests__/information-type-checking.test.ts:105:56)

  ‚óè Week 11 Day 1: Information & Type Checking Functions ‚Ä∫ ISBLANK Function ‚Ä∫ returns TRUE for empty cells

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      111 |       
      112 |       expect(engine.evaluate('=ISBLANK(A6)', context)).toBe(true);
    > 113 |       expect(engine.evaluate('=ISBLANK(A8)', context)).toBe(true);
          |                                                        ^
      114 |       // Row 7 (A7) not set, should also be blank
      115 |       expect(engine.evaluate('=ISBLANK(A7)', context)).toBe(true);
      116 |     });

      at Object.<anonymous> (__tests__/information-type-checking.test.ts:113:56)

  ‚óè Week 11 Day 1: Information & Type Checking Functions ‚Ä∫ Integration Tests ‚Ä∫ combining type checks with IF

    expect(received).toBe(expected) // Object.is equality

    Expected: "empty"
    Received: "filled"

      361 |       expect(engine.evaluate('=IF(ISNUMBER(100), "num", "other")', context)).toBe('num');
      362 |       expect(engine.evaluate('=IF(ISTEXT("hello"), "text", "other")', context)).toBe('text');
    > 363 |       expect(engine.evaluate('=IF(ISBLANK(""), "empty", "filled")', context)).toBe('empty');
          |                                                                               ^
      364 |     });
      365 |
      366 |     test('type checking with data validation', () => {

      at Object.<anonymous> (__tests__/information-type-checking.test.ts:363:79)

  ‚óè Week 11 Day 1: Information & Type Checking Functions ‚Ä∫ Integration Tests ‚Ä∫ ISBLANK for conditional formatting logic

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 3

      404 |         context
      405 |       );
    > 406 |       expect(countNonBlank).toBe(2);
          |                             ^
      407 |     });
      408 |
      409 |     test('ISNONTEXT for filtering numeric data', () => {

      at Object.<anonymous> (__tests__/information-type-checking.test.ts:406:29)

(node:75133) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/exotic/exotic-functions.test.ts (5.221 s)
  ‚óè Console

    console.log
      
      ============================================================

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:250:15)

    console.log
      üìä EXOTIC FUNCTIONS TEST SUMMARY

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:251:15)

    console.log
      ============================================================

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:252:15)

    console.log
      
      ‚úÖ Functions Tested:

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:253:15)

    console.log
         - FORMULATEXT: Formula inspection

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:254:15)

    console.log
         - SHEET: Sheet number lookup

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:255:15)

    console.log
         - SHEETS: Sheet count

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:256:15)

    console.log
         - GETPIVOTDATA: Pivot table extraction (stub)

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:257:15)

    console.log
         - CUBE*: 7 OLAP functions (stub implementations)

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:258:15)

    console.log
      
      üìà Coverage: Complete Excel exotic function parity

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:259:15)

    console.log
      üéØ Status: Production ready

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:260:15)

    console.log
      ‚ö†Ô∏è  Note: CUBE and GETPIVOTDATA require external data sources

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:261:15)

    console.log
      
      ============================================================

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:262:15)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ FORMULATEXT - Formula Inspection ‚Ä∫ should return formula text from cell containing formula (direct call)

    TypeError: (intermediate value) is not a function

      45 |       
      46 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 47 |       const result = (funcInfo?.handler as any)(context, addr);
         |                                                ^
      48 |       expect(result).toBe('=SUM(B1:B10)');
      49 |     });
      50 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:47:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ FORMULATEXT - Formula Inspection ‚Ä∫ should return #N/A for cell without formula

    TypeError: (intermediate value) is not a function

      59 |       
      60 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 61 |       const result = (funcInfo?.handler as any)(context, { row: 1, col: 1 });
         |                                                ^
      62 |       expect(result).toBeInstanceOf(Error);
      63 |       expect(String(result)).toContain('#N/A');
      64 |     });

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:61:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ FORMULATEXT - Formula Inspection ‚Ä∫ should return #N/A for empty cell

    TypeError: (intermediate value) is not a function

      72 |       
      73 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 74 |       const result = (funcInfo?.handler as any)(context, { row: 1, col: 1 });
         |                                                ^
      75 |       expect(result).toBeInstanceOf(Error);
      76 |       expect(String(result)).toContain('#N/A');
      77 |     });

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:74:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ FORMULATEXT - Formula Inspection ‚Ä∫ should work with complex formulas

    TypeError: (intermediate value) is not a function

      89 |       
      90 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 91 |       const result = (funcInfo?.handler as any)(context, addr);
         |                                                ^
      92 |       expect(result).toBe('=IF(A1>10, SUM(B1:B5), AVERAGE(C1:C5))');
      93 |     });
      94 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:91:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ FORMULATEXT - Formula Inspection ‚Ä∫ should distinguish between formula and string starting with =

    TypeError: (intermediate value) is not a function

      104 |       
      105 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 106 |       const result = (funcInfo?.handler as any)(context, { row: 3, col: 3 });
          |                                                ^
      107 |       // Should return the formula text since value starts with '='
      108 |       expect(result).toBe('=A1+A2');
      109 |     });

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:106:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ SHEET - Sheet Number ‚Ä∫ should return 1 for current sheet when no argument

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #NAME?]

      113 |     it('should return 1 for current sheet when no argument', () => {
      114 |       const result = evaluate('=SHEET()');
    > 115 |       expect(result).toBe(1);
          |                      ^
      116 |     });
      117 |
      118 |     it('should return 1 for current sheet name', () => {

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:115:22)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ SHEET - Sheet Number ‚Ä∫ should return 1 for current sheet name

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #NAME?]

      118 |     it('should return 1 for current sheet name', () => {
      119 |       const result = evaluate('=SHEET("TestSheet")');
    > 120 |       expect(result).toBe(1);
          |                      ^
      121 |     });
      122 |
      123 |     it('should return 1 for non-existent sheet (single-sheet implementation)', () => {

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:120:22)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ SHEET - Sheet Number ‚Ä∫ should return 1 for non-existent sheet (single-sheet implementation)

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      126 |       const result = evaluate('=SHEET("NonExistentSheet")');
      127 |       // For now, accept 1 (current behavior) or #REF! (future behavior)
    > 128 |       expect(result === 1 || (result instanceof Error && String(result).includes('#REF!'))).toBe(true);
          |                                                                                             ^
      129 |     });
      130 |   });
      131 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:128:93)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ SHEETS - Sheet Count ‚Ä∫ should return 1 for single sheet workbook

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #NAME?]

      133 |     it('should return 1 for single sheet workbook', () => {
      134 |       const result = evaluate('=SHEETS()');
    > 135 |       expect(result).toBe(1);
          |                      ^
      136 |     });
      137 |   });
      138 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:135:22)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ GETPIVOTDATA - Pivot Table Extraction ‚Ä∫ should return #REF! for pivot tables not supported

    expect(received).toContain(expected) // indexOf

    Expected substring: "#REF!"
    Received string:    "Error: #NAME?"

      142 |       const result = evaluate('=GETPIVOTDATA("Sales", A1)');
      143 |       expect(result).toBeInstanceOf(Error);
    > 144 |       expect(String(result)).toContain('#REF!');
          |                              ^
      145 |     });
      146 |   });
      147 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:144:30)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEMEMBER ‚Ä∫ should return #N/A when no cube connection

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      151 |         const result = evaluate('=CUBEMEMBER("SalesCube", "[Time].[Year].[2024]")');
      152 |         expect(result).toBeInstanceOf(Error);
    > 153 |         expect(String(result)).toContain('#N/A');
          |                                ^
      154 |       });
      155 |
      156 |       it('should accept optional caption', () => {

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:153:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEMEMBER ‚Ä∫ should accept optional caption

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      157 |         const result = evaluate('=CUBEMEMBER("SalesCube", "[Time].[Year].[2024]", "2024")');
      158 |         expect(result).toBeInstanceOf(Error);
    > 159 |         expect(String(result)).toContain('#N/A');
          |                                ^
      160 |       });
      161 |     });
      162 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:159:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBESET ‚Ä∫ should return #N/A when no cube connection

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      165 |         const result = evaluate('=CUBESET("SalesCube", "[Product].[Category].Members")');
      166 |         expect(result).toBeInstanceOf(Error);
    > 167 |         expect(String(result)).toContain('#N/A');
          |                                ^
      168 |       });
      169 |     });
      170 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:167:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEVALUE ‚Ä∫ should return #N/A when no cube connection

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      173 |         const result = evaluate('=CUBEVALUE("SalesCube", "[Time].[2024]", "[Measures].[Sales]")');
      174 |         expect(result).toBeInstanceOf(Error);
    > 175 |         expect(String(result)).toContain('#N/A');
          |                                ^
      176 |       });
      177 |
      178 |       it('should accept multiple member expressions', () => {

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:175:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEVALUE ‚Ä∫ should accept multiple member expressions

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      179 |         const result = evaluate('=CUBEVALUE("SalesCube", "[Time].[2024]", "[Product].[Bikes]", "[Region].[East]")');
      180 |         expect(result).toBeInstanceOf(Error);
    > 181 |         expect(String(result)).toContain('#N/A');
          |                                ^
      182 |       });
      183 |     });
      184 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:181:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBERANKEDMEMBER ‚Ä∫ should return #N/A for stub implementation

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      187 |         const result = evaluate('=CUBERANKEDMEMBER("SalesCube", "[Product].[Top10]", 1)');
      188 |         expect(result).toBeInstanceOf(Error);
    > 189 |         expect(String(result)).toContain('#N/A');
          |                                ^
      190 |       });
      191 |     });
      192 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:189:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEKPIMEMBER ‚Ä∫ should return #N/A for stub implementation

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      195 |         const result = evaluate('=CUBEKPIMEMBER("SalesCube", "SalesTarget", "Value")');
      196 |         expect(result).toBeInstanceOf(Error);
    > 197 |         expect(String(result)).toContain('#N/A');
          |                                ^
      198 |       });
      199 |     });
      200 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:197:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEMEMBERPROPERTY ‚Ä∫ should return #N/A for stub implementation

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      203 |         const result = evaluate('=CUBEMEMBERPROPERTY("SalesCube", "[Product].[Bikes]", "Name")');
      204 |         expect(result).toBeInstanceOf(Error);
    > 205 |         expect(String(result)).toContain('#N/A');
          |                                ^
      206 |       });
      207 |     });
      208 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:205:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBESETCOUNT ‚Ä∫ should return #N/A for stub implementation

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      211 |         const result = evaluate('=CUBESETCOUNT("[Product].[Top10]")');
      212 |         expect(result).toBeInstanceOf(Error);
    > 213 |         expect(String(result)).toContain('#N/A');
          |                                ^
      214 |       });
      215 |     });
      216 |   });

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:213:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ Integration - Exotic Functions in Formulas ‚Ä∫ should use FORMULATEXT in error checking (direct call)

    TypeError: (intermediate value) is not a function

      229 |       
      230 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 231 |       const result = (funcInfo?.handler as any)(context, addr);
          |                                                ^
      232 |       expect(typeof result).toBe('string');
      233 |       expect(result).toContain('SUM');
      234 |     });

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:231:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ Integration - Exotic Functions in Formulas ‚Ä∫ should combine SHEET with conditional logic

    expect(received).toBe(expected) // Object.is equality

    Expected: "First Sheet"
    Received: [Error: #NAME?]

      236 |     it('should combine SHEET with conditional logic', () => {
      237 |       const result = evaluate('=IF(SHEET()=1, "First Sheet", "Other Sheet")');
    > 238 |       expect(result).toBe('First Sheet');
          |                      ^
      239 |     });
      240 |
      241 |     it('should use SHEETS to detect single vs multi-sheet workbook', () => {

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:238:22)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ Integration - Exotic Functions in Formulas ‚Ä∫ should use SHEETS to detect single vs multi-sheet workbook

    expect(received).toBe(expected) // Object.is equality

    Expected: "Single-sheet"
    Received: [Error: #NAME?]

      241 |     it('should use SHEETS to detect single vs multi-sheet workbook', () => {
      242 |       const result = evaluate('=IF(SHEETS()>1, "Multi-sheet", "Single-sheet")');
    > 243 |       expect(result).toBe('Single-sheet');
          |                      ^
      244 |     });
      245 |   });
      246 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:243:22)

FAIL packages/core/__tests__/functions/text-enhancement-functions.test.ts (5.143 s)
  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ CONCAT function ‚Ä∫ should handle cell ranges

    expect(received).toBe(expected) // Object.is equality

    Expected: "HelloWorld!"
    Received: ""

      51 |       setCellValue('A2', 'World');
      52 |       setCellValue('A3', '!');
    > 53 |       expect(evaluate('=CONCAT(A1:A3)')).toBe('HelloWorld!');
         |                                          ^
      54 |     });
      55 |
      56 |     test('should handle mixed ranges and strings', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:53:42)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ CONCAT function ‚Ä∫ should handle mixed ranges and strings

    expect(received).toBe(expected) // Object.is equality

    Expected: "FirstSecond and more"
    Received: " and more"

      57 |       setCellValue('A1', 'First');
      58 |       setCellValue('A2', 'Second');
    > 59 |       expect(evaluate('=CONCAT(A1:A2, " and more")')).toBe('FirstSecond and more');
         |                                                       ^
      60 |     });
      61 |
      62 |     test('should ignore errors in arguments', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:59:55)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ CONCAT function ‚Ä∫ should ignore errors in arguments

    expect(received).toBe(expected) // Object.is equality

    Expected: "HelloWorld"
    Received: ""

      64 |       setCellValue('A2', new Error('#DIV/0!')); // Error
      65 |       setCellValue('A3', 'World');
    > 66 |       expect(evaluate('=CONCAT(A1:A3)')).toBe('HelloWorld');
         |                                          ^
      67 |     });
      68 |
      69 |     test('should treat empty cells as empty strings', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:66:42)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ CONCAT function ‚Ä∫ should treat empty cells as empty strings

    expect(received).toBe(expected) // Object.is equality

    Expected: "AC"
    Received: ""

      70 |       setCellValue('A1', 'A');
      71 |       setCellValue('A3', 'C');
    > 72 |       expect(evaluate('=CONCAT(A1:A3)')).toBe('AC');
         |                                          ^
      73 |     });
      74 |
      75 |     test('should handle single argument', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:72:42)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ PROPER function ‚Ä∫ should handle cell reference

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello World"
    Received: ""

      120 |     test('should handle cell reference', () => {
      121 |       setCellValue('A1', 'hello world');
    > 122 |       expect(evaluate('=PROPER(A1)')).toBe('Hello World');
          |                                       ^
      123 |     });
      124 |   });
      125 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:122:39)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ CLEAN function ‚Ä∫ should handle cell reference

    expect(received).toBe(expected) // Object.is equality

    Expected: "HelloWorld"
    Received: ""

      160 |     test('should handle cell reference', () => {
      161 |       setCellValue('A1', 'Hello\x07World'); // Bell character
    > 162 |       expect(evaluate('=CLEAN(A1)')).toBe('HelloWorld');
          |                                      ^
      163 |     });
      164 |   });
      165 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:162:38)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ UNICHAR function ‚Ä∫ should handle cell reference

    expect(received).toBe(expected) // Object.is equality

    Expected: "‚òÖ"
    Received: " "

      207 |     test('should handle cell reference', () => {
      208 |       setCellValue('A1', 9733);
    > 209 |       expect(evaluate('=UNICHAR(A1)')).toBe('‚òÖ');
          |                                        ^
      210 |     });
      211 |   });
      212 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:209:40)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ UNICODE function ‚Ä∫ should handle cell reference

    expect(received).toBe(expected) // Object.is equality

    Expected: 72
    Received: [Error: #VALUE!]

      247 |     test('should handle cell reference', () => {
      248 |       setCellValue('A1', 'Hello');
    > 249 |       expect(evaluate('=UNICODE(A1)')).toBe(72); // 'H'
          |                                        ^
      250 |     });
      251 |
      252 |     test('should be inverse of UNICHAR', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:249:40)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ DOLLAR function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: "$1,234.57"
    Received: "$0.00"

      301 |     test('should handle cell references', () => {
      302 |       setCellValue('A1', 1234.567);
    > 303 |       expect(evaluate('=DOLLAR(A1)')).toBe('$1,234.57');
          |                                       ^
      304 |     });
      305 |   });
      306 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:303:39)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should format with default settings

    expect(received).toBe(expected) // Object.is equality

    Expected: "1,234.57"
    Received: [Error: #NAME?]

      311 |   describe('FIXED function', () => {
      312 |     test('should format with default settings', () => {
    > 313 |       expect(evaluate('=FIXED(1234.567)')).toBe('1,234.57');
          |                                            ^
      314 |       expect(evaluate('=FIXED(1000)')).toBe('1,000.00');
      315 |     });
      316 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:313:44)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should format with specified decimal places

    expect(received).toBe(expected) // Object.is equality

    Expected: "1,234.6"
    Received: [Error: #NAME?]

      316 |
      317 |     test('should format with specified decimal places', () => {
    > 318 |       expect(evaluate('=FIXED(1234.567, 1)')).toBe('1,234.6');
          |                                               ^
      319 |       expect(evaluate('=FIXED(1234.567, 4)')).toBe('1,234.5670');
      320 |       expect(evaluate('=FIXED(1234.567, 0)')).toBe('1,235');
      321 |     });

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:318:47)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should handle negative decimals (round to left)

    expect(received).toBe(expected) // Object.is equality

    Expected: "1,230"
    Received: [Error: #NAME?]

      322 |
      323 |     test('should handle negative decimals (round to left)', () => {
    > 324 |       expect(evaluate('=FIXED(1234.567, -1)')).toBe('1,230');
          |                                                ^
      325 |       expect(evaluate('=FIXED(1234.567, -2)')).toBe('1,200');
      326 |       expect(evaluate('=FIXED(5678, -3)')).toBe('6,000');
      327 |     });

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:324:48)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should omit commas when no_commas is TRUE

    expect(received).toBe(expected) // Object.is equality

    Expected: "1234.6"
    Received: [Error: #NAME?]

      328 |
      329 |     test('should omit commas when no_commas is TRUE', () => {
    > 330 |       expect(evaluate('=FIXED(1234.567, 1, TRUE)')).toBe('1234.6');
          |                                                     ^
      331 |       expect(evaluate('=FIXED(1000, 2, TRUE)')).toBe('1000.00');
      332 |     });
      333 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:330:53)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should include commas when no_commas is FALSE

    expect(received).toBe(expected) // Object.is equality

    Expected: "1,234.6"
    Received: [Error: #NAME?]

      333 |
      334 |     test('should include commas when no_commas is FALSE', () => {
    > 335 |       expect(evaluate('=FIXED(1234.567, 1, FALSE)')).toBe('1,234.6');
          |                                                      ^
      336 |     });
      337 |
      338 |     test('should handle negative numbers', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:335:54)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should handle negative numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "-1,234.57"
    Received: [Error: #NAME?]

      337 |
      338 |     test('should handle negative numbers', () => {
    > 339 |       expect(evaluate('=FIXED(-1234.567)')).toBe('-1,234.57');
          |                                             ^
      340 |       expect(evaluate('=FIXED(-1234.567, 1, TRUE)')).toBe('-1234.6');
      341 |     });
      342 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:339:45)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0.00"
    Received: [Error: #NAME?]

      342 |
      343 |     test('should handle zero', () => {
    > 344 |       expect(evaluate('=FIXED(0)')).toBe('0.00');
          |                                     ^
      345 |       expect(evaluate('=FIXED(0, 4)')).toBe('0.0000');
      346 |     });
      347 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:344:37)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should return error for non-integer decimals

    expect(received).toBe(expected) // Object.is equality

    Expected: "#VALUE!"
    Received: "#NAME?"

      349 |       const result = evaluate('=FIXED(1234, 2.5)');
      350 |       expect(result).toBeInstanceOf(Error);
    > 351 |       expect((result as Error).message).toBe('#VALUE!');
          |                                         ^
      352 |     });
      353 |
      354 |     test('should handle cell references', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:351:41)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: "1,234.6"
    Received: [Error: #NAME?]

      354 |     test('should handle cell references', () => {
      355 |       setCellValue('A1', 1234.567);
    > 356 |       expect(evaluate('=FIXED(A1, 1)')).toBe('1,234.6');
          |                                         ^
      357 |     });
      358 |   });
      359 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:356:41)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should extract text before first occurrence

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello"
    Received: [Error: #NAME?]

      364 |   describe('TEXTBEFORE function', () => {
      365 |     test('should extract text before first occurrence', () => {
    > 366 |       expect(evaluate('=TEXTBEFORE("Hello-World", "-")')).toBe('Hello');
          |                                                           ^
      367 |       expect(evaluate('=TEXTBEFORE("First:Second:Third", ":")')).toBe('First');
      368 |     });
      369 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:366:59)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should extract text before specified occurrence

    expect(received).toBe(expected) // Object.is equality

    Expected: "A:B"
    Received: [Error: #NAME?]

      369 |
      370 |     test('should extract text before specified occurrence', () => {
    > 371 |       expect(evaluate('=TEXTBEFORE("A:B:C:D", ":", 2)')).toBe('A:B');
          |                                                          ^
      372 |       expect(evaluate('=TEXTBEFORE("A:B:C:D", ":", 3)')).toBe('A:B:C');
      373 |     });
      374 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:371:58)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should handle negative instance (from end)

    expect(received).toBe(expected) // Object.is equality

    Expected: "A:B:C"
    Received: [Error: #NAME?]

      374 |
      375 |     test('should handle negative instance (from end)', () => {
    > 376 |       expect(evaluate('=TEXTBEFORE("A:B:C:D", ":", -1)')).toBe('A:B:C');
          |                                                           ^
      377 |       expect(evaluate('=TEXTBEFORE("A:B:C:D", ":", -2)')).toBe('A:B');
      378 |     });
      379 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:376:59)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should handle email addresses

    expect(received).toBe(expected) // Object.is equality

    Expected: "test"
    Received: [Error: #NAME?]

      379 |
      380 |     test('should handle email addresses', () => {
    > 381 |       expect(evaluate('=TEXTBEFORE("test@example.com", "@")')).toBe('test');
          |                                                                ^
      382 |     });
      383 |
      384 |     test('should handle file paths', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:381:64)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should handle file paths

    expect(received).toBe(expected) // Object.is equality

    Expected: "folder"
    Received: [Error: #NAME?]

      383 |
      384 |     test('should handle file paths', () => {
    > 385 |       expect(evaluate('=TEXTBEFORE("folder/subfolder/file.txt", "/")')).toBe('folder');
          |                                                                         ^
      386 |     });
      387 |
      388 |     test('should return error when delimiter not found', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:385:73)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should return error when delimiter not found

    expect(received).toBe(expected) // Object.is equality

    Expected: "#N/A"
    Received: "#NAME?"

      389 |       const result = evaluate('=TEXTBEFORE("Hello", "-")');
      390 |       expect(result).toBeInstanceOf(Error);
    > 391 |       expect((result as Error).message).toBe('#N/A');
          |                                         ^
      392 |     });
      393 |
      394 |     test('should return full text when match_end is non-zero and delimiter not found', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:391:41)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should return full text when match_end is non-zero and delimiter not found

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello"
    Received: [Error: #NAME?]

      393 |
      394 |     test('should return full text when match_end is non-zero and delimiter not found', () => {
    > 395 |       expect(evaluate('=TEXTBEFORE("Hello", "-", 1, 0, 1)')).toBe('Hello');
          |                                                              ^
      396 |     });
      397 |
      398 |     test('should use if_not_found parameter', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:395:62)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should use if_not_found parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: "NotFound"
    Received: [Error: #NAME?]

      397 |
      398 |     test('should use if_not_found parameter', () => {
    > 399 |       expect(evaluate('=TEXTBEFORE("Hello", "-", 1, 0, 0, "NotFound")')).toBe('NotFound');
          |                                                                          ^
      400 |     });
      401 |
      402 |     test('should handle case-insensitive matching', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:399:74)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should handle case-insensitive matching

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello-"
    Received: [Error: #NAME?]

      401 |
      402 |     test('should handle case-insensitive matching', () => {
    > 403 |       expect(evaluate('=TEXTBEFORE("Hello-WORLD", "world", 1, 1)')).toBe('Hello-');
          |                                                                     ^
      404 |     });
      405 |
      406 |     test('should return error for invalid instance number', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:403:69)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should return error for invalid instance number

    expect(received).toBe(expected) // Object.is equality

    Expected: "#VALUE!"
    Received: "#NAME?"

      407 |       const result1 = evaluate('=TEXTBEFORE("A:B:C", ":", 0)');
      408 |       expect(result1).toBeInstanceOf(Error);
    > 409 |       expect((result1 as Error).message).toBe('#VALUE!');
          |                                          ^
      410 |
      411 |       const result2 = evaluate('=TEXTBEFORE("A:B:C", ":", 1.5)');
      412 |       expect(result2).toBeInstanceOf(Error);

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:409:42)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello"
    Received: [Error: #NAME?]

      416 |     test('should handle cell references', () => {
      417 |       setCellValue('A1', 'Hello-World');
    > 418 |       expect(evaluate('=TEXTBEFORE(A1, "-")')).toBe('Hello');
          |                                                ^
      419 |     });
      420 |   });
      421 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:418:48)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should extract text after first occurrence

    expect(received).toBe(expected) // Object.is equality

    Expected: "World"
    Received: [Error: #NAME?]

      426 |   describe('TEXTAFTER function', () => {
      427 |     test('should extract text after first occurrence', () => {
    > 428 |       expect(evaluate('=TEXTAFTER("Hello-World", "-")')).toBe('World');
          |                                                          ^
      429 |       expect(evaluate('=TEXTAFTER("First:Second:Third", ":")')).toBe('Second:Third');
      430 |     });
      431 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:428:58)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should extract text after specified occurrence

    expect(received).toBe(expected) // Object.is equality

    Expected: "C:D"
    Received: [Error: #NAME?]

      431 |
      432 |     test('should extract text after specified occurrence', () => {
    > 433 |       expect(evaluate('=TEXTAFTER("A:B:C:D", ":", 2)')).toBe('C:D');
          |                                                         ^
      434 |       expect(evaluate('=TEXTAFTER("A:B:C:D", ":", 3)')).toBe('D');
      435 |     });
      436 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:433:57)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should handle negative instance (from end)

    expect(received).toBe(expected) // Object.is equality

    Expected: "D"
    Received: [Error: #NAME?]

      436 |
      437 |     test('should handle negative instance (from end)', () => {
    > 438 |       expect(evaluate('=TEXTAFTER("A:B:C:D", ":", -1)')).toBe('D');
          |                                                          ^
      439 |       expect(evaluate('=TEXTAFTER("A:B:C:D", ":", -2)')).toBe('C:D');
      440 |     });
      441 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:438:58)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should handle email addresses

    expect(received).toBe(expected) // Object.is equality

    Expected: "example.com"
    Received: [Error: #NAME?]

      441 |
      442 |     test('should handle email addresses', () => {
    > 443 |       expect(evaluate('=TEXTAFTER("user@example.com", "@")')).toBe('example.com');
          |                                                               ^
      444 |     });
      445 |
      446 |     test('should handle file paths', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:443:63)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should handle file paths

    expect(received).toBe(expected) // Object.is equality

    Expected: "file.txt"
    Received: [Error: #NAME?]

      445 |
      446 |     test('should handle file paths', () => {
    > 447 |       expect(evaluate('=TEXTAFTER("folder/subfolder/file.txt", "/", -1)')).toBe('file.txt');
          |                                                                            ^
      448 |     });
      449 |
      450 |     test('should return error when delimiter not found', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:447:76)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should return error when delimiter not found

    expect(received).toBe(expected) // Object.is equality

    Expected: "#N/A"
    Received: "#NAME?"

      451 |       const result = evaluate('=TEXTAFTER("Hello", "-")');
      452 |       expect(result).toBeInstanceOf(Error);
    > 453 |       expect((result as Error).message).toBe('#N/A');
          |                                         ^
      454 |     });
      455 |
      456 |     test('should return full text when match_end is non-zero and delimiter not found', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:453:41)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should return full text when match_end is non-zero and delimiter not found

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello"
    Received: [Error: #NAME?]

      455 |
      456 |     test('should return full text when match_end is non-zero and delimiter not found', () => {
    > 457 |       expect(evaluate('=TEXTAFTER("Hello", "-", 1, 0, 1)')).toBe('Hello');
          |                                                             ^
      458 |     });
      459 |
      460 |     test('should use if_not_found parameter', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:457:61)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should use if_not_found parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: "NotFound"
    Received: [Error: #NAME?]

      459 |
      460 |     test('should use if_not_found parameter', () => {
    > 461 |       expect(evaluate('=TEXTAFTER("Hello", "-", 1, 0, 0, "NotFound")')).toBe('NotFound');
          |                                                                         ^
      462 |     });
      463 |
      464 |     test('should handle case-insensitive matching', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:461:73)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should handle case-insensitive matching

    expect(received).toBe(expected) // Object.is equality

    Expected: "-WORLD"
    Received: [Error: #NAME?]

      463 |
      464 |     test('should handle case-insensitive matching', () => {
    > 465 |       expect(evaluate('=TEXTAFTER("Hello-WORLD", "hello", 1, 1)')).toBe('-WORLD');
          |                                                                    ^
      466 |     });
      467 |
      468 |     test('should return error for invalid instance number', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:465:68)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should return error for invalid instance number

    expect(received).toBe(expected) // Object.is equality

    Expected: "#VALUE!"
    Received: "#NAME?"

      469 |       const result1 = evaluate('=TEXTAFTER("A:B:C", ":", 0)');
      470 |       expect(result1).toBeInstanceOf(Error);
    > 471 |       expect((result1 as Error).message).toBe('#VALUE!');
          |                                          ^
      472 |
      473 |       const result2 = evaluate('=TEXTAFTER("A:B:C", ":", 1.5)');
      474 |       expect(result2).toBeInstanceOf(Error);

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:471:42)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: "World"
    Received: [Error: #NAME?]

      478 |     test('should handle cell references', () => {
      479 |       setCellValue('A1', 'Hello-World');
    > 480 |       expect(evaluate('=TEXTAFTER(A1, "-")')).toBe('World');
          |                                               ^
      481 |     });
      482 |
      483 |     test('should work with TEXTBEFORE for text extraction', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:480:47)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should work with TEXTBEFORE for text extraction

    expect(received).toBe(expected) // Object.is equality

    Expected: "john.doe"
    Received: [Error: #NAME?]

      486 |       
      487 |       // Extract username
    > 488 |       expect(evaluate('=TEXTBEFORE(A1, "@")')).toBe('john.doe');
          |                                                ^
      489 |       
      490 |       // Extract domain
      491 |       expect(evaluate('=TEXTAFTER(A1, "@")')).toBe('company.com');

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:488:48)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ Integration tests ‚Ä∫ CONCAT with PROPER for name formatting

    expect(received).toBe(expected) // Object.is equality

    Expected: "John Doe"
    Received: " "

      501 |       setCellValue('A1', 'john');
      502 |       setCellValue('B1', 'doe');
    > 503 |       expect(evaluate('=CONCAT(PROPER(A1), " ", PROPER(B1))')).toBe('John Doe');
          |                                                                ^
      504 |     });
      505 |
      506 |     test('UNICHAR and UNICODE are inverses', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:503:64)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ Integration tests ‚Ä∫ CLEAN with CONCAT for sanitizing data

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello World"
    Received: " "

      512 |       setCellValue('A1', 'Hello\x07');
      513 |       setCellValue('A2', 'World\x1B');
    > 514 |       expect(evaluate('=CONCAT(CLEAN(A1), " ", CLEAN(A2))')).toBe('Hello World');
          |                                                              ^
      515 |     });
      516 |
      517 |     test('TEXTBEFORE and TEXTAFTER for parsing', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:514:62)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ Integration tests ‚Ä∫ TEXTBEFORE and TEXTAFTER for parsing

    expect(received).toBe(expected) // Object.is equality

    Expected: "First"
    Received: [Error: #NAME?]

      517 |     test('TEXTBEFORE and TEXTAFTER for parsing', () => {
      518 |       setCellValue('A1', 'First-Middle-Last');
    > 519 |       expect(evaluate('=TEXTBEFORE(A1, "-")')).toBe('First');
          |                                                ^
      520 |       expect(evaluate('=TEXTAFTER(TEXTBEFORE(A1, "-", 2), "-")')).toBe('Middle');
      521 |       expect(evaluate('=TEXTAFTER(A1, "-", -1)')).toBe('Last');
      522 |     });

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:519:48)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ Integration tests ‚Ä∫ DOLLAR and FIXED for different formatting needs

    expect(received).toBe(expected) // Object.is equality

    Expected: "$1,234.57"
    Received: "$0.00"

      524 |     test('DOLLAR and FIXED for different formatting needs', () => {
      525 |       setCellValue('A1', 1234.567);
    > 526 |       expect(evaluate('=DOLLAR(A1)')).toBe('$1,234.57');
          |                                       ^
      527 |       expect(evaluate('=FIXED(A1, 1)')).toBe('1,234.6');
      528 |       expect(evaluate('=FIXED(A1, 1, TRUE)')).toBe('1234.6');
      529 |     });

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:526:39)

(node:75090) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/functions/engineering.test.ts (5.614 s)
  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should perform bitwise AND on simple numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #NAME?]

      389 |     test('should perform bitwise AND on simple numbers', () => {
      390 |       const result = evaluate('=BITAND(5, 3)');
    > 391 |       expect(result).toBe(1); // 101 AND 011 = 001
          |                      ^
      392 |     });
      393 |
      394 |     test('should perform bitwise AND on larger numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:391:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should perform bitwise AND on larger numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 9
    Received: [Error: #NAME?]

      394 |     test('should perform bitwise AND on larger numbers', () => {
      395 |       const result = evaluate('=BITAND(13, 25)');
    > 396 |       expect(result).toBe(9); // 1101 AND 11001 = 01001
          |                      ^
      397 |     });
      398 |
      399 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:396:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      398 |
      399 |     test('should handle zero', () => {
    > 400 |       expect(evaluate('=BITAND(0, 0)')).toBe(0);
          |                                         ^
      401 |       expect(evaluate('=BITAND(15, 0)')).toBe(0);
      402 |       expect(evaluate('=BITAND(0, 15)')).toBe(0);
      403 |     });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:400:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should handle same numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      405 |     test('should handle same numbers', () => {
      406 |       const result = evaluate('=BITAND(42, 42)');
    > 407 |       expect(result).toBe(42);
          |                      ^
      408 |     });
      409 |
      410 |     test('should return #NUM! for negative numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:407:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should return #NUM! for negative numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      411 |       const result = evaluate('=BITAND(-1, 5)');
      412 |       expect(result).toBeInstanceOf(Error);
    > 413 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      414 |     });
      415 |
      416 |     test('should return #NUM! for non-integer', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:413:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should return #NUM! for non-integer

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      417 |       const result = evaluate('=BITAND(5.5, 3)');
      418 |       expect(result).toBeInstanceOf(Error);
    > 419 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      420 |     });
      421 |
      422 |     test('should return #NUM! for numbers exceeding 2^48-1', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:419:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should return #NUM! for numbers exceeding 2^48-1

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      424 |       const result = evaluate(`=BITAND(${MAX}, 1)`);
      425 |       expect(result).toBeInstanceOf(Error);
    > 426 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      427 |     });
      428 |
      429 |     test('should work with large safe numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:426:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should work with large safe numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 458752
    Received: [Error: #NAME?]

      429 |     test('should work with large safe numbers', () => {
      430 |       const result = evaluate('=BITAND(1000000, 500000)');
    > 431 |       expect(result).toBe(1000000 & 500000);
          |                      ^
      432 |     });
      433 |   });
      434 |

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:431:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should perform bitwise OR on simple numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 7
    Received: [Error: #NAME?]

      436 |     test('should perform bitwise OR on simple numbers', () => {
      437 |       const result = evaluate('=BITOR(5, 3)');
    > 438 |       expect(result).toBe(7); // 101 OR 011 = 111
          |                      ^
      439 |     });
      440 |
      441 |     test('should perform bitwise OR on larger numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:438:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should perform bitwise OR on larger numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 29
    Received: [Error: #NAME?]

      441 |     test('should perform bitwise OR on larger numbers', () => {
      442 |       const result = evaluate('=BITOR(13, 25)');
    > 443 |       expect(result).toBe(29); // 01101 OR 11001 = 11101
          |                      ^
      444 |     });
      445 |
      446 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:443:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      445 |
      446 |     test('should handle zero', () => {
    > 447 |       expect(evaluate('=BITOR(0, 0)')).toBe(0);
          |                                        ^
      448 |       expect(evaluate('=BITOR(15, 0)')).toBe(15);
      449 |       expect(evaluate('=BITOR(0, 15)')).toBe(15);
      450 |     });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:447:40)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should handle same numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      452 |     test('should handle same numbers', () => {
      453 |       const result = evaluate('=BITOR(42, 42)');
    > 454 |       expect(result).toBe(42);
          |                      ^
      455 |     });
      456 |
      457 |     test('should return #NUM! for negative numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:454:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should return #NUM! for negative numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      458 |       const result = evaluate('=BITOR(-1, 5)');
      459 |       expect(result).toBeInstanceOf(Error);
    > 460 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      461 |     });
      462 |
      463 |     test('should return #NUM! for non-integer', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:460:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should return #NUM! for non-integer

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      464 |       const result = evaluate('=BITOR(5.5, 3)');
      465 |       expect(result).toBeInstanceOf(Error);
    > 466 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      467 |     });
      468 |
      469 |     test('should work with large safe numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:466:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should work with large safe numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 1041248
    Received: [Error: #NAME?]

      469 |     test('should work with large safe numbers', () => {
      470 |       const result = evaluate('=BITOR(1000000, 500000)');
    > 471 |       expect(result).toBe(1000000 | 500000);
          |                      ^
      472 |     });
      473 |   });
      474 |

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:471:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should perform bitwise XOR on simple numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 6
    Received: [Error: #NAME?]

      476 |     test('should perform bitwise XOR on simple numbers', () => {
      477 |       const result = evaluate('=BITXOR(5, 3)');
    > 478 |       expect(result).toBe(6); // 101 XOR 011 = 110
          |                      ^
      479 |     });
      480 |
      481 |     test('should perform bitwise XOR on larger numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:478:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should perform bitwise XOR on larger numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 20
    Received: [Error: #NAME?]

      481 |     test('should perform bitwise XOR on larger numbers', () => {
      482 |       const result = evaluate('=BITXOR(13, 25)');
    > 483 |       expect(result).toBe(20); // 01101 XOR 11001 = 10100
          |                      ^
      484 |     });
      485 |
      486 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:483:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      485 |
      486 |     test('should handle zero', () => {
    > 487 |       expect(evaluate('=BITXOR(0, 0)')).toBe(0);
          |                                         ^
      488 |       expect(evaluate('=BITXOR(15, 0)')).toBe(15);
      489 |       expect(evaluate('=BITXOR(0, 15)')).toBe(15);
      490 |     });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:487:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should handle same numbers (result is 0)

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      492 |     test('should handle same numbers (result is 0)', () => {
      493 |       const result = evaluate('=BITXOR(42, 42)');
    > 494 |       expect(result).toBe(0);
          |                      ^
      495 |     });
      496 |
      497 |     test('should return #NUM! for negative numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:494:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should return #NUM! for negative numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      498 |       const result = evaluate('=BITXOR(-1, 5)');
      499 |       expect(result).toBeInstanceOf(Error);
    > 500 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      501 |     });
      502 |
      503 |     test('should return #NUM! for non-integer', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:500:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should return #NUM! for non-integer

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      504 |       const result = evaluate('=BITXOR(5.5, 3)');
      505 |       expect(result).toBeInstanceOf(Error);
    > 506 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      507 |     });
      508 |
      509 |     test('should work with large safe numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:506:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should work with large safe numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 582496
    Received: [Error: #NAME?]

      509 |     test('should work with large safe numbers', () => {
      510 |       const result = evaluate('=BITXOR(1000000, 500000)');
    > 511 |       expect(result).toBe(1000000 ^ 500000);
          |                      ^
      512 |     });
      513 |
      514 |     test('XOR twice should return original', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:511:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ XOR twice should return original

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      516 |       const result1 = evaluate('=BITXOR(42, 17)');
      517 |       const result2 = evaluate(`=BITXOR(${result1}, 17)`);
    > 518 |       expect(result2).toBe(42);
          |                       ^
      519 |     });
      520 |   });
      521 |

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:518:23)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should shift left by specified bits

    expect(received).toBe(expected) // Object.is equality

    Expected: 20
    Received: [Error: #NAME?]

      523 |     test('should shift left by specified bits', () => {
      524 |       const result = evaluate('=BITLSHIFT(5, 2)');
    > 525 |       expect(result).toBe(20); // 101 << 2 = 10100
          |                      ^
      526 |     });
      527 |
      528 |     test('should shift left by 4 bits', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:525:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should shift left by 4 bits

    expect(received).toBe(expected) // Object.is equality

    Expected: 48
    Received: [Error: #NAME?]

      528 |     test('should shift left by 4 bits', () => {
      529 |       const result = evaluate('=BITLSHIFT(3, 4)');
    > 530 |       expect(result).toBe(48); // 11 << 4 = 110000
          |                      ^
      531 |     });
      532 |
      533 |     test('should handle zero shift', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:530:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should handle zero shift

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      533 |     test('should handle zero shift', () => {
      534 |       const result = evaluate('=BITLSHIFT(42, 0)');
    > 535 |       expect(result).toBe(42);
          |                      ^
      536 |     });
      537 |
      538 |     test('should handle zero value', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:535:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should handle zero value

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      538 |     test('should handle zero value', () => {
      539 |       const result = evaluate('=BITLSHIFT(0, 5)');
    > 540 |       expect(result).toBe(0);
          |                      ^
      541 |     });
      542 |
      543 |     test('should multiply by powers of 2', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:540:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should multiply by powers of 2

    expect(received).toBe(expected) // Object.is equality

    Expected: 14
    Received: [Error: #NAME?]

      543 |     test('should multiply by powers of 2', () => {
      544 |       // Left shift by N is equivalent to multiply by 2^N
    > 545 |       expect(evaluate('=BITLSHIFT(7, 1)')).toBe(14); // 7 * 2
          |                                            ^
      546 |       expect(evaluate('=BITLSHIFT(7, 2)')).toBe(28); // 7 * 4
      547 |       expect(evaluate('=BITLSHIFT(7, 3)')).toBe(56); // 7 * 8
      548 |     });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:545:44)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should return #NUM! for negative number

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      551 |       const result = evaluate('=BITLSHIFT(-5, 2)');
      552 |       expect(result).toBeInstanceOf(Error);
    > 553 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      554 |     });
      555 |
      556 |     test('should return #NUM! for non-integer', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:553:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should return #NUM! for non-integer

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      557 |       const result = evaluate('=BITLSHIFT(5.5, 2)');
      558 |       expect(result).toBeInstanceOf(Error);
    > 559 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      560 |     });
      561 |
      562 |     test('should return #NUM! if result exceeds 2^48-1', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:559:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should return #NUM! if result exceeds 2^48-1

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      563 |       const result = evaluate('=BITLSHIFT(1000000000000, 10)');
      564 |       expect(result).toBeInstanceOf(Error);
    > 565 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      566 |     });
      567 |
      568 |     test('negative shift should perform right shift', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:565:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ negative shift should perform right shift

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NAME?]

      568 |     test('negative shift should perform right shift', () => {
      569 |       const result = evaluate('=BITLSHIFT(20, -2)');
    > 570 |       expect(result).toBe(5); // Same as BITRSHIFT(20, 2)
          |                      ^
      571 |     });
      572 |   });
      573 |

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:570:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should shift right by specified bits

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NAME?]

      575 |     test('should shift right by specified bits', () => {
      576 |       const result = evaluate('=BITRSHIFT(20, 2)');
    > 577 |       expect(result).toBe(5); // 10100 >> 2 = 101
          |                      ^
      578 |     });
      579 |
      580 |     test('should shift right by 4 bits', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:577:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should shift right by 4 bits

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: [Error: #NAME?]

      580 |     test('should shift right by 4 bits', () => {
      581 |       const result = evaluate('=BITRSHIFT(48, 4)');
    > 582 |       expect(result).toBe(3); // 110000 >> 4 = 11
          |                      ^
      583 |     });
      584 |
      585 |     test('should handle zero shift', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:582:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should handle zero shift

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      585 |     test('should handle zero shift', () => {
      586 |       const result = evaluate('=BITRSHIFT(42, 0)');
    > 587 |       expect(result).toBe(42);
          |                      ^
      588 |     });
      589 |
      590 |     test('should handle zero value', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:587:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should handle zero value

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      590 |     test('should handle zero value', () => {
      591 |       const result = evaluate('=BITRSHIFT(0, 5)');
    > 592 |       expect(result).toBe(0);
          |                      ^
      593 |     });
      594 |
      595 |     test('should divide by powers of 2 (integer division)', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:592:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should divide by powers of 2 (integer division)

    expect(received).toBe(expected) // Object.is equality

    Expected: 7
    Received: [Error: #NAME?]

      595 |     test('should divide by powers of 2 (integer division)', () => {
      596 |       // Right shift by N is equivalent to integer division by 2^N
    > 597 |       expect(evaluate('=BITRSHIFT(14, 1)')).toBe(7); // 14 / 2
          |                                             ^
      598 |       expect(evaluate('=BITRSHIFT(28, 2)')).toBe(7); // 28 / 4
      599 |       expect(evaluate('=BITRSHIFT(56, 3)')).toBe(7); // 56 / 8
      600 |     });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:597:45)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should return #NUM! for negative number

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      603 |       const result = evaluate('=BITRSHIFT(-5, 2)');
      604 |       expect(result).toBeInstanceOf(Error);
    > 605 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      606 |     });
      607 |
      608 |     test('should return #NUM! for non-integer', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:605:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should return #NUM! for non-integer

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      609 |       const result = evaluate('=BITRSHIFT(5.5, 2)');
      610 |       expect(result).toBeInstanceOf(Error);
    > 611 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      612 |     });
      613 |
      614 |     test('large shift should return 0', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:611:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ large shift should return 0

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      614 |     test('large shift should return 0', () => {
      615 |       const result = evaluate('=BITRSHIFT(42, 100)');
    > 616 |       expect(result).toBe(0);
          |                      ^
      617 |     });
      618 |
      619 |     test('negative shift should perform left shift', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:616:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ negative shift should perform left shift

    expect(received).toBe(expected) // Object.is equality

    Expected: 20
    Received: [Error: #NAME?]

      619 |     test('negative shift should perform left shift', () => {
      620 |       const result = evaluate('=BITRSHIFT(5, -2)');
    > 621 |       expect(result).toBe(20); // Same as BITLSHIFT(5, 2)
          |                      ^
      622 |     });
      623 |   });
      624 |

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:621:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ Bitwise integration tests ‚Ä∫ BITAND and BITOR relationship

    expect(received).toBe(expected) // Object.is equality

    If it should pass with deep equality, replace "toBe" with "toStrictEqual"

    Expected: [Error: #NAME?]
    Received: serializes to the same string

      632 |       const orFromParts = evaluate(`=BITOR(${andResult}, ${xorResult})`);
      633 |       const orDirect = evaluate(`=BITOR(${a}, ${b})`);
    > 634 |       expect(orFromParts).toBe(orDirect);
          |                           ^
      635 |     });
      636 |
      637 |     test('shift operations are inverse', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:634:27)

  ‚óè Bitwise Engineering Functions ‚Ä∫ Bitwise integration tests ‚Ä∫ shift operations are inverse

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      640 |       const shifted = evaluate(`=BITLSHIFT(${original}, 3)`);
      641 |       const restored = evaluate(`=BITRSHIFT(${shifted}, 3)`);
    > 642 |       expect(restored).toBe(original);
          |                        ^
      643 |     });
      644 |
      645 |     test('XOR with all 1s is equivalent to NOT', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:642:24)

  ‚óè Bitwise Engineering Functions ‚Ä∫ Bitwise integration tests ‚Ä∫ XOR with all 1s is equivalent to NOT

    expect(received).toBe(expected) // Object.is equality

    Expected: 213
    Received: [Error: #NAME?]

      648 |       const mask = 255;
      649 |       const result = evaluate(`=BITXOR(${a}, ${mask})`);
    > 650 |       expect(result).toBe(213); // ~42 in 8-bit = 213
          |                      ^
      651 |     });
      652 |
      653 |     test('combining operations', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:650:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ Bitwise integration tests ‚Ä∫ combining operations

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      664 |       
      665 |       // Result should be A masked to 8 bits
    > 666 |       expect(result).toBe(a);
          |                      ^
      667 |     });
      668 |
      669 |     test('shift and AND for masking', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:666:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ Bitwise integration tests ‚Ä∫ shift and AND for masking

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NAME?]

      675 |       const masked = evaluate(`=BITAND(${shifted}, 7)`);
      676 |       
    > 677 |       expect(masked).toBe(5); // bits 2-4 are 101 = 5
          |                      ^
      678 |     });
      679 |   });
      680 | });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:677:22)

(node:75147) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/functions/engineering-advanced.test.ts (5.14 s)
  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should add two complex numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "4+6i"
    Received: [Error: #NAME?]

      30 |   describe('IMADD', () => {
      31 |     test('should add two complex numbers', () => {
    > 32 |       expect(evaluate('=IMADD("3+4i", "1+2i")')).toBe('4+6i');
         |                                                  ^
      33 |     });
      34 |
      35 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:32:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should handle j suffix

    expect(received).toBe(expected) // Object.is equality

    Expected: "4+6j"
    Received: [Error: #NAME?]

      34 |
      35 |     test('should handle j suffix', () => {
    > 36 |       expect(evaluate('=IMADD("3+4j", "1+2j")')).toBe('4+6j');
         |                                                  ^
      37 |     });
      38 |
      39 |     test('should handle negative imaginary parts', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:36:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should handle negative imaginary parts

    expect(received).toBe(expected) // Object.is equality

    Expected: "8-2i"
    Received: [Error: #NAME?]

      38 |
      39 |     test('should handle negative imaginary parts', () => {
    > 40 |       expect(evaluate('=IMADD("5+2i", "3-4i")')).toBe('8-2i');
         |                                                  ^
      41 |     });
      42 |
      43 |     test('should handle real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:40:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should handle real numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "8"
    Received: [Error: #NAME?]

      42 |
      43 |     test('should handle real numbers', () => {
    > 44 |       expect(evaluate('=IMADD("5", "3")')).toBe('8');
         |                                            ^
      45 |     });
      46 |
      47 |     test('should handle purely imaginary numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:44:44)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should handle purely imaginary numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "5i"
    Received: [Error: #NAME?]

      46 |
      47 |     test('should handle purely imaginary numbers', () => {
    > 48 |       expect(evaluate('=IMADD("3i", "2i")')).toBe('5i');
         |                                              ^
      49 |     });
      50 |
      51 |     test('should handle zero results', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:48:46)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should handle zero results

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      50 |
      51 |     test('should handle zero results', () => {
    > 52 |       expect(evaluate('=IMADD("3+2i", "-3-2i")')).toBe('0');
         |                                                   ^
      53 |     });
      54 |   });
      55 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:52:51)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should subtract two complex numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "3+3i"
    Received: [Error: #NAME?]

      59 |   describe('IMSUB', () => {
      60 |     test('should subtract two complex numbers', () => {
    > 61 |       expect(evaluate('=IMSUB("5+6i", "2+3i")')).toBe('3+3i');
         |                                                  ^
      62 |     });
      63 |
      64 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:61:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should handle j suffix

    expect(received).toBe(expected) // Object.is equality

    Expected: "3+3j"
    Received: [Error: #NAME?]

      63 |
      64 |     test('should handle j suffix', () => {
    > 65 |       expect(evaluate('=IMSUB("5+6j", "2+3j")')).toBe('3+3j');
         |                                                  ^
      66 |     });
      67 |
      68 |     test('should handle negative results', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:65:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should handle negative results

    expect(received).toBe(expected) // Object.is equality

    Expected: "-3-4i"
    Received: [Error: #NAME?]

      67 |
      68 |     test('should handle negative results', () => {
    > 69 |       expect(evaluate('=IMSUB("2+3i", "5+7i")')).toBe('-3-4i');
         |                                                  ^
      70 |     });
      71 |
      72 |     test('should handle real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:69:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should handle real numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "6"
    Received: [Error: #NAME?]

      71 |
      72 |     test('should handle real numbers', () => {
    > 73 |       expect(evaluate('=IMSUB("10", "4")')).toBe('6');
         |                                             ^
      74 |     });
      75 |
      76 |     test('should handle purely imaginary numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:73:45)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should handle purely imaginary numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "3i"
    Received: [Error: #NAME?]

      75 |
      76 |     test('should handle purely imaginary numbers', () => {
    > 77 |       expect(evaluate('=IMSUB("5i", "2i")')).toBe('3i');
         |                                              ^
      78 |     });
      79 |
      80 |     test('should handle zero results', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:77:46)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should handle zero results

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      79 |
      80 |     test('should handle zero results', () => {
    > 81 |       expect(evaluate('=IMSUB("3+2i", "3+2i")')).toBe('0');
         |                                                  ^
      82 |     });
      83 |   });
      84 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:81:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should multiply two complex numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "-5+14i"
    Received: [Error: #NAME?]

      88 |   describe('IMMULT', () => {
      89 |     test('should multiply two complex numbers', () => {
    > 90 |       expect(evaluate('=IMMULT("3+2i", "1+4i")')).toBe('-5+14i');
         |                                                   ^
      91 |     });
      92 |
      93 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:90:51)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should handle j suffix

    expect(received).toBe(expected) // Object.is equality

    Expected: "-5+14j"
    Received: [Error: #NAME?]

      92 |
      93 |     test('should handle j suffix', () => {
    > 94 |       expect(evaluate('=IMMULT("3+2j", "1+4j")')).toBe('-5+14j');
         |                                                   ^
      95 |     });
      96 |
      97 |     test('should handle i*i = -1', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:94:51)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should handle i*i = -1

    expect(received).toBe(expected) // Object.is equality

    Expected: "-1"
    Received: [Error: #NAME?]

       96 |
       97 |     test('should handle i*i = -1', () => {
    >  98 |       expect(evaluate('=IMMULT("i", "i")')).toBe('-1');
          |                                             ^
       99 |     });
      100 |
      101 |     test('should handle real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:98:45)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should handle real numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "15"
    Received: [Error: #NAME?]

      100 |
      101 |     test('should handle real numbers', () => {
    > 102 |       expect(evaluate('=IMMULT("5", "3")')).toBe('15');
          |                                             ^
      103 |     });
      104 |
      105 |     test('should handle multiplication by zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:102:45)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should handle multiplication by zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      104 |
      105 |     test('should handle multiplication by zero', () => {
    > 106 |       expect(evaluate('=IMMULT("3+2i", "0")')).toBe('0');
          |                                                ^
      107 |     });
      108 |
      109 |     test('should handle negative imaginary parts', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:106:48)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should handle negative imaginary parts

    expect(received).toBe(expected) // Object.is equality

    Expected: "23+2i"
    Received: [Error: #NAME?]

      108 |
      109 |     test('should handle negative imaginary parts', () => {
    > 110 |       expect(evaluate('=IMMULT("2+3i", "4-5i")')).toBe('23+2i');
          |                                                   ^
      111 |     });
      112 |   });
      113 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:110:51)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should divide two complex numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "0.44+0.08i"
    Received: [Error: #NAME?]

      117 |   describe('IMDIV', () => {
      118 |     test('should divide two complex numbers', () => {
    > 119 |       expect(evaluate('=IMDIV("1+2i", "3+4i")')).toBe('0.44+0.08i');
          |                                                  ^
      120 |     });
      121 |
      122 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:119:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should handle j suffix

    expect(received).toBe(expected) // Object.is equality

    Expected: "0.44+0.08j"
    Received: [Error: #NAME?]

      121 |
      122 |     test('should handle j suffix', () => {
    > 123 |       expect(evaluate('=IMDIV("1+2j", "3+4j")')).toBe('0.44+0.08j');
          |                                                  ^
      124 |     });
      125 |
      126 |     test('should handle division by real number', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:123:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should handle division by real number

    expect(received).toMatch(expected)

    Expected pattern: /2\+1?i/
    Received string:  "Error: #NAME?"

      126 |     test('should handle division by real number', () => {
      127 |       const result = String(evaluate('=IMDIV("4+2i", "2")'));
    > 128 |       expect(result).toMatch(/2\+1?i/); // Handles both "2+i" and "2+1i"
          |                      ^
      129 |     });
      130 |
      131 |     test('should return error for division by zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:128:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should return error for division by zero

    expect(received).toMatch(expected)

    Expected pattern: /#NUM!/
    Received string:  "Error: #NAME?"

      131 |     test('should return error for division by zero', () => {
      132 |       const result = evaluate('=IMDIV("5+3i", "0")');
    > 133 |       expect(String(result)).toMatch(/#NUM!/);
          |                              ^
      134 |     });
      135 |
      136 |     test('should handle negative imaginary parts', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:133:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should handle negative imaginary parts

    expect(received).toBe(expected) // Object.is equality

    Expected: "4+2i"
    Received: [Error: #NAME?]

      135 |
      136 |     test('should handle negative imaginary parts', () => {
    > 137 |       expect(evaluate('=IMDIV("10", "2-i")')).toBe('4+2i');
          |                                               ^
      138 |     });
      139 |
      140 |     test('should handle purely imaginary divisor', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:137:47)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should handle purely imaginary divisor

    expect(received).toBe(expected) // Object.is equality

    Expected: "-2i"
    Received: [Error: #NAME?]

      139 |
      140 |     test('should handle purely imaginary divisor', () => {
    > 141 |       expect(evaluate('=IMDIV("4", "2i")')).toBe('-2i');
          |                                             ^
      142 |     });
      143 |   });
      144 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:141:45)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should raise complex number to integer power

    expect(received).toMatch(expected)

    Expected pattern: /[\d.e\-+]+\+2(\.\d+)?i/
    Received string:  "Error: #NAME?"

      150 |       const result = String(evaluate('=IMPOWER("1+i", 2)'));
      151 |       // (1+i)^2 = 2i, allowing for floating point errors
    > 152 |       expect(result).toMatch(/[\d.e\-+]+\+2(\.\d+)?i/);
          |                      ^
      153 |     });
      154 |
      155 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:152:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /[\d.e\-+]+\+2(\.\d+)?j/
    Received string:  "Error: #NAME?"

      155 |     test('should handle j suffix', () => {
      156 |       const result = String(evaluate('=IMPOWER("1+j", 2)'));
    > 157 |       expect(result).toMatch(/[\d.e\-+]+\+2(\.\d+)?j/);
          |                      ^
      158 |     });
      159 |
      160 |     test('should handle power of 0', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:157:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should handle power of 0

    expect(received).toBe(expected) // Object.is equality

    Expected: "1"
    Received: [Error: #NAME?]

      159 |
      160 |     test('should handle power of 0', () => {
    > 161 |       expect(evaluate('=IMPOWER("3+4i", 0)')).toBe('1');
          |                                               ^
      162 |     });
      163 |
      164 |     test('should handle power of 1', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:161:47)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should handle power of 1

    expect(received).toMatch(expected)

    Expected pattern: /3(\.\d+)?\+3\.99\d+i|3\+4i/
    Received string:  "Error: #NAME?"

      165 |       const result = String(evaluate('=IMPOWER("3+4i", 1)'));
      166 |       // Should be 3+4i with possible floating point errors
    > 167 |       expect(result).toMatch(/3(\.\d+)?\+3\.99\d+i|3\+4i/);
          |                      ^
      168 |     });
      169 |
      170 |     test('should handle negative power', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:167:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should handle negative power

    expect(received).toBe(expected) // Object.is equality

    Expected: "0.5"
    Received: [Error: #NAME?]

      170 |     test('should handle negative power', () => {
      171 |       const result = evaluate('=IMPOWER("2", -1)');
    > 172 |       expect(result).toBe('0.5');
          |                      ^
      173 |     });
      174 |
      175 |     test('should handle fractional power', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:172:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should handle fractional power

    expect(received).toBe(expected) // Object.is equality

    Expected: "2"
    Received: [Error: #NAME?]

      175 |     test('should handle fractional power', () => {
      176 |       const result = evaluate('=IMPOWER("4", 0.5)');
    > 177 |       expect(result).toBe('2');
          |                      ^
      178 |     });
      179 |   });
      180 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:177:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSQRT ‚Ä∫ should calculate square root of complex number

    expect(received).toMatch(expected)

    Expected pattern: /1\.41421\d+\+1\.41421\d+i/
    Received string:  "Error: #NAME?"

      185 |     test('should calculate square root of complex number', () => {
      186 |       const result = String(evaluate('=IMSQRT("0+4i")'));
    > 187 |       expect(result).toMatch(/1\.41421\d+\+1\.41421\d+i/);
          |                      ^
      188 |     });
      189 |
      190 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:187:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSQRT ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /1\.41421\d+\+1\.41421\d+j/
    Received string:  "Error: #NAME?"

      190 |     test('should handle j suffix', () => {
      191 |       const result = String(evaluate('=IMSQRT("0+4j")'));
    > 192 |       expect(result).toMatch(/1\.41421\d+\+1\.41421\d+j/);
          |                      ^
      193 |     });
      194 |
      195 |     test('should handle real positive numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:192:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSQRT ‚Ä∫ should handle real positive numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "2"
    Received: [Error: #NAME?]

      194 |
      195 |     test('should handle real positive numbers', () => {
    > 196 |       expect(evaluate('=IMSQRT("4")')).toBe('2');
          |                                        ^
      197 |     });
      198 |
      199 |     test('should handle real negative numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:196:40)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSQRT ‚Ä∫ should handle real negative numbers

    expect(received).toMatch(expected)

    Expected pattern: /[\d.e\-+]*\+?2i/
    Received string:  "Error: #NAME?"

      200 |       const result = String(evaluate('=IMSQRT("-4")'));
      201 |       // Allow small real component near zero
    > 202 |       expect(result).toMatch(/[\d.e\-+]*\+?2i/);
          |                      ^
      203 |     });
      204 |
      205 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:202:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSQRT ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      204 |
      205 |     test('should handle zero', () => {
    > 206 |       expect(evaluate('=IMSQRT("0")')).toBe('0');
          |                                        ^
      207 |     });
      208 |   });
      209 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:206:40)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMEXP ‚Ä∫ should calculate exponential of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.54030\d+\+0\.84147\d+i/
    Received string:  "Error: #NAME?"

      214 |     test('should calculate exponential of complex number', () => {
      215 |       const result = evaluate('=IMEXP("0+i")');
    > 216 |       expect(String(result)).toMatch(/0\.54030\d+\+0\.84147\d+i/);
          |                              ^
      217 |     });
      218 |
      219 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:216:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMEXP ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.54030\d+\+0\.84147\d+j/
    Received string:  "Error: #NAME?"

      219 |     test('should handle j suffix', () => {
      220 |       const result = evaluate('=IMEXP("0+j")');
    > 221 |       expect(String(result)).toMatch(/0\.54030\d+\+0\.84147\d+j/);
          |                              ^
      222 |     });
      223 |
      224 |     test('should handle real numbers (e^x)', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:221:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMEXP ‚Ä∫ should handle real numbers (e^x)

    expect(received).toMatch(expected)

    Expected pattern: /2\.71828\d+/
    Received string:  "Error: #NAME?"

      224 |     test('should handle real numbers (e^x)', () => {
      225 |       const result = evaluate('=IMEXP("1")');
    > 226 |       expect(String(result)).toMatch(/2\.71828\d+/);
          |                              ^
      227 |     });
      228 |
      229 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:226:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMEXP ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "1"
    Received: [Error: #NAME?]

      228 |
      229 |     test('should handle zero', () => {
    > 230 |       expect(evaluate('=IMEXP("0")')).toBe('1');
          |                                       ^
      231 |     });
      232 |   });
      233 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:230:39)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLN ‚Ä∫ should calculate natural logarithm of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.34657\d+\+0\.78539\d+i/
    Received string:  "Error: #NAME?"

      238 |     test('should calculate natural logarithm of complex number', () => {
      239 |       const result = evaluate('=IMLN("1+i")');
    > 240 |       expect(String(result)).toMatch(/0\.34657\d+\+0\.78539\d+i/);
          |                              ^
      241 |     });
      242 |
      243 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:240:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLN ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.34657\d+\+0\.78539\d+j/
    Received string:  "Error: #NAME?"

      243 |     test('should handle j suffix', () => {
      244 |       const result = evaluate('=IMLN("1+j")');
    > 245 |       expect(String(result)).toMatch(/0\.34657\d+\+0\.78539\d+j/);
          |                              ^
      246 |     });
      247 |
      248 |     test('should handle positive real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:245:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLN ‚Ä∫ should handle positive real numbers

    expect(received).toMatch(expected)

    Expected pattern: /0\.99999\d+|1\.0+/
    Received string:  "Error: #NAME?"

      248 |     test('should handle positive real numbers', () => {
      249 |       const result = String(evaluate('=IMLN("2.71828")'));
    > 250 |       expect(result).toMatch(/0\.99999\d+|1\.0+/); // Close to 1
          |                      ^
      251 |     });
      252 |
      253 |     test('should handle negative real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:250:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLN ‚Ä∫ should handle negative real numbers

    expect(received).toMatch(expected)

    Expected pattern: /3\.14159\d+i/
    Received string:  "Error: #NAME?"

      254 |       const result = String(evaluate('=IMLN("-1")'));
      255 |       // May return just "3.14159...i" without leading "0+"
    > 256 |       expect(result).toMatch(/3\.14159\d+i/);
          |                      ^
      257 |     });
      258 |   });
      259 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:256:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG10 ‚Ä∫ should calculate base-10 logarithm of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.15051\d+\+0\.34109\d+i/
    Received string:  "Error: #NAME?"

      264 |     test('should calculate base-10 logarithm of complex number', () => {
      265 |       const result = evaluate('=IMLOG10("1+i")');
    > 266 |       expect(String(result)).toMatch(/0\.15051\d+\+0\.34109\d+i/);
          |                              ^
      267 |     });
      268 |
      269 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:266:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG10 ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.15051\d+\+0\.34109\d+j/
    Received string:  "Error: #NAME?"

      269 |     test('should handle j suffix', () => {
      270 |       const result = evaluate('=IMLOG10("1+j")');
    > 271 |       expect(String(result)).toMatch(/0\.15051\d+\+0\.34109\d+j/);
          |                              ^
      272 |     });
      273 |
      274 |     test('should handle powers of 10', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:271:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG10 ‚Ä∫ should handle powers of 10

    expect(received).toBe(expected) // Object.is equality

    Expected: "2"
    Received: [Error: #NAME?]

      273 |
      274 |     test('should handle powers of 10', () => {
    > 275 |       expect(evaluate('=IMLOG10("100")')).toBe('2');
          |                                           ^
      276 |     });
      277 |   });
      278 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:275:43)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG2 ‚Ä∫ should calculate base-2 logarithm of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.5(0+)?\d*\+1\.133\d+i/
    Received string:  "Error: #NAME?"

      283 |     test('should calculate base-2 logarithm of complex number', () => {
      284 |       const result = evaluate('=IMLOG2("1+i")');
    > 285 |       expect(String(result)).toMatch(/0\.5(0+)?\d*\+1\.133\d+i/);
          |                              ^
      286 |     });
      287 |
      288 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:285:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG2 ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.5(0+)?\d*\+1\.133\d+j/
    Received string:  "Error: #NAME?"

      288 |     test('should handle j suffix', () => {
      289 |       const result = evaluate('=IMLOG2("1+j")');
    > 290 |       expect(String(result)).toMatch(/0\.5(0+)?\d*\+1\.133\d+j/);
          |                              ^
      291 |     });
      292 |
      293 |     test('should handle powers of 2', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:290:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG2 ‚Ä∫ should handle powers of 2

    expect(received).toBe(expected) // Object.is equality

    Expected: "3"
    Received: [Error: #NAME?]

      292 |
      293 |     test('should handle powers of 2', () => {
    > 294 |       expect(evaluate('=IMLOG2("8")')).toBe('3');
          |                                        ^
      295 |     });
      296 |   });
      297 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:294:40)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSIN ‚Ä∫ should calculate sine of complex number

    expect(received).toMatch(expected)

    Expected pattern: /1\.29845\d+\+0\.63496\d+i/
    Received string:  "Error: #NAME?"

      302 |     test('should calculate sine of complex number', () => {
      303 |       const result = evaluate('=IMSIN("1+i")');
    > 304 |       expect(String(result)).toMatch(/1\.29845\d+\+0\.63496\d+i/);
          |                              ^
      305 |     });
      306 |
      307 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:304:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSIN ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /1\.29845\d+\+0\.63496\d+j/
    Received string:  "Error: #NAME?"

      307 |     test('should handle j suffix', () => {
      308 |       const result = evaluate('=IMSIN("1+j")');
    > 309 |       expect(String(result)).toMatch(/1\.29845\d+\+0\.63496\d+j/);
          |                              ^
      310 |     });
      311 |
      312 |     test('should handle real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:309:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSIN ‚Ä∫ should handle real numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      312 |     test('should handle real numbers', () => {
      313 |       const result = evaluate('=IMSIN("0")');
    > 314 |       expect(result).toBe('0');
          |                      ^
      315 |     });
      316 |   });
      317 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:314:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOS ‚Ä∫ should calculate cosine of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.83373\d+-0\.98889\d+i/
    Received string:  "Error: #NAME?"

      322 |     test('should calculate cosine of complex number', () => {
      323 |       const result = evaluate('=IMCOS("1+i")');
    > 324 |       expect(String(result)).toMatch(/0\.83373\d+-0\.98889\d+i/);
          |                              ^
      325 |     });
      326 |
      327 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:324:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOS ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.83373\d+-0\.98889\d+j/
    Received string:  "Error: #NAME?"

      327 |     test('should handle j suffix', () => {
      328 |       const result = evaluate('=IMCOS("1+j")');
    > 329 |       expect(String(result)).toMatch(/0\.83373\d+-0\.98889\d+j/);
          |                              ^
      330 |     });
      331 |
      332 |     test('should handle real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:329:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOS ‚Ä∫ should handle real numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "1"
    Received: [Error: #NAME?]

      332 |     test('should handle real numbers', () => {
      333 |       const result = evaluate('=IMCOS("0")');
    > 334 |       expect(result).toBe('1');
          |                      ^
      335 |     });
      336 |   });
      337 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:334:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMTAN ‚Ä∫ should calculate tangent of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.27175\d+\+1\.08392\d+i/
    Received string:  "Error: #NAME?"

      342 |     test('should calculate tangent of complex number', () => {
      343 |       const result = evaluate('=IMTAN("1+i")');
    > 344 |       expect(String(result)).toMatch(/0\.27175\d+\+1\.08392\d+i/);
          |                              ^
      345 |     });
      346 |
      347 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:344:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMTAN ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.27175\d+\+1\.08392\d+j/
    Received string:  "Error: #NAME?"

      347 |     test('should handle j suffix', () => {
      348 |       const result = evaluate('=IMTAN("1+j")');
    > 349 |       expect(String(result)).toMatch(/0\.27175\d+\+1\.08392\d+j/);
          |                              ^
      350 |     });
      351 |
      352 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:349:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMTAN ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      351 |
      352 |     test('should handle zero', () => {
    > 353 |       expect(evaluate('=IMTAN("0")')).toBe('0');
          |                                       ^
      354 |     });
      355 |   });
      356 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:353:39)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSEC ‚Ä∫ should calculate secant of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.49833\d+\+0\.59108\d+[ij]/
    Received string:  "Error: #NAME?"

      361 |     test('should calculate secant of complex number', () => {
      362 |       const result = evaluate('=IMSEC("1+i")');
    > 363 |       expect(String(result)).toMatch(/0\.49833\d+\+0\.59108\d+[ij]/);
          |                              ^
      364 |     });
      365 |
      366 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:363:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSEC ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.49833\d+\+0\.59108\d+[ij]/
    Received string:  "Error: #NAME?"

      366 |     test('should handle j suffix', () => {
      367 |       const result = evaluate('=IMSEC("1+j")');
    > 368 |       expect(String(result)).toMatch(/0\.49833\d+\+0\.59108\d+[ij]/);
          |                              ^
      369 |     });
      370 |   });
      371 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:368:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCSC ‚Ä∫ should calculate cosecant of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.62151\d+-0\.30393\d+[ij]/
    Received string:  "Error: #NAME?"

      376 |     test('should calculate cosecant of complex number', () => {
      377 |       const result = evaluate('=IMCSC("1+i")');
    > 378 |       expect(String(result)).toMatch(/0\.62151\d+-0\.30393\d+[ij]/);
          |                              ^
      379 |     });
      380 |
      381 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:378:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCSC ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.62151\d+-0\.30393\d+[ij]/
    Received string:  "Error: #NAME?"

      381 |     test('should handle j suffix', () => {
      382 |       const result = evaluate('=IMCSC("1+j")');
    > 383 |       expect(String(result)).toMatch(/0\.62151\d+-0\.30393\d+[ij]/);
          |                              ^
      384 |     });
      385 |   });
      386 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:383:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOT ‚Ä∫ should calculate cotangent of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.21762\d+-0\.86801\d+i/
    Received string:  "Error: #NAME?"

      391 |     test('should calculate cotangent of complex number', () => {
      392 |       const result = evaluate('=IMCOT("1+i")');
    > 393 |       expect(String(result)).toMatch(/0\.21762\d+-0\.86801\d+i/);
          |                              ^
      394 |     });
      395 |
      396 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:393:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOT ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.21762\d+-0\.86801\d+j/
    Received string:  "Error: #NAME?"

      396 |     test('should handle j suffix', () => {
      397 |       const result = evaluate('=IMCOT("1+j")');
    > 398 |       expect(String(result)).toMatch(/0\.21762\d+-0\.86801\d+j/);
          |                              ^
      399 |     });
      400 |   });
      401 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:398:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSINH ‚Ä∫ should calculate hyperbolic sine of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.63496\d+\+1\.29845\d+i/
    Received string:  "Error: #NAME?"

      406 |     test('should calculate hyperbolic sine of complex number', () => {
      407 |       const result = evaluate('=IMSINH("1+i")');
    > 408 |       expect(String(result)).toMatch(/0\.63496\d+\+1\.29845\d+i/);
          |                              ^
      409 |     });
      410 |
      411 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:408:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSINH ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.63496\d+\+1\.29845\d+j/
    Received string:  "Error: #NAME?"

      411 |     test('should handle j suffix', () => {
      412 |       const result = evaluate('=IMSINH("1+j")');
    > 413 |       expect(String(result)).toMatch(/0\.63496\d+\+1\.29845\d+j/);
          |                              ^
      414 |     });
      415 |
      416 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:413:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSINH ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      415 |
      416 |     test('should handle zero', () => {
    > 417 |       expect(evaluate('=IMSINH("0")')).toBe('0');
          |                                        ^
      418 |     });
      419 |   });
      420 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:417:40)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOSH ‚Ä∫ should calculate hyperbolic cosine of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.83373\d+\+0\.98889\d+i/
    Received string:  "Error: #NAME?"

      425 |     test('should calculate hyperbolic cosine of complex number', () => {
      426 |       const result = evaluate('=IMCOSH("1+i")');
    > 427 |       expect(String(result)).toMatch(/0\.83373\d+\+0\.98889\d+i/);
          |                              ^
      428 |     });
      429 |
      430 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:427:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOSH ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.83373\d+\+0\.98889\d+j/
    Received string:  "Error: #NAME?"

      430 |     test('should handle j suffix', () => {
      431 |       const result = evaluate('=IMCOSH("1+j")');
    > 432 |       expect(String(result)).toMatch(/0\.83373\d+\+0\.98889\d+j/);
          |                              ^
      433 |     });
      434 |
      435 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:432:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOSH ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "1"
    Received: [Error: #NAME?]

      434 |
      435 |     test('should handle zero', () => {
    > 436 |       expect(evaluate('=IMCOSH("0")')).toBe('1');
          |                                        ^
      437 |     });
      438 |   });
      439 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:436:40)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSECH ‚Ä∫ should calculate hyperbolic secant of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.49833\d+-0\.59108\d+[ij]/
    Received string:  "Error: #NAME?"

      444 |     test('should calculate hyperbolic secant of complex number', () => {
      445 |       const result = evaluate('=IMSECH("1+i")');
    > 446 |       expect(String(result)).toMatch(/0\.49833\d+-0\.59108\d+[ij]/);
          |                              ^
      447 |     });
      448 |
      449 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:446:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSECH ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.49833\d+-0\.59108\d+[ij]/
    Received string:  "Error: #NAME?"

      449 |     test('should handle j suffix', () => {
      450 |       const result = evaluate('=IMSECH("1+j")');
    > 451 |       expect(String(result)).toMatch(/0\.49833\d+-0\.59108\d+[ij]/);
          |                              ^
      452 |     });
      453 |   });
      454 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:451:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCSCH ‚Ä∫ should calculate hyperbolic cosecant of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.30393\d+-0\.62151\d+[ij]/
    Received string:  "Error: #NAME?"

      459 |     test('should calculate hyperbolic cosecant of complex number', () => {
      460 |       const result = evaluate('=IMCSCH("1+i")');
    > 461 |       expect(String(result)).toMatch(/0\.30393\d+-0\.62151\d+[ij]/);
          |                              ^
      462 |     });
      463 |
      464 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:461:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCSCH ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.30393\d+-0\.62151\d+[ij]/
    Received string:  "Error: #NAME?"

      464 |     test('should handle j suffix', () => {
      465 |       const result = evaluate('=IMCSCH("1+j")');
    > 466 |       expect(String(result)).toMatch(/0\.30393\d+-0\.62151\d+[ij]/);
          |                              ^
      467 |     });
      468 |   });
      469 | });

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:466:30)

FAIL packages/core/__tests__/functions/financial-week1-day5.test.ts (5.141 s)
  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ AMORLINC - Linear Depreciation (French Accounting) ‚Ä∫ Oracle Test 1: First period depreciation

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      33 |       
      34 |       const result = evaluate('=AMORLINC(2400, 39679, 39813, 300, 1, 0.15, 1)');
    > 35 |       expect(typeof result).toBe('number');
         |                             ^
      36 |       expect(result as number).toBeGreaterThan(0);
      37 |     });
      38 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:35:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ AMORLINC - Linear Depreciation (French Accounting) ‚Ä∫ Oracle Test 2: Period 0 (prorated)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      39 |     test('Oracle Test 2: Period 0 (prorated)', () => {
      40 |       const result = evaluate('=AMORLINC(2400, 39679, 39813, 300, 0, 0.15, 1)');
    > 41 |       expect(typeof result).toBe('number');
         |                             ^
      42 |       expect(result as number).toBeGreaterThan(0);
      43 |     });
      44 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:41:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ AMORLINC - Linear Depreciation (French Accounting) ‚Ä∫ Oracle Test 3: Higher rate (shorter life)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      46 |       // Rate 0.25 means 4-year life
      47 |       const result = evaluate('=AMORLINC(10000, 39679, 39813, 1000, 1, 0.25, 1)');
    > 48 |       expect(typeof result).toBe('number');
         |                             ^
      49 |       expect(result as number).toBeGreaterThan(0);
      50 |     });
      51 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:48:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ AMORLINC - Linear Depreciation (French Accounting) ‚Ä∫ Oracle Test 4: Lower rate (longer life)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      53 |       // Rate 0.10 means 10-year life
      54 |       const result = evaluate('=AMORLINC(10000, 39679, 39813, 1000, 1, 0.10, 1)');
    > 55 |       expect(typeof result).toBe('number');
         |                             ^
      56 |       expect(result as number).toBeGreaterThan(0);
      57 |     });
      58 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:55:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ AMORLINC - Linear Depreciation (French Accounting) ‚Ä∫ Oracle Test 5: Later period

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      59 |     test('Oracle Test 5: Later period', () => {
      60 |       const result = evaluate('=AMORLINC(2400, 39679, 39813, 300, 3, 0.15, 1)');
    > 61 |       expect(typeof result).toBe('number');
         |                             ^
      62 |       expect(result as number).toBeGreaterThanOrEqual(0);
      63 |     });
      64 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:61:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINT - Accrued Interest (Periodic) ‚Ä∫ Oracle Test 1: Basic accrued interest

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      81 |       
      82 |       const result = evaluate('=ACCRINT(39494, 39535, 39600, 0.1, 1000, 2, 0)');
    > 83 |       expect(typeof result).toBe('number');
         |                             ^
      84 |       expect(result as number).toBeGreaterThan(0);
      85 |       expect(result as number).toBeLessThan(100); // Should be less than one period's interest
      86 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:83:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINT - Accrued Interest (Periodic) ‚Ä∫ Oracle Test 2: Different frequency (quarterly)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      88 |     test('Oracle Test 2: Different frequency (quarterly)', () => {
      89 |       const result = evaluate('=ACCRINT(39494, 39535, 39600, 0.1, 1000, 4, 0)');
    > 90 |       expect(typeof result).toBe('number');
         |                             ^
      91 |       expect(result as number).toBeGreaterThan(0);
      92 |     });
      93 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:90:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINT - Accrued Interest (Periodic) ‚Ä∫ Oracle Test 3: Annual payments

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      94 |     test('Oracle Test 3: Annual payments', () => {
      95 |       const result = evaluate('=ACCRINT(39494, 39535, 39600, 0.1, 1000, 1, 0)');
    > 96 |       expect(typeof result).toBe('number');
         |                             ^
      97 |       expect(result as number).toBeGreaterThan(0);
      98 |     });
      99 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:96:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINT - Accrued Interest (Periodic) ‚Ä∫ Oracle Test 4: Higher rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      100 |     test('Oracle Test 4: Higher rate', () => {
      101 |       const result = evaluate('=ACCRINT(39494, 39535, 39600, 0.15, 1000, 2, 0)');
    > 102 |       expect(typeof result).toBe('number');
          |                             ^
      103 |       expect(result as number).toBeGreaterThan(0);
      104 |     });
      105 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:102:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINT - Accrued Interest (Periodic) ‚Ä∫ Oracle Test 5: Different par value

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      106 |     test('Oracle Test 5: Different par value', () => {
      107 |       const result = evaluate('=ACCRINT(39494, 39535, 39600, 0.1, 5000, 2, 0)');
    > 108 |       expect(typeof result).toBe('number');
          |                             ^
      109 |       expect(result as number).toBeGreaterThan(0);
      110 |     });
      111 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:108:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINTM - Accrued Interest at Maturity ‚Ä∫ Oracle Test 1: Basic accrued interest at maturity

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      127 |       
      128 |       const result = evaluate('=ACCRINTM(39539, 39615, 0.1, 1000, 0)');
    > 129 |       expect(typeof result).toBe('number');
          |                             ^
      130 |       expect(result as number).toBeGreaterThan(0);
      131 |       expect(result as number).toBeLessThan(100); // Less than one year's interest
      132 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:129:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINTM - Accrued Interest at Maturity ‚Ä∫ Oracle Test 2: Higher rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      134 |     test('Oracle Test 2: Higher rate', () => {
      135 |       const result = evaluate('=ACCRINTM(39539, 39615, 0.15, 1000, 0)');
    > 136 |       expect(typeof result).toBe('number');
          |                             ^
      137 |       expect(result as number).toBeGreaterThan(0);
      138 |     });
      139 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:136:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINTM - Accrued Interest at Maturity ‚Ä∫ Oracle Test 3: Longer period

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      141 |       // One year period
      142 |       const result = evaluate('=ACCRINTM(39539, 39904, 0.1, 1000, 0)');
    > 143 |       expect(typeof result).toBe('number');
          |                             ^
      144 |       expect(result as number).toBeCloseTo(101.39, 2); // Actual accrued interest
      145 |     });
      146 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:143:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINTM - Accrued Interest at Maturity ‚Ä∫ Oracle Test 4: Different par value

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      147 |     test('Oracle Test 4: Different par value', () => {
      148 |       const result = evaluate('=ACCRINTM(39539, 39615, 0.1, 5000, 0)');
    > 149 |       expect(typeof result).toBe('number');
          |                             ^
      150 |       expect(result as number).toBeGreaterThan(0);
      151 |     });
      152 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:149:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINTM - Accrued Interest at Maturity ‚Ä∫ Oracle Test 5: Different basis (actual/365)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      153 |     test('Oracle Test 5: Different basis (actual/365)', () => {
      154 |       const result = evaluate('=ACCRINTM(39539, 39615, 0.1, 1000, 3)');
    > 155 |       expect(typeof result).toBe('number');
          |                             ^
      156 |       expect(result as number).toBeGreaterThan(0);
      157 |     });
      158 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:155:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 1: Basic bond pricing

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      175 |       
      176 |       const result = evaluate('=PRICE(39508, 43054, 0.0575, 0.065, 100, 2, 0)');
    > 177 |       expect(typeof result).toBe('number');
          |                             ^
      178 |       expect(result as number).toBeGreaterThan(0);
      179 |       expect(result as number).toBeLessThan(150); // Reasonable price range
      180 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:177:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 2: Price at par (rate = yield)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      183 |       // When coupon rate equals yield, price should be close to redemption value
      184 |       const result = evaluate('=PRICE(39508, 43054, 0.065, 0.065, 100, 2, 0)');
    > 185 |       expect(typeof result).toBe('number');
          |                             ^
      186 |       expect(result as number).toBeCloseTo(100, 1);
      187 |     });
      188 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:185:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 3: Premium bond (rate > yield)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      190 |       // Higher coupon than yield = premium
      191 |       const result = evaluate('=PRICE(39508, 43054, 0.08, 0.065, 100, 2, 0)');
    > 192 |       expect(typeof result).toBe('number');
          |                             ^
      193 |       expect(result as number).toBeGreaterThan(100);
      194 |     });
      195 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:192:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 4: Discount bond (rate < yield)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      197 |       // Lower coupon than yield = discount
      198 |       const result = evaluate('=PRICE(39508, 43054, 0.05, 0.065, 100, 2, 0)');
    > 199 |       expect(typeof result).toBe('number');
          |                             ^
      200 |       expect(result as number).toBeLessThan(100);
      201 |     });
      202 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:199:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 5: Annual payments

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      203 |     test('Oracle Test 5: Annual payments', () => {
      204 |       const result = evaluate('=PRICE(39508, 43054, 0.0575, 0.065, 100, 1, 0)');
    > 205 |       expect(typeof result).toBe('number');
          |                             ^
      206 |       expect(result as number).toBeGreaterThan(0);
      207 |     });
      208 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:205:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 6: Quarterly payments

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      209 |     test('Oracle Test 6: Quarterly payments', () => {
      210 |       const result = evaluate('=PRICE(39508, 43054, 0.0575, 0.065, 100, 4, 0)');
    > 211 |       expect(typeof result).toBe('number');
          |                             ^
      212 |       expect(result as number).toBeGreaterThan(0);
      213 |     });
      214 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:211:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ Integration Tests ‚Ä∫ AMORLINC produces constant depreciation per period

    expect(received).toBeLessThan(expected)

    Expected: < 0.1
    Received:   NaN

      231 |       
      232 |       // Periods 1 and 2 should be similar (within 10%)
    > 233 |       expect(Math.abs(period1 - period2) / period1).toBeLessThan(0.1);
          |                                                     ^
      234 |     });
      235 |
      236 |     test('ACCRINT and ACCRINTM both calculate accrued interest', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:233:53)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ Integration Tests ‚Ä∫ ACCRINT and ACCRINTM both calculate accrued interest

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      239 |       const accrintm = evaluate('=ACCRINTM(39494, 39600, 0.1, 1000, 0)');
      240 |       
    > 241 |       expect(typeof accrint).toBe('number');
          |                              ^
      242 |       expect(typeof accrintm).toBe('number');
      243 |       expect(accrint as number).toBeGreaterThan(0);
      244 |       expect(accrintm as number).toBeGreaterThan(0);

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:241:30)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ Integration Tests ‚Ä∫ PRICE responds correctly to yield changes

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has type:  object
    Received has value: [Error: #NAME?]

      250 |       const priceYield7 = evaluate('=PRICE(39508, 43054, 0.0575, 0.07, 100, 2, 0)') as number;
      251 |       
    > 252 |       expect(priceYield5).toBeGreaterThan(priceYield7);
          |                           ^
      253 |     });
      254 |
      255 |     test('All functions handle valid inputs', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:252:27)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ Integration Tests ‚Ä∫ All functions handle valid inputs

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      259 |       const price = evaluate('=PRICE(39508, 43054, 0.06, 0.065, 100, 2, 0)');
      260 |       
    > 261 |       expect(typeof amorlinc).toBe('number');
          |                               ^
      262 |       expect(typeof accrint).toBe('number');
      263 |       expect(typeof accrintm).toBe('number');
      264 |       expect(typeof price).toBe('number');

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:261:31)

(node:75167) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/__tests__/functions/financial-irr.test.ts (5.259 s)
  ‚óè Financial Functions - Week 8 Day 5 (IRR/XIRR) ‚Ä∫ IRR (Internal Rate of Return) ‚Ä∫ IRR with equal cash flows (annuity)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      74 |       
      75 |       const result = evaluate('=IRR(D1:D6)');
    > 76 |       expect(typeof result).toBe('number');
         |                             ^
      77 |       expect(result as number).toBeGreaterThan(0);
      78 |     });
      79 |

      at Object.<anonymous> (__tests__/functions/financial-irr.test.ts:76:29)

  ‚óè Financial Functions - Week 8 Day 5 (IRR/XIRR) ‚Ä∫ IRR (Internal Rate of Return) ‚Ä∫ IRR returns #NUM! for all positive values

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

       95 |       const result = evaluate('=IRR({100, 200, 300})');
       96 |       expect(result).toBeInstanceOf(Error);
    >  97 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
       98 |     });
       99 |
      100 |     test('IRR returns #NUM! for all negative values', () => {

      at Object.<anonymous> (__tests__/functions/financial-irr.test.ts:97:41)

  ‚óè Financial Functions - Week 8 Day 5 (IRR/XIRR) ‚Ä∫ IRR (Internal Rate of Return) ‚Ä∫ IRR returns #NUM! for all negative values

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      101 |       const result = evaluate('=IRR({-100, -200, -300})');
      102 |       expect(result).toBeInstanceOf(Error);
    > 103 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      104 |     });
      105 |
      106 |     test('IRR returns #NUM! for insufficient values', () => {

      at Object.<anonymous> (__tests__/functions/financial-irr.test.ts:103:41)

FAIL packages/core/__tests__/conditional-formatting-batch-engine.test.ts
  ‚óè ConditionalFormattingBatchEngine - Step 2: Dirty Propagation Integration ‚Ä∫ 2Ô∏è‚É£ Replace Evaluate-on-render ‚Ä∫ should support legacy evaluateCellCF API but use dirty tracking internally

    expect(received).toBe(expected) // Object.is equality

    Expected: "#FFFF00"
    Received: undefined

      210 | 			// Use legacy API
      211 | 			const result1 = engine.evaluateCellCF({ row: 1, col: 1 }, { getValue });
    > 212 | 			expect(result1.style?.fillColor).toBe('#FFFF00');
          | 			                                 ^
      213 |
      214 | 			// Rule should now be clean
      215 | 			const state = engine.getRuleState('rule1');

      at Object.<anonymous> (__tests__/conditional-formatting-batch-engine.test.ts:212:37)

ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
FAIL packages/core/__tests__/excel-oracle/excel-oracle.test.ts
  ‚óè Console

    console.log
      
      3-arrows-percentile-standard:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:148:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:149:25)

    console.log
        Exact matches: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:150:25)

    console.log
      
      4-arrows-percentile-standard:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:148:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:149:25)

    console.log
        Exact matches: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:150:25)

    console.log
      
      5-arrows-percentile-standard:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:148:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:149:25)

    console.log
        Exact matches: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:150:25)

    console.log
      
      3-arrows-non-uniform:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:148:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:149:25)

    console.log
        Exact matches: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:150:25)

    console.log
      
      3-arrows-large-dataset:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:148:25)

    console.log
        Dataset size: 100

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:149:25)

    console.log
        Exact matches: 5/5 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:150:25)

    console.log
      
      === Phase B Oracle Validation Summary ===

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:172:21)

    console.log
      Test Cases: 5

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:173:21)

    console.log
      Total Values Tested: 140

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:174:21)

    console.log
      Icon Sets: 3-arrows, 4-arrows, 5-arrows

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:175:21)

    console.log
      Scenarios: Standard splits, non-uniform data, large datasets

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:176:21)

    console.log
      ==========================================

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:177:21)

    console.log
      
      2-color-red-green-min-max:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:440:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:441:25)

    console.log
        Exact matches: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:442:25)

    console.log
        Close matches (¬±5): 0/10 (0.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:443:25)

    console.log
        Total acceptable: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:444:25)

    console.log
      
      2-color-blue-yellow:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:440:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:441:25)

    console.log
        Exact matches: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:442:25)

    console.log
        Close matches (¬±5): 0/10 (0.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:443:25)

    console.log
        Total acceptable: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:444:25)

    console.log
      
      3-color-red-yellow-green:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:440:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:441:25)

    console.log
        Exact matches: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:442:25)

    console.log
        Close matches (¬±5): 0/10 (0.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:443:25)

    console.log
        Total acceptable: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:444:25)

    console.log
      
      3-color-blue-white-red:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:440:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:441:25)

    console.log
        Exact matches: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:442:25)

    console.log
        Close matches (¬±5): 0/10 (0.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:443:25)

    console.log
        Total acceptable: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:444:25)

    console.log
      
      2-color-large-dataset:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:440:25)

    console.log
        Dataset size: 100

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:441:25)

    console.log
        Exact matches: 6/6 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:442:25)

    console.log
        Close matches (¬±5): 0/6 (0.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:443:25)

    console.log
        Total acceptable: 6/6 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:444:25)

    console.log
      
      === Phase C Color Scale Validation Summary ===

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:465:21)

    console.log
      Test Cases: 5

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:466:21)

    console.log
      Total Values Tested: 46

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:469:21)

    console.log
      Color Scale Types: 2-color, 3-color

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:470:21)

    console.log
      Tolerance: ¬±5 RGB per channel

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:471:21)

    console.log
      Scenarios: min/max, percentile, fixed values, large datasets

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:472:21)

    console.log
      ===============================================

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:473:21)

    console.log
      
      solid-blue-automatic:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:558:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:559:25)

    console.log
        Exact matches (¬±0.1%): 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:560:25)

    console.log
        Close matches (¬±2%): 0/10 (0.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:561:25)

    console.log
        Total acceptable: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:562:25)

    console.log
      
      gradient-green-automatic:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:558:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:559:25)

    console.log
        Exact matches (¬±0.1%): 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:560:25)

    console.log
        Close matches (¬±2%): 0/10 (0.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:561:25)

    console.log
        Total acceptable: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:562:25)

    console.log
      
      solid-red-fixed-range:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:558:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:559:25)

    console.log
        Exact matches (¬±0.1%): 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:560:25)

    console.log
        Close matches (¬±2%): 0/10 (0.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:561:25)

    console.log
        Total acceptable: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:562:25)

    console.log
      
      gradient-orange-negative:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:558:25)

    console.log
        Dataset size: 10

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:559:25)

    console.log
        Exact matches (¬±0.1%): 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:560:25)

    console.log
        Close matches (¬±2%): 0/10 (0.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:561:25)

    console.log
        Total acceptable: 10/10 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:562:25)

    console.log
      
      solid-purple-large-dataset:

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:558:25)

    console.log
        Dataset size: 100

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:559:25)

    console.log
        Exact matches (¬±0.1%): 6/6 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:560:25)

    console.log
        Close matches (¬±2%): 0/6 (0.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:561:25)

    console.log
        Total acceptable: 6/6 (100.0%)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:562:25)

    console.log
      
      === Phase D Data Bar Validation Summary ===

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:582:21)

    console.log
      Test Cases: 5

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:583:21)

    console.log
      Total Values Tested: 46

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:586:21)

    console.log
      Data Bar Types: solid, gradient

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:587:21)

    console.log
      Tolerance: ¬±2% width

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:588:21)

    console.log
      Scenarios: automatic range, fixed range, negative values, large datasets

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:589:21)

    console.log
      ============================================

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:590:21)

    console.log
      
      === Wave 4 Validation Summary ===

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:635:21)

    console.log
      Phase A (Infrastructure): 2 tests

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:636:21)

    console.log
      Phase B (Icon Sets): 12 tests

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:637:21)

    console.log
        - Oracle test cases: 5

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:638:21)

    console.log
        - Values validated: 140

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:639:21)

    console.log
        - Match rate: ‚â•95%

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:640:21)

    console.log
      Phase C (Color Scales): 6 tests

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:641:21)

    console.log
        - Oracle test cases: 5

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:642:21)

    console.log
        - Values validated: 46

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:643:21)

    console.log
        - Match rate: ‚â•90% (¬±5 RGB tolerance)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:644:21)

    console.log
      Phase D (Data Bars): 6 tests

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:645:21)

    console.log
        - Oracle test cases: 5

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:646:21)

    console.log
        - Values validated: 46

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:647:21)

    console.log
        - Match rate: ‚â•85% (¬±2% width tolerance)

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:648:21)

    console.log
      Total Tests: 26

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:649:21)

    console.log
      Total Values Validated: 232

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:650:21)

    console.log
      =================================

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:651:21)

  ‚óè Excel Oracle Validation - Wave 4 ‚Ä∫ Phase A: Test Infrastructure ‚Ä∫ should be able to load Excel files from test-data directory

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      37 |             // Verify test data directory exists
      38 |             const dirExists = fs.existsSync(testDataDir);
    > 39 |             expect(dirExists).toBe(true);
         |                               ^
      40 |
      41 |             if (dirExists) {
      42 |                 const files = fs.readdirSync(testDataDir);

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:39:31)

FAIL packages/core/__tests__/functions/financial-week1-day2.test.ts (5.015 s)
  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 1: Classic example from Excel docs

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      130 |       
      131 |       const result = evaluate('=FVSCHEDULE(1, A1:A3)');
    > 132 |       expect(typeof result).toBe('number');
          |                             ^
      133 |       expect(result as number).toBeCloseTo(1.33089, 5);
      134 |     });
      135 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:132:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 2: FVSCHEDULE with actual investment

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      143 |       
      144 |       const result = evaluate('=FVSCHEDULE(10000, A1:A4)');
    > 145 |       expect(typeof result).toBe('number');
          |                             ^
      146 |       // Manual: 10000 * 1.05 * 1.07 * 1.03 * 1.09 = 12,613.53
      147 |       expect(result as number).toBeCloseTo(12613.53, 2);
      148 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:145:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 3: FVSCHEDULE with negative rates (loss)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      157 |       
      158 |       const result = evaluate('=FVSCHEDULE(5000, A1:A4)');
    > 159 |       expect(typeof result).toBe('number');
          |                             ^
      160 |       // Manual: 5000 * 1.10 * 0.95 * 0.92 * 1.15 = 5,528.05
      161 |       expect(result as number).toBeCloseTo(5528.05, 2);
      162 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:159:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 4: FVSCHEDULE with empty schedule

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      167 |       
      168 |       // Empty cell should return principal unchanged
    > 169 |       expect(typeof result).toBe('number');
          |                             ^
      170 |       expect(result as number).toBeCloseTo(1000, 2);
      171 |     });
      172 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:169:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 5: FVSCHEDULE with single rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      175 |       
      176 |       const result = evaluate('=FVSCHEDULE(8000, A1)');
    > 177 |       expect(typeof result).toBe('number');
          |                             ^
      178 |       expect(result as number).toBeCloseTo(8960, 2); // 8000 * 1.12
      179 |     });
      180 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:177:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 6: FVSCHEDULE precision with many periods

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      187 |       
      188 |       const result = evaluate('=FVSCHEDULE(1, A1:A10)');
    > 189 |       expect(typeof result).toBe('number');
          |                             ^
      190 |       // Calculate manually: 1 * product of (1 + rate)
      191 |       let expected = 1;
      192 |       rates.forEach(r => expected *= (1 + r));

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:189:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 1: Classic discount rate calculation

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      205 |       
      206 |       const result = evaluate(`=DISC(${settlement}, ${maturity}, 97.975, 100, 1)`);
    > 207 |       expect(typeof result).toBe('number');
          |                             ^
      208 |       // Expected based on implementation: (100-97.975)/100 * (365/141)
      209 |       expect(result as number).toBeCloseTo(0.0524, 3);
      210 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:207:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 2: DISC with 30/360 basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      215 |       
      216 |       const result = evaluate(`=DISC(${settlement}, ${maturity}, 95, 100, 0)`);
    > 217 |       expect(typeof result).toBe('number');
          |                             ^
      218 |       // (100-95)/100 * (360/365) = 0.0493
      219 |       expect(result as number).toBeCloseTo(0.0493, 3);
      220 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:217:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 3: DISC returns #NUM! when settlement >= maturity

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      223 |       const result = evaluate('=DISC(45657, 45292, 95, 100, 0)');
      224 |       expect(result).toBeInstanceOf(Error);
    > 225 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      226 |     });
      227 |
      228 |     test('Oracle Test 4: DISC returns #NUM! for negative price', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:225:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 4: DISC returns #NUM! for negative price

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      229 |       const result = evaluate('=DISC(45292, 45657, -95, 100, 0)');
      230 |       expect(result).toBeInstanceOf(Error);
    > 231 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      232 |     });
      233 |
      234 |     test('Oracle Test 5: DISC returns #NUM! for invalid basis', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:231:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 5: DISC returns #NUM! for invalid basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      235 |       const result = evaluate('=DISC(45292, 45657, 95, 100, 5)');
      236 |       expect(result).toBeInstanceOf(Error);
    > 237 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      238 |     });
      239 |
      240 |     test('Oracle Test 6: DISC with actual/360 basis', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:237:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 6: DISC with actual/360 basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      243 |       
      244 |       const result = evaluate(`=DISC(${settlement}, ${maturity}, 98, 100, 2)`);
    > 245 |       expect(typeof result).toBe('number');
          |                             ^
      246 |       // (100-98)/100 * (360/182) = 0.0396
      247 |       expect(result as number).toBeCloseTo(0.0396, 3);
      248 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:245:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 1: Classic INTRATE calculation

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      259 |       
      260 |       const result = evaluate(`=INTRATE(${settlement}, ${maturity}, 1000000, 1014420, 2)`);
    > 261 |       expect(typeof result).toBe('number');
          |                             ^
      262 |       // Expected based on implementation: (1014420-1000000)/1000000 * (360/89)
      263 |       expect(result as number).toBeCloseTo(0.0583, 3);
      264 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:261:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 2: INTRATE with 30/360 basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      269 |       
      270 |       const result = evaluate(`=INTRATE(${settlement}, ${maturity}, 10000, 10500, 0)`);
    > 271 |       expect(typeof result).toBe('number');
          |                             ^
      272 |       // (10500-10000)/10000 * (360/365) = 0.0493
      273 |       expect(result as number).toBeCloseTo(0.0493, 3);
      274 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:271:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 3: INTRATE returns #NUM! when settlement >= maturity

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      277 |       const result = evaluate('=INTRATE(45657, 45292, 10000, 10500, 0)');
      278 |       expect(result).toBeInstanceOf(Error);
    > 279 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      280 |     });
      281 |
      282 |     test('Oracle Test 4: INTRATE returns #NUM! for negative investment', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:279:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 4: INTRATE returns #NUM! for negative investment

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      283 |       const result = evaluate('=INTRATE(45292, 45657, -10000, 10500, 0)');
      284 |       expect(result).toBeInstanceOf(Error);
    > 285 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      286 |     });
      287 |
      288 |     test('Oracle Test 5: INTRATE returns #NUM! for invalid basis', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:285:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 5: INTRATE returns #NUM! for invalid basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      289 |       const result = evaluate('=INTRATE(45292, 45657, 10000, 10500, 6)');
      290 |       expect(result).toBeInstanceOf(Error);
    > 291 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      292 |     });
      293 |
      294 |     test('Oracle Test 6: INTRATE with actual/365 basis', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:291:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 6: INTRATE with actual/365 basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      297 |       
      298 |       const result = evaluate(`=INTRATE(${settlement}, ${maturity}, 5000, 5200, 3)`);
    > 299 |       expect(typeof result).toBe('number');
          |                             ^
      300 |       // (5200-5000)/5000 * (365/182) = 0.0802
      301 |       expect(result as number).toBeCloseTo(0.0802, 3);
      302 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:299:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 7: INTRATE vs DISC comparison

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      310 |       const disc = evaluate(`=DISC(${settlement}, ${maturity}, 98, 100, 2)`) as number;
      311 |       
    > 312 |       expect(typeof intrate).toBe('number');
          |                              ^
      313 |       expect(typeof disc).toBe('number');
      314 |       
      315 |       // INTRATE uses investment as denominator, DISC uses redemption

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:312:30)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ Integration Tests ‚Ä∫ FVSCHEDULE matches compound FV with single rate

    expect(received).toBeLessThan(expected)

    Expected: < 0.01
    Received:   NaN

      327 |       const fv = evaluate('=FV(0.08, 1, 0, -1000)') as number;
      328 |       
    > 329 |       expect(Math.abs(fvSchedule - fv)).toBeLessThan(0.01);
          |                                         ^
      330 |     });
      331 |
      332 |     test('MIRR with zero rates returns #NUM!', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:329:41)

FAIL packages/core/__tests__/functions/datetime-components.test.ts (5.164 s)
  ‚óè Date & Time Component Extraction ‚Ä∫ MONTH ‚Ä∫ extracts month from TODAY

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      148 |     test('extracts month from TODAY', () => {
      149 |       const result = evaluate('=MONTH(TODAY())');
    > 150 |       expect(result).toBe(1); // January
          |                      ^
      151 |     });
      152 |
      153 |     test('extracts month from NOW', () => {

      at Object.<anonymous> (__tests__/functions/datetime-components.test.ts:150:22)

  ‚óè Date & Time Component Extraction ‚Ä∫ MONTH ‚Ä∫ extracts month from NOW

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      153 |     test('extracts month from NOW', () => {
      154 |       const result = evaluate('=MONTH(NOW())');
    > 155 |       expect(result).toBe(1); // January
          |                      ^
      156 |     });
      157 |
      158 |     test('returns error for invalid date string', () => {

      at Object.<anonymous> (__tests__/functions/datetime-components.test.ts:155:22)

  ‚óè Date & Time Component Extraction ‚Ä∫ DAY ‚Ä∫ extracts day from TODAY

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 27
    Received:    17

      230 |       const result = evaluate('=DAY(TODAY())');
      231 |       // Should be around 28-29 for January 29, 2026
    > 232 |       expect(result).toBeGreaterThanOrEqual(27);
          |                      ^
      233 |       expect(result).toBeLessThanOrEqual(30);
      234 |     });
      235 |

      at Object.<anonymous> (__tests__/functions/datetime-components.test.ts:232:22)

  ‚óè Date & Time Component Extraction ‚Ä∫ DAY ‚Ä∫ extracts day from NOW

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 27
    Received:    17

      236 |     test('extracts day from NOW', () => {
      237 |       const result = evaluate('=DAY(NOW())');
    > 238 |       expect(result).toBeGreaterThanOrEqual(27);
          |                      ^
      239 |       expect(result).toBeLessThanOrEqual(30);
      240 |     });
      241 |

      at Object.<anonymous> (__tests__/functions/datetime-components.test.ts:238:22)

  ‚óè Date & Time Component Extraction ‚Ä∫ Integration Tests ‚Ä∫ extract all components from NOW

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      451 |       
      452 |       expect(year).toBe(2026);
    > 453 |       expect(month).toBe(1);
          |                     ^
      454 |       expect(day).toBeGreaterThanOrEqual(27);
      455 |       expect(day).toBeLessThanOrEqual(30);
      456 |       expect(hour).toBeGreaterThanOrEqual(0);

      at Object.<anonymous> (__tests__/functions/datetime-components.test.ts:453:21)

FAIL packages/core/__tests__/textsplit-textjoin.test.ts (5.658 s)
  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits by single character delimiter

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
        "Cherry",
    -   ],
      ]

      32 |         );
      33 |         
    > 34 |         expect(result).toEqual([['Apple', 'Banana', 'Cherry']]);
         |                        ^
      35 |       });
      36 |
      37 |       test('splits by multi-character delimiter', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:34:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits by multi-character delimiter

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
        "Cherry",
    -   ],
      ]

      41 |         );
      42 |         
    > 43 |         expect(result).toEqual([['Apple', 'Banana', 'Cherry']]);
         |                        ^
      44 |       });
      45 |
      46 |       test('splits with spaces in values', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:43:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits with spaces in values

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "First Name",
        "Last Name",
        "Email Address",
    -   ],
      ]

      50 |         );
      51 |         
    > 52 |         expect(result).toEqual([['First Name', 'Last Name', 'Email Address']]);
         |                        ^
      53 |       });
      54 |
      55 |       test('splits single value (no delimiter found)', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:52:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits single value (no delimiter found)

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "NoDelimiter",
    -   ],
      ]

      59 |         );
      60 |         
    > 61 |         expect(result).toEqual([['NoDelimiter']]);
         |                        ^
      62 |       });
      63 |
      64 |       test('splits with delimiter at start', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:61:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits with delimiter at start

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "",
        "Apple",
        "Banana",
    -   ],
      ]

      68 |         );
      69 |         
    > 70 |         expect(result).toEqual([['', 'Apple', 'Banana']]);
         |                        ^
      71 |       });
      72 |
      73 |       test('splits with delimiter at end', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:70:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits with delimiter at end

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
        "",
    -   ],
      ]

      77 |         );
      78 |         
    > 79 |         expect(result).toEqual([['Apple', 'Banana', '']]);
         |                        ^
      80 |       });
      81 |
      82 |       test('handles consecutive delimiters', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:79:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ handles consecutive delimiters

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "",
        "Cherry",
    -   ],
      ]

      86 |         );
      87 |         
    > 88 |         expect(result).toEqual([['Apple', '', 'Cherry']]);
         |                        ^
      89 |       });
      90 |     });
      91 |

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:88:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Column Splitting with ignoreEmpty ‚Ä∫ ignores empty values when TRUE

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Cherry",
    -   ],
      ]

       97 |         );
       98 |         
    >  99 |         expect(result).toEqual([['Apple', 'Cherry']]);
          |                        ^
      100 |       });
      101 |
      102 |       test('keeps empty values when FALSE', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:99:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Column Splitting with ignoreEmpty ‚Ä∫ keeps empty values when FALSE

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "",
        "Cherry",
    -   ],
      ]

      106 |         );
      107 |         
    > 108 |         expect(result).toEqual([['Apple', '', 'Cherry']]);
          |                        ^
      109 |       });
      110 |
      111 |       test('ignores empty at edges', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:108:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Column Splitting with ignoreEmpty ‚Ä∫ ignores empty at edges

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
    -   ],
      ]

      115 |         );
      116 |         
    > 117 |         expect(result).toEqual([['Apple', 'Banana']]);
          |                        ^
      118 |       });
      119 |
      120 |       test('ignores multiple consecutive empty', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:117:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Column Splitting with ignoreEmpty ‚Ä∫ ignores multiple consecutive empty

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Cherry",
    -   ],
      ]

      124 |         );
      125 |         
    > 126 |         expect(result).toEqual([['Apple', 'Cherry']]);
          |                        ^
      127 |       });
      128 |     });
      129 |

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:126:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Case-Insensitive Matching ‚Ä∫ case-sensitive split (default)

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "banana",
        "cherry",
    -   ],
      ]

      200 |         );
      201 |         
    > 202 |         expect(result).toEqual([['Apple', 'banana', 'cherry']]);
          |                        ^
      203 |       });
      204 |
      205 |       test('case-insensitive split', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:202:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Case-Insensitive Matching ‚Ä∫ case-insensitive split

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "banana",
        "cherry",
    -   ],
      ]

      209 |         );
      210 |         
    > 211 |         expect(result).toEqual([['Apple', 'banana', 'cherry']]);
          |                        ^
      212 |       });
      213 |
      214 |       test('case-insensitive with mixed case delimiter', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:211:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Case-Insensitive Matching ‚Ä∫ case-insensitive with mixed case delimiter

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "banana",
        "cherry",
    -   ],
      ]

      218 |         );
      219 |         
    > 220 |         expect(result).toEqual([['Apple', 'banana', 'cherry']]);
          |                        ^
      221 |       });
      222 |     });
      223 |

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:220:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Edge Cases and Errors ‚Ä∫ handles empty string input

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "",
    -   ],
      ]

      239 |         );
      240 |         
    > 241 |         expect(result).toEqual([['']]);
          |                        ^
      242 |       });
      243 |
      244 |       test('handles empty string with ignoreEmpty', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:241:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Edge Cases and Errors ‚Ä∫ handles empty string with ignoreEmpty

    expect(received).toEqual(expected) // deep equality

    - Expected  - 3
    + Received  + 1

    - Array [
    -   Array [],
    - ]
    + Array []

      248 |         );
      249 |         
    > 250 |         expect(result).toEqual([[]]);
          |                        ^
      251 |       });
      252 |
      253 |       test('handles numeric values converted to string', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:250:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Edge Cases and Errors ‚Ä∫ handles numeric values converted to string

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "100",
        "200",
        "300",
    -   ],
      ]

      257 |         );
      258 |         
    > 259 |         expect(result).toEqual([['100', '200', '300']]);
          |                        ^
      260 |       });
      261 |
      262 |       test('splits with tab delimiter', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:259:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Edge Cases and Errors ‚Ä∫ splits with tab delimiter

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
        "Cherry",
    -   ],
      ]

      267 |         );
      268 |         
    > 269 |         expect(result).toEqual([['Apple', 'Banana', 'Cherry']]);
          |                        ^
      270 |       });
      271 |     });
      272 |

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:269:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Real-World Examples ‚Ä∫ splits full name into parts

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "John",
        "Michael",
        "Smith",
    -   ],
      ]

      278 |         );
      279 |         
    > 280 |         expect(result).toEqual([['John', 'Michael', 'Smith']]);
          |                        ^
      281 |       });
      282 |
      283 |       test('splits email address', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:280:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Real-World Examples ‚Ä∫ splits email address

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "user",
        "example.com",
    -   ],
      ]

      287 |         );
      288 |         
    > 289 |         expect(result).toEqual([['user', 'example.com']]);
          |                        ^
      290 |       });
      291 |
      292 |       test('splits file path', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:289:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Real-World Examples ‚Ä∫ splits file path

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "",
        "home",
        "user",
        "documents",
        "file.txt",
    -   ],
      ]

      296 |         );
      297 |         
    > 298 |         expect(result).toEqual([['', 'home', 'user', 'documents', 'file.txt']]);
          |                        ^
      299 |       });
      300 |
      301 |       test('splits file path ignoring empty', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:298:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Real-World Examples ‚Ä∫ splits file path ignoring empty

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "home",
        "user",
        "documents",
        "file.txt",
    -   ],
      ]

      305 |         );
      306 |         
    > 307 |         expect(result).toEqual([['home', 'user', 'documents', 'file.txt']]);
          |                        ^
      308 |       });
      309 |
      310 |       test('parses CSV line', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:307:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Real-World Examples ‚Ä∫ parses CSV line

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Product",
        "Price",
        "Quantity",
        "SKU",
    -   ],
      ]

      314 |         );
      315 |         
    > 316 |         expect(result).toEqual([['Product', 'Price', 'Quantity', 'SKU']]);
          |                        ^
      317 |       });
      318 |     });
      319 |   });

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:316:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT and TEXTJOIN Integration ‚Ä∫ split and rejoin with different delimiter

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
        "Cherry",
    -   ],
      ]

      565 |       ) as FormulaValue[][];
      566 |       
    > 567 |       expect(split).toEqual([['Apple', 'Banana', 'Cherry']]);
          |                     ^
      568 |       
      569 |       worksheet.setCellValue({ row: 2, col: 1 }, split[0][0] as string);
      570 |       worksheet.setCellValue({ row: 2, col: 2 }, split[0][1] as string);

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:567:21)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT and TEXTJOIN Integration ‚Ä∫ round-trip: join then split

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "First",
        "Second",
        "Third",
    -   ],
      ]

      607 |       );
      608 |       
    > 609 |       expect(split).toEqual([['First', 'Second', 'Third']]);
          |                     ^
      610 |     });
      611 |   });
      612 | });

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:609:21)

FAIL packages/core/__tests__/functions/financial-basic.test.ts (5.681 s)
  ‚óè Financial Functions - Week 8 Day 4 ‚Ä∫ Integration Tests ‚Ä∫ Financial functions with range references

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      367 |       
      368 |       const npv = evaluate('=NPV(0.10, A1:A5)');
    > 369 |       expect(typeof npv).toBe('number');
          |                          ^
      370 |     });
      371 |   });
      372 |

      at Object.<anonymous> (__tests__/functions/financial-basic.test.ts:369:26)

ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
FAIL packages/core/__tests__/functions/math-week2-day6.test.ts
  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ AGGREGATE ‚Ä∫ function 1: AVERAGE (option 0)

    expect(received).toBe(expected) // Object.is equality

    Expected: 5.5
    Received: [Error: #DIV/0!]

      141 |     test('function 1: AVERAGE (option 0)', () => {
      142 |       const result = engine.evaluate('=AGGREGATE(1, 0, A1:A10)', context);
    > 143 |       expect(result).toBe(5.5); // (1+2+...+10)/10
          |                      ^
      144 |     });
      145 |
      146 |     test('function 9: SUM (option 0)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:143:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ AGGREGATE ‚Ä∫ function 9: SUM (option 0)

    expect(received).toBe(expected) // Object.is equality

    Expected: 55
    Received: 0

      146 |     test('function 9: SUM (option 0)', () => {
      147 |       const result = engine.evaluate('=AGGREGATE(9, 0, A1:A10)', context);
    > 148 |       expect(result).toBe(55); // 1+2+...+10
          |                      ^
      149 |     });
      150 |
      151 |     test('function 4: MAX (option 0)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:148:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ AGGREGATE ‚Ä∫ function 4: MAX (option 0)

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 0

      151 |     test('function 4: MAX (option 0)', () => {
      152 |       const result = engine.evaluate('=AGGREGATE(4, 0, A1:A10)', context);
    > 153 |       expect(result).toBe(10);
          |                      ^
      154 |     });
      155 |
      156 |     test('function 5: MIN (option 0)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:153:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ AGGREGATE ‚Ä∫ function 5: MIN (option 0)

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

      156 |     test('function 5: MIN (option 0)', () => {
      157 |       const result = engine.evaluate('=AGGREGATE(5, 0, A1:A10)', context);
    > 158 |       expect(result).toBe(1);
          |                      ^
      159 |     });
      160 |
      161 |     test('function 2: COUNT (option 2, ignore errors)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:158:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ AGGREGATE ‚Ä∫ function 12: MEDIAN

    expect(received).toBe(expected) // Object.is equality

    Expected: 5.5
    Received: [Error: #NUM!]

      171 |     test('function 12: MEDIAN', () => {
      172 |       const result = engine.evaluate('=AGGREGATE(12, 0, A1:A10)', context);
    > 173 |       expect(result).toBe(5.5); // Median of 1-10
          |                      ^
      174 |     });
      175 |
      176 |     test('function 7: STDEV.S (sample standard deviation)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:173:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 9: SUM

    expect(received).toBe(expected) // Object.is equality

    Expected: 55
    Received: 0

      205 |     test('function 9: SUM', () => {
      206 |       const result = engine.evaluate('=SUBTOTAL(9, A1:A10)', context);
    > 207 |       expect(result).toBe(55); // 1+2+...+10
          |                      ^
      208 |     });
      209 |
      210 |     test('function 1: AVERAGE', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:207:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 1: AVERAGE

    expect(received).toBe(expected) // Object.is equality

    Expected: 5.5
    Received: [Error: #DIV/0!]

      210 |     test('function 1: AVERAGE', () => {
      211 |       const result = engine.evaluate('=SUBTOTAL(1, A1:A10)', context);
    > 212 |       expect(result).toBe(5.5);
          |                      ^
      213 |     });
      214 |
      215 |     test('function 4: MAX', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:212:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 4: MAX

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 0

      215 |     test('function 4: MAX', () => {
      216 |       const result = engine.evaluate('=SUBTOTAL(4, A1:A10)', context);
    > 217 |       expect(result).toBe(10);
          |                      ^
      218 |     });
      219 |
      220 |     test('function 5: MIN', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:217:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 5: MIN

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

      220 |     test('function 5: MIN', () => {
      221 |       const result = engine.evaluate('=SUBTOTAL(5, A1:A10)', context);
    > 222 |       expect(result).toBe(1);
          |                      ^
      223 |     });
      224 |
      225 |     test('function 109: SUM (ignore hidden and filtered)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:222:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 109: SUM (ignore hidden and filtered)

    expect(received).toBe(expected) // Object.is equality

    Expected: 55
    Received: 0

      226 |       // 100-series codes behave same as 1-11 in our simplified implementation
      227 |       const result = engine.evaluate('=SUBTOTAL(109, A1:A10)', context);
    > 228 |       expect(result).toBe(55);
          |                      ^
      229 |     });
      230 |
      231 |     test('function 2: COUNT', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:228:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 2: COUNT

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 0

      231 |     test('function 2: COUNT', () => {
      232 |       const result = engine.evaluate('=SUBTOTAL(2, A1:A10)', context);
    > 233 |       expect(result).toBe(10);
          |                      ^
      234 |     });
      235 |   });
      236 |

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:233:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ Integration Tests ‚Ä∫ AGGREGATE vs SUBTOTAL for basic SUM

    expect(received).toBe(expected) // Object.is equality

    Expected: 150
    Received: 0

      256 |       const subtotal = engine.evaluate('=SUBTOTAL(9, A1:A5)', context);
      257 |       
    > 258 |       expect(aggregate).toBe(150); // 10+20+30+40+50
          |                         ^
      259 |       expect(subtotal).toBe(150);  // Same result
      260 |     });
      261 |

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:258:25)

FAIL packages/core/__tests__/functions/financial-week1-day4.test.ts (5.611 s)
  ‚óè Financial Functions - Week 1 Day 4 (SLN, SYD, VDB, AMORDEGRC) ‚Ä∫ AMORDEGRC - French Accounting Depreciation ‚Ä∫ Oracle Test 1: First period depreciation

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      182 |       
      183 |       const result = evaluate('=AMORDEGRC(2400, 39679, 39813, 300, 1, 0.15, 1)');
    > 184 |       expect(typeof result).toBe('number');
          |                             ^
      185 |       expect(result as number).toBeGreaterThan(0);
      186 |     });
      187 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day4.test.ts:184:29)

  ‚óè Financial Functions - Week 1 Day 4 (SLN, SYD, VDB, AMORDEGRC) ‚Ä∫ AMORDEGRC - French Accounting Depreciation ‚Ä∫ Oracle Test 2: Period 0 (prorated)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      188 |     test('Oracle Test 2: Period 0 (prorated)', () => {
      189 |       const result = evaluate('=AMORDEGRC(2400, 39679, 39813, 300, 0, 0.15, 1)');
    > 190 |       expect(typeof result).toBe('number');
          |                             ^
      191 |       expect(result as number).toBeGreaterThan(0);
      192 |     });
      193 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day4.test.ts:190:29)

  ‚óè Financial Functions - Week 1 Day 4 (SLN, SYD, VDB, AMORDEGRC) ‚Ä∫ AMORDEGRC - French Accounting Depreciation ‚Ä∫ Oracle Test 3: High depreciation rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      195 |       // Rate 0.25 (4-year life)
      196 |       const result = evaluate('=AMORDEGRC(10000, 39679, 39813, 1000, 1, 0.25, 1)');
    > 197 |       expect(typeof result).toBe('number');
          |                             ^
      198 |       expect(result as number).toBeGreaterThan(0);
      199 |     });
      200 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day4.test.ts:197:29)

  ‚óè Financial Functions - Week 1 Day 4 (SLN, SYD, VDB, AMORDEGRC) ‚Ä∫ AMORDEGRC - French Accounting Depreciation ‚Ä∫ Oracle Test 4: Low depreciation rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      202 |       // Rate 0.10 (10-year life)
      203 |       const result = evaluate('=AMORDEGRC(10000, 39679, 39813, 1000, 1, 0.10, 1)');
    > 204 |       expect(typeof result).toBe('number');
          |                             ^
      205 |       expect(result as number).toBeGreaterThan(0);
      206 |     });
      207 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day4.test.ts:204:29)

  ‚óè Financial Functions - Week 1 Day 4 (SLN, SYD, VDB, AMORDEGRC) ‚Ä∫ AMORDEGRC - French Accounting Depreciation ‚Ä∫ Oracle Test 7: Later period

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      218 |     test('Oracle Test 7: Later period', () => {
      219 |       const result = evaluate('=AMORDEGRC(2400, 39679, 39813, 300, 3, 0.15, 1)');
    > 220 |       expect(typeof result).toBe('number');
          |                             ^
      221 |       expect(result as number).toBeGreaterThanOrEqual(0);
      222 |     });
      223 |   });

      at Object.<anonymous> (__tests__/functions/financial-week1-day4.test.ts:220:29)

FAIL packages/core/__tests__/functions/advanced-math-functions.test.ts
  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ MROUND function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: 9
    Received: [Error: #NUM!]

      73 |       setCellValue('A1', 10);
      74 |       setCellValue('B1', 3);
    > 75 |       expect(evaluate('=MROUND(A1, B1)')).toBe(9);
         |                                           ^
      76 |     });
      77 |   });
      78 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:75:43)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ QUOTIENT function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: 4
    Received: [Error: #DIV/0!]

      113 |       setCellValue('A1', 17);
      114 |       setCellValue('B1', 4);
    > 115 |       expect(evaluate('=QUOTIENT(A1, B1)')).toBe(4);
          |                                             ^
      116 |     });
      117 |   });
      118 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:115:45)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ PRODUCT function ‚Ä∫ should ignore text and logical values

    expect(received).toBe(expected) // Object.is equality

    Expected: 6
    Received: 0

      146 |       setCellValue('A2', 'text');
      147 |       setCellValue('A3', 3);
    > 148 |       expect(evaluate('=PRODUCT(A1:A3)')).toBe(6);
          |                                           ^
      149 |     });
      150 |
      151 |     test('should return 0 for empty input', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:148:43)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ PRODUCT function ‚Ä∫ should return 0 for empty input

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: undefined

      150 |
      151 |     test('should return 0 for empty input', () => {
    > 152 |       expect(evaluate('=PRODUCT()')).toBe(0);
          |                                      ^
      153 |     });
      154 |
      155 |     test('should handle cell references', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:152:38)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ PRODUCT function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: 24
    Received: 0

      157 |       setCellValue('A2', 3);
      158 |       setCellValue('A3', 4);
    > 159 |       expect(evaluate('=PRODUCT(A1:A3)')).toBe(24);
          |                                           ^
      160 |     });
      161 |   });
      162 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:159:43)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SQRTPI function ‚Ä∫ should handle cell references

    expect(received).toBeCloseTo(expected, precision)

    Expected: 3.0699801238394655
    Received: 0

    Expected precision:    5
    Expected difference: < 0.000005
    Received difference:   3.0699801238394655

      191 |       setCellValue('A1', 3);
      192 |       const result = evaluate('=SQRTPI(A1)');
    > 193 |       expect(result).toBeCloseTo(Math.sqrt(3 * Math.PI), 5);
          |                      ^
      194 |     });
      195 |   });
      196 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:193:22)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ MULTINOMIAL function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: [Error: #VALUE!]

      235 |       setCellValue('A1', 2);
      236 |       setCellValue('A2', 3);
    > 237 |       expect(evaluate('=MULTINOMIAL(A1, A2)')).toBe(10);
          |                                                ^
      238 |     });
      239 |   });
      240 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:237:48)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMX2MY2 function ‚Ä∫ should calculate sum of x¬≤ - y¬≤

    expect(received).toBe(expected) // Object.is equality

    Expected: -88
    Received: 146

      254 |       setCellValue('B2', 5);
      255 |       setCellValue('B3', 11);
    > 256 |       expect(evaluate('=SUMX2MY2(A1:A3, B1:B3)')).toBe(-88);
          |                                                   ^
      257 |     });
      258 |
      259 |     test('should handle positive results', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:256:51)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMX2MY2 function ‚Ä∫ should handle positive results

    expect(received).toBe(expected) // Object.is equality

    Expected: 28
    Received: 4

      263 |       setCellValue('B2', 2);
      264 |       // (25-9) + (16-4) = 16 + 12 = 28
    > 265 |       expect(evaluate('=SUMX2MY2(A1:A2, B1:B2)')).toBe(28);
          |                                                   ^
      266 |     });
      267 |
      268 |     test('should return error for mismatched array sizes', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:265:51)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMX2PY2 function ‚Ä∫ should calculate sum of x¬≤ + y¬≤

    expect(received).toBe(expected) // Object.is equality

    Expected: 276
    Received: 146

      296 |       setCellValue('B2', 5);
      297 |       setCellValue('B3', 11);
    > 298 |       expect(evaluate('=SUMX2PY2(A1:A3, B1:B3)')).toBe(276);
          |                                                   ^
      299 |     });
      300 |
      301 |     test('should handle zeros', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:298:51)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMX2PY2 function ‚Ä∫ should handle zeros

    expect(received).toBe(expected) // Object.is equality

    Expected: 25
    Received: 0

      305 |       setCellValue('B2', 0);
      306 |       // (0+16) + (9+0) = 16 + 9 = 25
    > 307 |       expect(evaluate('=SUMX2PY2(A1:A2, B1:B2)')).toBe(25);
          |                                                   ^
      308 |     });
      309 |
      310 |     test('should return error for mismatched array sizes', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:307:51)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMXMY2 function ‚Ä∫ should calculate sum of (x - y)¬≤

    expect(received).toBe(expected) // Object.is equality

    Expected: 24
    Received: 146

      337 |       setCellValue('B2', 5);
      338 |       setCellValue('B3', 11);
    > 339 |       expect(evaluate('=SUMXMY2(A1:A3, B1:B3)')).toBe(24);
          |                                                  ^
      340 |     });
      341 |
      342 |     test('should handle equal values (zero difference)', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:339:50)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMXMY2 function ‚Ä∫ should handle equal values (zero difference)

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: 9

      345 |       setCellValue('B1', 5);
      346 |       setCellValue('B2', 3);
    > 347 |       expect(evaluate('=SUMXMY2(A1:A2, B1:B2)')).toBe(0);
          |                                                  ^
      348 |     });
      349 |
      350 |     test('should return error for mismatched array sizes', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:347:50)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMXMY2 function ‚Ä∫ should handle negative differences

    expect(received).toBe(expected) // Object.is equality

    Expected: 16
    Received: 0

      366 |       setCellValue('B1', 7);
      367 |       // (3-7)¬≤ = 16
    > 368 |       expect(evaluate('=SUMXMY2(A1, B1)')).toBe(16);
          |                                            ^
      369 |     });
      370 |   });
      371 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:368:44)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ Integration tests ‚Ä∫ should use MROUND with AVERAGE

    expect(received).toBe(expected) // Object.is equality

    Expected: 20
    Received: [Error: #DIV/0!]

      380 |       setCellValue('A3', 20);
      381 |       // AVERAGE = 15, MROUND(15, 10) = 20
    > 382 |       expect(evaluate('=MROUND(AVERAGE(A1:A3), 10)')).toBe(20);
          |                                                       ^
      383 |     });
      384 |
      385 |     test('should use QUOTIENT with PRODUCT', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:382:55)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ Integration tests ‚Ä∫ should combine SUM functions

    expect(received).toBe(expected) // Object.is equality

    Expected: 30
    Received: 4

      404 |       // (9+1) + (16+4) = 30
      405 |       // (9-1) + (16-4) = 20
    > 406 |       expect(sumPlus).toBe(30);
          |                       ^
      407 |       expect(sumMinus).toBe(20);
      408 |     });
      409 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:406:23)

FAIL packages/core/__tests__/functions/statistical-week2-day2.test.ts
  ‚óè Statistical Functions - Week 2 Day 2 (F-Distribution) ‚Ä∫ F.TEST - F-Test for Equal Variances ‚Ä∫ Oracle Test 2: Similar variances

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      253 |       // F.TEST with arrays of similar variance
      254 |       const result = evaluate('=F.TEST(A1:A9, C1:C9)');
    > 255 |       expect(typeof result).toBe('number');
          |                             ^
      256 |       expect(result as number).toBeGreaterThan(0);
      257 |       expect(result as number).toBeLessThan(1);
      258 |       // With similar variance, p-value should be relatively high

      at Object.<anonymous> (__tests__/functions/statistical-week2-day2.test.ts:255:29)

  ‚óè Statistical Functions - Week 2 Day 2 (F-Distribution) ‚Ä∫ F.TEST - F-Test for Equal Variances ‚Ä∫ Oracle Test 7: Large variance ratio

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      301 |       
      302 |       const result = evaluate('=F.TEST(A1:A9, E1:E9)');
    > 303 |       expect(typeof result).toBe('number');
          |                             ^
      304 |       expect(result as number).toBeGreaterThan(0);
      305 |       expect(result as number).toBeLessThan(0.1); // Very low p-value
      306 |     });

      at Object.<anonymous> (__tests__/functions/statistical-week2-day2.test.ts:303:29)

ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
FAIL packages/core/__tests__/unique.test.ts
  ‚óè FormulaEngine - UNIQUE Function ‚Ä∫ Error Handling ‚Ä∫ returns #CALC! when array is empty

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error
    Received constructor: Array

      258 |     test('returns #CALC! when array is empty', () => {
      259 |       const result = testUNIQUE([]);
    > 260 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      261 |       expect((result as Error).message).toBe('#CALC!');
      262 |     });
      263 |

      at Object.<anonymous> (__tests__/unique.test.ts:260:22)

FAIL packages/core/__tests__/functions/statistical-basic.test.ts
  ‚óè Statistical Functions - Week 8 Day 1 ‚Ä∫ AVERAGEA ‚Ä∫ returns #DIV/0! for no values

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: undefined

      93 |     test('returns #DIV/0! for no values', () => {
      94 |       const result = evaluate('=AVERAGEA()');
    > 95 |       expect(result).toBeInstanceOf(Error);
         |                      ^
      96 |       expect((result as Error).message).toBe('#DIV/0!');
      97 |     });
      98 |   });

      at Object.<anonymous> (__tests__/functions/statistical-basic.test.ts:95:22)

  ‚óè Statistical Functions - Week 8 Day 1 ‚Ä∫ MEDIAN ‚Ä∫ returns #NUM! for no values

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: undefined

      136 |     test('returns #NUM! for no values', () => {
      137 |       const result = evaluate('=MEDIAN()');
    > 138 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      139 |       expect((result as Error).message).toBe('#NUM!');
      140 |     });
      141 |   });

      at Object.<anonymous> (__tests__/functions/statistical-basic.test.ts:138:22)

  ‚óè Statistical Functions - Week 8 Day 1 ‚Ä∫ Integration with Dynamic Arrays ‚Ä∫ AVERAGE with FILTER

    expect(received).toBe(expected) // Object.is equality

    Expected: 30
    Received: [Error: #VALUE!]

      358 |       
      359 |       const result = evaluate('=AVERAGE(FILTER(A1:A4, A1:A4>15))');
    > 360 |       expect(result).toBe(30); // Average of 20, 30, 40
          |                      ^
      361 |     });
      362 |
      363 |     test('MEDIAN with SEQUENCE', () => {

      at Object.<anonymous> (__tests__/functions/statistical-basic.test.ts:360:22)

  ‚óè Statistical Functions - Week 8 Day 1 ‚Ä∫ Integration with Dynamic Arrays ‚Ä∫ VAR.P with FILTER and condition

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #VALUE!]

      388 |       
      389 |       const result = evaluate('=VAR.P(FILTER(A1:A4, A1:A4>=10))');
    > 390 |       expect(result).toBeCloseTo(16.666666, 5); // Variance of 10,15,20
          |                      ^
      391 |     });
      392 |   });
      393 |

      at Object.<anonymous> (__tests__/functions/statistical-basic.test.ts:390:22)

  ‚óè Statistical Functions - Week 8 Day 1 ‚Ä∫ Edge Cases and Robustness ‚Ä∫ all functions handle empty arrays gracefully

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: undefined

      415 |       const varResult = evaluate('=VAR.S()');
      416 |       
    > 417 |       expect(avgResult).toBeInstanceOf(Error);
          |                         ^
      418 |       expect(medianResult).toBeInstanceOf(Error);
      419 |       expect(varResult).toBeInstanceOf(Error);
      420 |     });

      at Object.<anonymous> (__tests__/functions/statistical-basic.test.ts:417:25)

FAIL packages/core/__tests__/error-engine-behavior.test.ts
  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ SKIP_ERRORS: SUM - Filter Errors, Aggregate Non-Errors ‚Ä∫ filters multiple errors, returns sum of remaining values

    expect(received).toBe(expected) // Object.is equality

    Expected: 15
    Received: 0

      281 |       const result = engine.evaluate('=SUM(1/0, B2, 1/"text", C2)', context);
      282 |       
    > 283 |       expect(result).toBe(15);
          |                      ^
      284 |       expect(result).not.toBeInstanceOf(Error);
      285 |     });
      286 |

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:283:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ SKIP_ERRORS: SUM - Filter Errors, Aggregate Non-Errors ‚Ä∫ handles mixed numeric, null, and error values

    expect(received).toBe(expected) // Object.is equality

    Expected: 15
    Received: 0

      310 |       const result = engine.evaluate('=SUM(B2, C2, 1/0, D2)', context);
      311 |       
    > 312 |       expect(result).toBe(15);
          |                      ^
      313 |     });
      314 |
      315 |     test('returns 0 when all arguments filtered (errors only)', () => {

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:312:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ SKIP_ERRORS: Edge Cases and Boundary Conditions ‚Ä∫ does not mutate original arguments

    expect(received).toBe(expected) // Object.is equality

    Expected: 15
    Received: 10

      444 |       const result = engine.evaluate('=SUM(B2, 1/0, 10)', context);
      445 |       
    > 446 |       expect(result).toBe(15); // Should work identically on second call
          |                      ^
      447 |     });
      448 |
      449 |     test('handles nested errors correctly', () => {

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:446:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ FINANCIAL_STRICT: PV - Present Value Function ‚Ä∫ rejects NaN argument

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: 1000

      505 |       const result = engine.evaluate('=PV(B2, 10, -100)', context);
      506 |       
    > 507 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      508 |       expect((result as Error).message).toContain('#VALUE!');
      509 |     });
      510 |

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:507:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ FINANCIAL_STRICT: PV - Present Value Function ‚Ä∫ rejects Infinity argument

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: 1000

      514 |       const result = engine.evaluate('=PV(B2, 10, -100)', context);
      515 |       
    > 516 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      517 |       expect((result as Error).message).toContain('#DIV/0!');
      518 |     });
      519 |

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:516:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ FINANCIAL_STRICT: NPV - Net Present Value ‚Ä∫ rejects NaN in cash flows

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: 316.3035311795642

      564 |       const result = engine.evaluate('=NPV(0.1, 100, B2, 300)', context);
      565 |       
    > 566 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      567 |       expect((result as Error).message).toContain('#VALUE!');
      568 |     });
      569 |

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:566:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ FINANCIAL_STRICT: NPV - Net Present Value ‚Ä∫ rejects Infinity in rate

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: 300

      573 |       const result = engine.evaluate('=NPV(B2, 100, 200)', context);
      574 |       
    > 575 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      576 |       expect((result as Error).message).toContain('#DIV/0!');
      577 |     });
      578 |   });

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:575:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ Phase 5: LOOKUP_STRICT - VLOOKUP #N/A Pass-Through (CRITICAL) ‚Ä∫ INDEX passes through #N/A when handler returns it

    expect(received).toBe(expected) // Object.is equality

    Expected: "data"
    Received: null

      689 |         expect(result).toBeInstanceOf(Error);
      690 |       } else {
    > 691 |         expect(result).toBe('data');
          |                        ^
      692 |       }
      693 |     });
      694 |   });

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:691:24)

ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
FAIL packages/core/__tests__/functions/datetime-arithmetic.test.ts
  ‚óè Date Arithmetic Functions ‚Ä∫ EDATE ‚Ä∫ adds months to a date

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 15
    Received:    16

      33 |       expect(month).toBe(2);
      34 |       expect(day).toBeGreaterThanOrEqual(13);
    > 35 |       expect(day).toBeLessThanOrEqual(15);
         |                   ^
      36 |     });
      37 |
      38 |     test('subtracts months from a date', () => {

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:35:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EDATE ‚Ä∫ subtracts months from a date

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 15
    Received:    16

      43 |       expect(month).toBe(2);
      44 |       expect(day).toBeGreaterThanOrEqual(13);
    > 45 |       expect(day).toBeLessThanOrEqual(15);
         |                   ^
      46 |     });
      47 |
      48 |     test('handles day 31 to month with 28 days (Feb non-leap)', () => {

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:45:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ returns last day of current month

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 30
    Received:    1

      133 |       
      134 |       // January has 31 days
    > 135 |       expect(day).toBeGreaterThanOrEqual(30);
          |                   ^
      136 |       expect(day).toBeLessThanOrEqual(31);
      137 |     });
      138 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:135:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ returns last day of next month

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 3

      143 |       
      144 |       // February 2026 (non-leap) has 28 days
    > 145 |       expect(month).toBe(2);
          |                     ^
      146 |       expect(day).toBeGreaterThanOrEqual(27);
      147 |       expect(day).toBeLessThanOrEqual(29);
      148 |     });

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:145:21)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ returns last day of previous month

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      154 |       
      155 |       // January has 31 days
    > 156 |       expect(month).toBe(1);
          |                     ^
      157 |       expect(day).toBeGreaterThanOrEqual(30);
      158 |       expect(day).toBeLessThanOrEqual(31);
      159 |     });

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:156:21)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ handles leap year February

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 28
    Received:    1

      164 |       
      165 |       // February 2024 (leap year) has 29 days
    > 166 |       expect(day).toBeGreaterThanOrEqual(28);
          |                   ^
      167 |       expect(day).toBeLessThanOrEqual(29);
      168 |     });
      169 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:166:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ handles non-leap year February

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 27
    Received:    1

      173 |       
      174 |       // February 2026 (non-leap) has 28 days
    > 175 |       expect(day).toBeGreaterThanOrEqual(27);
          |                   ^
      176 |       expect(day).toBeLessThanOrEqual(29);
      177 |     });
      178 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:175:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ handles months with 30 days

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 29
    Received:    1

      182 |       
      183 |       // April has 30 days
    > 184 |       expect(day).toBeGreaterThanOrEqual(29);
          |                   ^
      185 |       expect(day).toBeLessThanOrEqual(30);
      186 |     });
      187 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:184:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ handles year rollover (forward)

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      192 |       
      193 |       expect(year).toBe(2026);
    > 194 |       expect(month).toBe(1);
          |                     ^
      195 |     });
      196 |
      197 |     test('handles year rollover (backward)', () => {

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:194:21)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ works with TODAY

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 3
    Received:    4

      211 |       // Should be February or March depending on current date
      212 |       expect(month).toBeGreaterThanOrEqual(2);
    > 213 |       expect(month).toBeLessThanOrEqual(3);
          |                     ^
      214 |     });
      215 |
      216 |     test('returns error for non-numeric date', () => {

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:213:21)

  ‚óè Date Arithmetic Functions ‚Ä∫ Integration Tests ‚Ä∫ next month end from today

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 3
    Received:    4

      368 |       // February or March
      369 |       expect(month).toBeGreaterThanOrEqual(2);
    > 370 |       expect(month).toBeLessThanOrEqual(3);
          |                     ^
      371 |     });
      372 |
      373 |     test('project duration in workdays', () => {

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:370:21)

  ‚óè Date Arithmetic Functions ‚Ä∫ Integration Tests ‚Ä∫ days until year end

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 330
    Received:    317

      380 |       const result = evaluate('=DAYS(DATE(2026, 12, 31), TODAY())');
      381 |       // From Jan 29 to Dec 31 is about 336 days
    > 382 |       expect(result).toBeGreaterThanOrEqual(330);
          |                      ^
      383 |       expect(result).toBeLessThanOrEqual(340);
      384 |     });
      385 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:382:22)

  ‚óè Date Arithmetic Functions ‚Ä∫ Integration Tests ‚Ä∫ add 3 months then get month end

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 28
    Received:    1

      393 |       expect(month).toBeGreaterThanOrEqual(4);
      394 |       expect(month).toBeLessThanOrEqual(5);
    > 395 |       expect(day).toBeGreaterThanOrEqual(28);
          |                   ^
      396 |       expect(day).toBeLessThanOrEqual(31);
      397 |     });
      398 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:395:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ Integration Tests ‚Ä∫ quarter end dates

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 3
    Received:    4

      418 |       // Q1: Jan + 2 months = March (allow tolerance for off-by-one)
      419 |       expect(q1Month).toBeGreaterThanOrEqual(2);
    > 420 |       expect(q1Month).toBeLessThanOrEqual(3);
          |                       ^
      421 |       // Q2: Apr + 2 months = June (allow tolerance)
      422 |       expect(q2Month).toBeGreaterThanOrEqual(5);
      423 |       expect(q2Month).toBeLessThanOrEqual(6);

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:420:23)

FAIL packages/core/__tests__/functions/statistical-advanced.test.ts
  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ calculates 50th percentile (median)

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: [Error: #NUM!]

      51 |       const range = setupData([1, 2, 3, 4, 5]);
      52 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.5)`);
    > 53 |       expect(result).toBe(3);
         |                      ^
      54 |     });
      55 |
      56 |     test('calculates 25th percentile', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:53:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ calculates 25th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: [Error: #NUM!]

      57 |       const range = setupData([1, 2, 3, 4, 5]);
      58 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.25)`);
    > 59 |       expect(result).toBe(2);
         |                      ^
      60 |     });
      61 |
      62 |     test('calculates 75th percentile', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:59:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ calculates 75th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 4
    Received: [Error: #NUM!]

      63 |       const range = setupData([1, 2, 3, 4, 5]);
      64 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.75)`);
    > 65 |       expect(result).toBe(4);
         |                      ^
      66 |     });
      67 |
      68 |     test('handles interpolation for non-exact percentiles', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:65:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ handles interpolation for non-exact percentiles

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NUM!]

      69 |       const range = setupData([10, 20, 30, 40]);
      70 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.3)`);
    > 71 |       expect(result).toBeCloseTo(19, 5);
         |                      ^
      72 |     });
      73 |
      74 |     test('accepts k=0 (minimum value)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:71:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ accepts k=0 (minimum value)

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NUM!]

      75 |       const range = setupData([5, 10, 15, 20]);
      76 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0)`);
    > 77 |       expect(result).toBe(5);
         |                      ^
      78 |     });
      79 |
      80 |     test('accepts k=1 (maximum value)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:77:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ accepts k=1 (maximum value)

    expect(received).toBe(expected) // Object.is equality

    Expected: 20
    Received: [Error: #NUM!]

      81 |       const range = setupData([5, 10, 15, 20]);
      82 |       const result = evaluate(`=PERCENTILE.INC(${range}, 1)`);
    > 83 |       expect(result).toBe(20);
         |                      ^
      84 |     });
      85 |
      86 |     test('works with unsorted data', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:83:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ works with unsorted data

    expect(received).toBe(expected) // Object.is equality

    Expected: 30
    Received: [Error: #NUM!]

      87 |       const range = setupData([50, 10, 30, 20, 40]);
      88 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.5)`);
    > 89 |       expect(result).toBe(30);
         |                      ^
      90 |     });
      91 |
      92 |     test('handles duplicates', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:89:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ handles duplicates

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: [Error: #NUM!]

      93 |       const range = setupData([1, 2, 2, 3, 4]);
      94 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.5)`);
    > 95 |       expect(result).toBe(2);
         |                      ^
      96 |     });
      97 |
      98 |     test('returns #NUM! for k < 0', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:95:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ matches Excel reference values

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NUM!]

      117 |       const range = setupData([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);
      118 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.3)`);
    > 119 |       expect(result).toBeCloseTo(3.7, 5);
          |                      ^
      120 |     });
      121 |   });
      122 |

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:119:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.EXC (Exclusive Method) ‚Ä∫ calculates 50th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: [Error: #NUM!]

      125 |       const range = setupData([1, 2, 3, 4, 5]);
      126 |       const result = evaluate(`=PERCENTILE.EXC(${range}, 0.5)`);
    > 127 |       expect(result).toBe(3);
          |                      ^
      128 |     });
      129 |
      130 |     test('calculates 25th percentile', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:127:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.EXC (Exclusive Method) ‚Ä∫ calculates 25th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: [Error: #NUM!]

      131 |       const range = setupData([1, 2, 3, 4, 5, 6, 7]);
      132 |       const result = evaluate(`=PERCENTILE.EXC(${range}, 0.25)`);
    > 133 |       expect(result).toBe(2);
          |                      ^
      134 |     });
      135 |
      136 |     test('returns #NUM! for k=0 (exclusive boundaries)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:133:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE (Alias for PERCENTILE.INC) ‚Ä∫ behaves identically to PERCENTILE.INC

    expect(received).toBe(expected) // Object.is equality

    If it should pass with deep equality, replace "toBe" with "toStrictEqual"

    Expected: [Error: #NUM!]
    Received: serializes to the same string

      171 |       const percentile = evaluate(`=PERCENTILE(${range}, 0.75)`);
      172 |       const percentile_inc = evaluate(`=PERCENTILE.INC(${range}, 0.75)`);
    > 173 |       expect(percentile).toBe(percentile_inc);
          |                          ^
      174 |     });
      175 |   });
      176 |

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:173:26)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ Q0 returns minimum

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #NUM!]

      182 |       const range = setupData([1, 2, 3, 4, 5]);
      183 |       const result = evaluate(`=QUARTILE.INC(${range}, 0)`)
    > 184 |       expect(result).toBe(1);
          |                      ^
      185 |     });
      186 |
      187 |     test('Q1 returns 25th percentile', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:184:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ Q1 returns 25th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: [Error: #NUM!]

      188 |       const range = setupData([1, 2, 3, 4, 5]);
      189 |       const result = evaluate(`=QUARTILE.INC(${range}, 1)`)
    > 190 |       expect(result).toBe(2);
          |                      ^
      191 |     });
      192 |
      193 |     test('Q2 returns median (50th percentile)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:190:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ Q2 returns median (50th percentile)

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: [Error: #NUM!]

      194 |       const range = setupData([1, 2, 3, 4, 5]);
      195 |       const result = evaluate(`=QUARTILE.INC(${range}, 2)`)
    > 196 |       expect(result).toBe(3);
          |                      ^
      197 |     });
      198 |
      199 |     test('Q3 returns 75th percentile', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:196:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ Q3 returns 75th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 4
    Received: [Error: #NUM!]

      200 |       const range = setupData([1, 2, 3, 4, 5]);
      201 |       const result = evaluate(`=QUARTILE.INC(${range}, 3)`)
    > 202 |       expect(result).toBe(4);
          |                      ^
      203 |     });
      204 |
      205 |     test('Q4 returns maximum', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:202:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ Q4 returns maximum

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NUM!]

      206 |       const range = setupData([1, 2, 3, 4, 5]);
      207 |       const result = evaluate(`=QUARTILE.INC(${range}, 4)`)
    > 208 |       expect(result).toBe(5);
          |                      ^
      209 |     });
      210 |
      211 |     test('returns #NUM! for quart < 0', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:208:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ matches Excel reference values

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NUM!]

      231 |       const range = setupData([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);
      232 |       const result = evaluate(`=QUARTILE.INC(${range}, 1)`)
    > 233 |       expect(result).toBeCloseTo(3.25, 5);
          |                      ^
      234 |     });
      235 |   });
      236 |

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:233:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.EXC ‚Ä∫ Q1 returns 25th percentile (exclusive)

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: [Error: #NUM!]

      239 |       const range = setupData([1, 2, 3, 4, 5, 6, 7]);
      240 |       const result = evaluate(`=QUARTILE.EXC(${range}, 1)`)
    > 241 |       expect(result).toBe(2);
          |                      ^
      242 |     });
      243 |
      244 |     test('Q2 returns median', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:241:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.EXC ‚Ä∫ Q2 returns median

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: [Error: #NUM!]

      245 |       const range = setupData([1, 2, 3, 4, 5]);
      246 |       const result = evaluate(`=QUARTILE.EXC(${range}, 2)`)
    > 247 |       expect(result).toBe(3);
          |                      ^
      248 |     });
      249 |
      250 |     test('Q3 returns 75th percentile (exclusive)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:247:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.EXC ‚Ä∫ Q3 returns 75th percentile (exclusive)

    expect(received).toBe(expected) // Object.is equality

    Expected: 6
    Received: [Error: #NUM!]

      251 |       const range = setupData([1, 2, 3, 4, 5, 6, 7]);
      252 |       const result = evaluate(`=QUARTILE.EXC(${range}, 3)`)
    > 253 |       expect(result).toBe(6);
          |                      ^
      254 |     });
      255 |
      256 |     test('returns #NUM! for quart=0 (exclusive)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:253:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ Edge Cases ‚Ä∫ handles single-element arrays

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NUM!]

      683 |     test('handles single-element arrays', () => {
      684 |       const range = setupData([5]);
    > 685 |       expect(evaluate(`=PERCENTILE.INC(${range}, 0.5)`)).toBe(5);
          |                                                          ^
      686 |       expect(evaluate(`=QUARTILE.INC(${range}, 2)`)).toBe(5);
      687 |       // TODO: LARGE and SMALL have broadcasting issue, skipping
      688 |       // expect(evaluate(`=LARGE(${range}, 1)`)).toBe(5);

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:685:58)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ Edge Cases ‚Ä∫ handles negative numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: -1
    Received: [Error: #NUM!]

      692 |     test('handles negative numbers', () => {
      693 |       const range1 = setupData([-5, -3, -1, 0, 1]);
    > 694 |       expect(evaluate(`=PERCENTILE.INC(${range1}, 0.5)`)).toBe(-1);
          |                                                           ^
      695 |       
      696 |       // TODO: RANK.EQ has broadcasting issue, skipping
      697 |       // const range2 = setupData([-5, -3, -1, 0, 1]);

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:694:59)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ Edge Cases ‚Ä∫ handles very large numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 2000000
    Received: [Error: #NUM!]

      702 |       const range = setupData([1000000, 2000000, 3000000]);
      703 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.5)`)
    > 704 |       expect(result).toBe(2000000);
          |                      ^
      705 |     });
      706 |
      707 |     test('handles decimal values', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:704:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ Edge Cases ‚Ä∫ handles decimal values

    expect(received).toBe(expected) // Object.is equality

    Expected: 3.3
    Received: [Error: #NUM!]

      708 |       const range = setupData([1.1, 2.2, 3.3, 4.4, 5.5]);
      709 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.5)`)
    > 710 |       expect(result).toBe(3.3);
          |                      ^
      711 |     });
      712 |   });
      713 | });

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:710:22)

ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
PASS packages/core/__tests__/debug-average.test.ts
  ‚óè Console

    console.log
      A1: 10

      at Object.<anonymous> (__tests__/debug-average.test.ts:20:13)

    console.log
      A2: 20

      at Object.<anonymous> (__tests__/debug-average.test.ts:21:13)

    console.log
      A3: 30

      at Object.<anonymous> (__tests__/debug-average.test.ts:22:13)

    console.log
      A4: 40

      at Object.<anonymous> (__tests__/debug-average.test.ts:23:13)

    console.log
      Result: 25

      at Object.<anonymous> (__tests__/debug-average.test.ts:26:13)

    console.log
      Result type: number

      at Object.<anonymous> (__tests__/debug-average.test.ts:27:13)

    console.log
      Is Array?: false

      at Object.<anonymous> (__tests__/debug-average.test.ts:28:13)

ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
FAIL packages/core/__tests__/functions/statistical-correlation.test.ts
  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ CORREL (Correlation Coefficient) ‚Ä∫ perfect positive correlation (y=2x)

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      41 |       setupData([1, 2, 3, 4, 5], [2, 4, 6, 8, 10]);
      42 |       const result = evaluate('=CORREL(A1:A5, B1:B5)');
    > 43 |       expect(result).toBeCloseTo(1.0, 10);
         |                      ^
      44 |     });
      45 |
      46 |     test('perfect negative correlation (y=-x+6)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:43:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ CORREL (Correlation Coefficient) ‚Ä∫ perfect negative correlation (y=-x+6)

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      47 |       setupData([1, 2, 3, 4, 5], [5, 4, 3, 2, 1]);
      48 |       const result = evaluate('=CORREL(A1:A5, B1:B5)');
    > 49 |       expect(result).toBeCloseTo(-1.0, 10);
         |                      ^
      50 |     });
      51 |
      52 |     test('partial correlation', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:49:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ CORREL (Correlation Coefficient) ‚Ä∫ partial correlation

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has type:  object
    Received has value: [Error: #N/A]

      53 |       setupData([1, 2, 3, 4, 5], [2, 3, 5, 6, 9]);
      54 |       const result = evaluate('=CORREL(A1:A5, B1:B5)');
    > 55 |       expect(result).toBeGreaterThan(0.9);
         |                      ^
      56 |       expect(result).toBeLessThan(1.0);
      57 |     });
      58 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:55:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ CORREL (Correlation Coefficient) ‚Ä∫ zero variance returns error

    expect(received).toBe(expected) // Object.is equality

    Expected: "#DIV/0!"
    Received: "#N/A"

      68 |       const result = evaluate('=CORREL(A1:A3, B1:B3)');
      69 |       expect(result).toBeInstanceOf(Error);
    > 70 |       expect((result as Error).message).toBe('#DIV/0!');
         |                                         ^
      71 |     });
      72 |   });
      73 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:70:41)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ PEARSON (Alias for CORREL) ‚Ä∫ returns same result as CORREL

    expect(received).toBe(expected) // Object.is equality

    If it should pass with deep equality, replace "toBe" with "toStrictEqual"

    Expected: [Error: #N/A]
    Received: serializes to the same string

      77 |       const correl = evaluate('=CORREL(A1:A5, B1:B5)');
      78 |       const pearson = evaluate('=PEARSON(A1:A5, B1:B5)');
    > 79 |       expect(pearson).toBe(correl);
         |                       ^
      80 |     });
      81 |   });
      82 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:79:23)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ COVARIANCE.P (Population Covariance) ‚Ä∫ calculates positive covariance

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      85 |       setupData([1, 2, 3], [4, 5, 6]);
      86 |       const result = evaluate('=COVARIANCE.P(A1:A3, B1:B3)');
    > 87 |       expect(result).toBeCloseTo(0.6666666, 5);
         |                      ^
      88 |     });
      89 |
      90 |     test('calculates negative covariance', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:87:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ COVARIANCE.P (Population Covariance) ‚Ä∫ calculates negative covariance

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      91 |       setupData([1, 2, 3], [6, 5, 4]);
      92 |       const result = evaluate('=COVARIANCE.P(A1:A3, B1:B3)');
    > 93 |       expect(result).toBeCloseTo(-0.6666666, 5);
         |                      ^
      94 |     });
      95 |
      96 |     test('zero covariance for constant Y', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:93:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ COVARIANCE.P (Population Covariance) ‚Ä∫ zero covariance for constant Y

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #N/A]

       97 |       setupData([1, 2, 3], [2, 2, 2]);
       98 |       const result = evaluate('=COVARIANCE.P(A1:A3, B1:B3)');
    >  99 |       expect(result).toBe(0);
          |                      ^
      100 |     });
      101 |   });
      102 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:99:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ COVARIANCE.S (Sample Covariance) ‚Ä∫ calculates sample covariance

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #N/A]

      105 |       setupData([1, 2, 3], [4, 5, 6]);
      106 |       const result = evaluate('=COVARIANCE.S(A1:A3, B1:B3)');
    > 107 |       expect(result).toBe(1);
          |                      ^
      108 |     });
      109 |
      110 |     test('different from population covariance', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:107:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ COVARIANCE.S (Sample Covariance) ‚Ä∫ different from population covariance

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has type:  object
    Received has value: [Error: #N/A]

      112 |       const covP = evaluate('=COVARIANCE.P(A1:A3, B1:B3)');
      113 |       const covS = evaluate('=COVARIANCE.S(A1:A3, B1:B3)');
    > 114 |       expect(covS).toBeGreaterThan(covP as number);
          |                    ^
      115 |     });
      116 |   });
      117 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:114:20)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ RSQ (R-Squared) ‚Ä∫ perfect fit returns 1

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      120 |       setupData([1, 2, 3, 4, 5], [2, 4, 6, 8, 10]);
      121 |       const result = evaluate('=RSQ(B1:B5, A1:A5)');
    > 122 |       expect(result).toBeCloseTo(1.0, 10);
          |                      ^
      123 |     });
      124 |
      125 |     test('perfect inverse returns 1', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:122:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ RSQ (R-Squared) ‚Ä∫ perfect inverse returns 1

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      126 |       setupData([1, 2, 3, 4, 5], [5, 4, 3, 2, 1]);
      127 |       const result = evaluate('=RSQ(B1:B5, A1:A5)');
    > 128 |       expect(result).toBeCloseTo(1.0, 10);
          |                      ^
      129 |     });
      130 |
      131 |     test('equals square of correlation', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:128:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ RSQ (R-Squared) ‚Ä∫ equals square of correlation

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      133 |       const correl = evaluate('=CORREL(B1:B4, A1:A4)') as number;
      134 |       const rsq = evaluate('=RSQ(B1:B4, A1:A4)');
    > 135 |       expect(rsq).toBeCloseTo(correl * correl, 10);
          |                   ^
      136 |     });
      137 |   });
      138 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:135:19)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ SLOPE (Linear Regression Slope) ‚Ä∫ calculates slope of y=2x

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      141 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      142 |       const result = evaluate('=SLOPE(B1:B4, A1:A4)');
    > 143 |       expect(result).toBeCloseTo(2.0, 10);
          |                      ^
      144 |     });
      145 |
      146 |     test('calculates slope of y=0.5x', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:143:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ SLOPE (Linear Regression Slope) ‚Ä∫ calculates slope of y=0.5x

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      147 |       setupData([1, 2, 3, 4], [0.5, 1, 1.5, 2]);
      148 |       const result = evaluate('=SLOPE(B1:B4, A1:A4)');
    > 149 |       expect(result).toBeCloseTo(0.5, 10);
          |                      ^
      150 |     });
      151 |
      152 |     test('negative slope', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:149:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ SLOPE (Linear Regression Slope) ‚Ä∫ negative slope

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      153 |       setupData([1, 2, 3, 4], [4, 3, 2, 1]);
      154 |       const result = evaluate('=SLOPE(B1:B4, A1:A4)');
    > 155 |       expect(result).toBeCloseTo(-1.0, 10);
          |                      ^
      156 |     });
      157 |
      158 |     test('horizontal line has zero slope', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:155:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ SLOPE (Linear Regression Slope) ‚Ä∫ horizontal line has zero slope

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #N/A]

      159 |       setupData([1, 2, 3, 4], [5, 5, 5, 5]);
      160 |       const result = evaluate('=SLOPE(B1:B4, A1:A4)');
    > 161 |       expect(result).toBe(0);
          |                      ^
      162 |     });
      163 |
      164 |     test('vertical line returns error', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:161:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ SLOPE (Linear Regression Slope) ‚Ä∫ vertical line returns error

    expect(received).toBe(expected) // Object.is equality

    Expected: "#DIV/0!"
    Received: "#N/A"

      166 |       const result = evaluate('=SLOPE(B1:B4, A1:A4)');
      167 |       expect(result).toBeInstanceOf(Error);
    > 168 |       expect((result as Error).message).toBe('#DIV/0!');
          |                                         ^
      169 |     });
      170 |   });
      171 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:168:41)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ INTERCEPT (Y-Intercept) ‚Ä∫ y=2x intercept is 0

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      174 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      175 |       const result = evaluate('=INTERCEPT(B1:B4, A1:A4)');
    > 176 |       expect(result).toBeCloseTo(0, 10);
          |                      ^
      177 |     });
      178 |
      179 |     test('y=2x+3 intercept is 3', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:176:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ INTERCEPT (Y-Intercept) ‚Ä∫ y=2x+3 intercept is 3

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      180 |       setupData([1, 2, 3, 4], [5, 7, 9, 11]);
      181 |       const result = evaluate('=INTERCEPT(B1:B4, A1:A4)');
    > 182 |       expect(result).toBeCloseTo(3, 10);
          |                      ^
      183 |     });
      184 |
      185 |     test('negative intercept', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:182:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ INTERCEPT (Y-Intercept) ‚Ä∫ negative intercept

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      186 |       setupData([1, 2, 3, 4], [-1, 1, 3, 5]);
      187 |       const result = evaluate('=INTERCEPT(B1:B4, A1:A4)');
    > 188 |       expect(result).toBeCloseTo(-3, 10);
          |                      ^
      189 |     });
      190 |
      191 |     test('horizontal line', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:188:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ INTERCEPT (Y-Intercept) ‚Ä∫ horizontal line

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #N/A]

      192 |       setupData([1, 2, 3, 4], [5, 5, 5, 5]);
      193 |       const result = evaluate('=INTERCEPT(B1:B4, A1:A4)');
    > 194 |       expect(result).toBe(5);
          |                      ^
      195 |     });
      196 |   });
      197 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:194:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST.LINEAR (Linear Prediction) ‚Ä∫ predicts on y=2x line

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      200 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      201 |       const result = evaluate('=FORECAST.LINEAR(5, B1:B4, A1:A4)');
    > 202 |       expect(result).toBeCloseTo(10, 10);
          |                      ^
      203 |     });
      204 |
      205 |     test('predicts on y=2x+3 line', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:202:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST.LINEAR (Linear Prediction) ‚Ä∫ predicts on y=2x+3 line

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      206 |       setupData([1, 2, 3, 4], [5, 7, 9, 11]);
      207 |       const result = evaluate('=FORECAST.LINEAR(5, B1:B4, A1:A4)');
    > 208 |       expect(result).toBeCloseTo(13, 10);
          |                      ^
      209 |     });
      210 |
      211 |     test('interpolation within range', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:208:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST.LINEAR (Linear Prediction) ‚Ä∫ interpolation within range

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      212 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      213 |       const result = evaluate('=FORECAST.LINEAR(2.5, B1:B4, A1:A4)');
    > 214 |       expect(result).toBeCloseTo(5, 10);
          |                      ^
      215 |     });
      216 |
      217 |     test('extrapolation beyond range', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:214:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST.LINEAR (Linear Prediction) ‚Ä∫ extrapolation beyond range

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      218 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      219 |       const result = evaluate('=FORECAST.LINEAR(10, B1:B4, A1:A4)');
    > 220 |       expect(result).toBeCloseTo(20, 10);
          |                      ^
      221 |     });
      222 |
      223 |     test('negative x value', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:220:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST.LINEAR (Linear Prediction) ‚Ä∫ negative x value

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      224 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      225 |       const result = evaluate('=FORECAST.LINEAR(-1, B1:B4, A1:A4)');
    > 226 |       expect(result).toBeCloseTo(-2, 10);
          |                      ^
      227 |     });
      228 |   });
      229 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:226:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST (Alias) ‚Ä∫ returns same result as FORECAST.LINEAR

    expect(received).toBe(expected) // Object.is equality

    If it should pass with deep equality, replace "toBe" with "toStrictEqual"

    Expected: [Error: #N/A]
    Received: serializes to the same string

      233 |       const linear = evaluate('=FORECAST.LINEAR(5, B1:B4, A1:A4)');
      234 |       const forecast = evaluate('=FORECAST(5, B1:B4, A1:A4)');
    > 235 |       expect(forecast).toBe(linear);
          |                        ^
      236 |     });
      237 |   });
      238 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:235:24)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ STEYX (Standard Error) ‚Ä∫ perfect fit has zero error

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      241 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      242 |       const result = evaluate('=STEYX(B1:B4, A1:A4)');
    > 243 |       expect(result).toBeCloseTo(0, 10);
          |                      ^
      244 |     });
      245 |
      246 |     test('calculates error for imperfect fit', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:243:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ STEYX (Standard Error) ‚Ä∫ calculates error for imperfect fit

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has type:  object
    Received has value: [Error: #N/A]

      247 |       setupData([1, 2, 3, 4], [2, 3, 5, 6]);
      248 |       const result = evaluate('=STEYX(B1:B4, A1:A4)');
    > 249 |       expect(result).toBeGreaterThan(0);
          |                      ^
      250 |       expect(result).toBeLessThan(1);
      251 |     });
      252 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:249:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ STEYX (Standard Error) ‚Ä∫ requires at least 3 points

    expect(received).toBe(expected) // Object.is equality

    Expected: "#DIV/0!"
    Received: "#N/A"

      255 |       const result = evaluate('=STEYX(B1:B2, A1:A2)');
      256 |       expect(result).toBeInstanceOf(Error);
    > 257 |       expect((result as Error).message).toBe('#DIV/0!');
          |                                         ^
      258 |     });
      259 |   });
      260 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:257:41)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ TREND (Linear Trend) ‚Ä∫ returns fitted values for known X

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      263 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      264 |       const result = evaluate('=TREND(B1:B4, A1:A4)');
    > 265 |       expect(Array.isArray(result)).toBe(true);
          |                                     ^
      266 |       if (Array.isArray(result)) {
      267 |         expect(result.length).toBe(4);
      268 |         expect(result[0]).toBeCloseTo(2, 10);

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:265:37)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ TREND (Linear Trend) ‚Ä∫ predicts for new X values

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      277 |       worksheet.setCellValue({ row: 2, col: 3 }, 6);
      278 |       const result = evaluate('=TREND(B1:B4, A1:A4, C1:C2)');
    > 279 |       expect(Array.isArray(result)).toBe(true);
          |                                     ^
      280 |       if (Array.isArray(result)) {
      281 |         expect(result[0]).toBeCloseTo(10, 10);
      282 |         expect(result[1]).toBeCloseTo(12, 10);

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:279:37)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Integration Tests ‚Ä∫ complete regression analysis (y=3x+2)

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      294 |       const forecast = evaluate('=FORECAST.LINEAR(6, B1:B5, A1:A5)');
      295 |       
    > 296 |       expect(slope).toBeCloseTo(3, 10);
          |                     ^
      297 |       expect(intercept).toBeCloseTo(2, 10);
      298 |       expect(rsq).toBeCloseTo(1, 10);
      299 |       expect(forecast).toBeCloseTo(20, 10);

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:296:21)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Integration Tests ‚Ä∫ correlation and covariance relationship

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      306 |       const covS = evaluate('=COVARIANCE.S(A1:A5, B1:B5)');
      307 |       
    > 308 |       expect(correl).toBeCloseTo(1, 10);
          |                      ^
      309 |       expect(covS).toBeGreaterThan(0);
      310 |     });
      311 |   });

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:308:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Edge Cases ‚Ä∫ handles negative values

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      321 |       setupData([1, 2, 3], [-2, -4, -6]);
      322 |       const slope = evaluate('=SLOPE(B1:B3, A1:A3)');
    > 323 |       expect(slope).toBeCloseTo(-2, 10);
          |                     ^
      324 |     });
      325 |
      326 |     test('handles mixed positive/negative', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:323:21)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Edge Cases ‚Ä∫ handles mixed positive/negative

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      327 |       setupData([-1, 0, 1], [-2, 0, 2]);
      328 |       const correl = evaluate('=CORREL(A1:A3, B1:B3)');
    > 329 |       expect(correl).toBeCloseTo(1, 10);
          |                      ^
      330 |     });
      331 |
      332 |     test('large numbers maintain precision', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:329:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Edge Cases ‚Ä∫ large numbers maintain precision

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      333 |       setupData([1, 2, 3], [1000000, 2000000, 3000000]);
      334 |       const slope = evaluate('=SLOPE(B1:B3, A1:A3)');
    > 335 |       expect(slope).toBeCloseTo(1000000, 5);
          |                     ^
      336 |     });
      337 |
      338 |     test('decimal precision', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:335:21)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Edge Cases ‚Ä∫ decimal precision

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      339 |       setupData([1, 2, 3], [0.1, 0.2, 0.3]);
      340 |       const slope = evaluate('=SLOPE(B1:B3, A1:A3)');
    > 341 |       expect(slope).toBeCloseTo(0.1, 10);
          |                     ^
      342 |     });
      343 |   });
      344 | });

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:341:21)

FAIL packages/core/__tests__/functions/statistical-week2-day1.test.ts
  ‚óè Statistical Functions - Week 2 Day 1 (T-Distribution) ‚Ä∫ T.TEST - Student's T-Test ‚Ä∫ Oracle Test 1: Paired two-tailed test

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      231 |       // T.TEST with paired samples, two-tailed
      232 |       const result = evaluate('=T.TEST(A1:A9, B1:B9, 2, 1)');
    > 233 |       expect(typeof result).toBe('number');
          |                             ^
      234 |       expect(result as number).toBeGreaterThan(0);
      235 |       expect(result as number).toBeLessThan(1);
      236 |     });

      at Object.<anonymous> (__tests__/functions/statistical-week2-day1.test.ts:233:29)

  ‚óè Statistical Functions - Week 2 Day 1 (T-Distribution) ‚Ä∫ T.TEST - Student's T-Test ‚Ä∫ Oracle Test 2: Two-sample equal variance

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      239 |       // T.TEST with equal variance assumption
      240 |       const result = evaluate('=T.TEST(A1:A9, B1:B9, 2, 2)');
    > 241 |       expect(typeof result).toBe('number');
          |                             ^
      242 |       expect(result as number).toBeGreaterThan(0);
      243 |       expect(result as number).toBeLessThan(1);
      244 |     });

      at Object.<anonymous> (__tests__/functions/statistical-week2-day1.test.ts:241:29)

  ‚óè Statistical Functions - Week 2 Day 1 (T-Distribution) ‚Ä∫ T.TEST - Student's T-Test ‚Ä∫ Oracle Test 3: Two-sample unequal variance (Welch)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      247 |       // T.TEST with unequal variance (Welch's t-test)
      248 |       const result = evaluate('=T.TEST(A1:A9, B1:B9, 2, 3)');
    > 249 |       expect(typeof result).toBe('number');
          |                             ^
      250 |       expect(result as number).toBeGreaterThan(0);
      251 |       expect(result as number).toBeLessThan(1);
      252 |     });

      at Object.<anonymous> (__tests__/functions/statistical-week2-day1.test.ts:249:29)

  ‚óè Statistical Functions - Week 2 Day 1 (T-Distribution) ‚Ä∫ T.TEST - Student's T-Test ‚Ä∫ Oracle Test 4: One-tailed test

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      255 |       // T.TEST with one tail
      256 |       const result = evaluate('=T.TEST(A1:A9, B1:B9, 1, 2)');
    > 257 |       expect(typeof result).toBe('number');
          |                             ^
      258 |       expect(result as number).toBeGreaterThan(0);
      259 |       expect(result as number).toBeLessThan(1);
      260 |     });

      at Object.<anonymous> (__tests__/functions/statistical-week2-day1.test.ts:257:29)

ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
PASS packages/core/test/benchmarks/styleCache.step3.bench.test.ts
  ‚óè Console

    console.log
      
      [BasicRefCount] ‚úÖ Increment/decrement/cleanup verified

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:55:13)

    console.log
      
      [UndoRedo] 1000 cycles complete

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:125:13)

    console.log
      [UndoRedo] Cache size min: 1

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:126:13)

    console.log
      [UndoRedo] Cache size max: 1

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:127:13)

    console.log
      [UndoRedo] Cache size final: 0

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:128:13)

    console.log
      [UndoRedo] Memory growth: -2033.15 KB

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:129:13)

    console.log
      [UndoRedo] Bucket count final: 0

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:130:13)

    console.log
      [UndoRedo] ‚úÖ Memory stable, no leaks, bucket cleanup verified

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:146:13)

    console.log
      
      [HighChurn] 1000 cycles complete

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:187:13)

    console.log
      [HighChurn] Cache size oscillates: 0 ‚Üí 50 ‚Üí 0 (stable)

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:188:13)

    console.log
      [HighChurn] Memory growth: -28734.23 KB

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:189:13)

    console.log
      [HighChurn] Bucket count final: 0

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:190:13)

    console.log
      [HighChurn] ‚úÖ Full clear verified, no orphan buckets

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:201:13)

    console.log
      
      [PartialRelease] After partial releases:

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:238:13)

    console.log
      [PartialRelease] Cache size: 5

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:239:13)

    console.log
      [PartialRelease] Expected: 5 (styles[0..4] with refCount=5)

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:240:13)

    console.log
      [PartialRelease] ‚úÖ Selective cleanup verified, no premature removal

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:257:13)

    console.log
      
      [EdgeCases] Testing edge cases (expect warnings, no crashes)...

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:267:13)

    console.warn
      StyleCache.release: style not found in refCount

      655 |       // Do not throw ‚Äî callers may call release defensively.
      656 |       // eslint-disable-next-line no-console
    > 657 |       console.warn('StyleCache.release: style not found in refCount');
          |               ^
      658 |       return;
      659 |     }
      660 |

      at StyleCache.warn [as release] (src/StyleCache.ts:657:15)
      at test/benchmarks/styleCache.step3.bench.test.ts:272:13
      at Object.<anonymous> (../../node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (../../node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:273:12)

    console.log
      [EdgeCases] ‚úÖ Release non-existent: no crash

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:274:13)

    console.warn
      StyleCache.release: style not found in refCount

      655 |       // Do not throw ‚Äî callers may call release defensively.
      656 |       // eslint-disable-next-line no-console
    > 657 |       console.warn('StyleCache.release: style not found in refCount');
          |               ^
      658 |       return;
      659 |     }
      660 |

      at StyleCache.warn [as release] (src/StyleCache.ts:657:15)
      at test/benchmarks/styleCache.step3.bench.test.ts:281:13
      at Object.<anonymous> (../../node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (../../node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:282:12)

    console.log
      [EdgeCases] ‚úÖ Double release: no crash

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:283:13)

    console.log
      [EdgeCases] ‚úÖ Release after clear: no crash

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:292:13)

    console.log
      [EdgeCases] ‚úÖ Intern after clear: works correctly

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:297:13)

    console.log
      [EdgeCases] ‚úÖ All edge cases handled gracefully

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:299:13)

    console.log
      
      [Concurrent] 1000 interleaved ops complete

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:337:13)

    console.log
      [Concurrent] Cache size final: 0

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:338:13)

    console.log
      [Concurrent] Bucket count final: 0

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:339:13)

    console.log
      [Concurrent] ‚úÖ No crashes, no orphan styles

      at Object.<anonymous> (test/benchmarks/styleCache.step3.bench.test.ts:347:13)

PASS packages/core/__tests__/debug-median.test.ts
  ‚óè Console

    console.log
      A1: 15

      at Object.<anonymous> (__tests__/debug-median.test.ts:21:13)

    console.log
      A2: 5

      at Object.<anonymous> (__tests__/debug-median.test.ts:22:13)

    console.log
      A3: 25

      at Object.<anonymous> (__tests__/debug-median.test.ts:23:13)

    console.log
      A4: 10

      at Object.<anonymous> (__tests__/debug-median.test.ts:24:13)

    console.log
      A5: 20

      at Object.<anonymous> (__tests__/debug-median.test.ts:25:13)

    console.log
      Result: 15

      at Object.<anonymous> (__tests__/debug-median.test.ts:28:13)

    console.log
      Result type: number

      at Object.<anonymous> (__tests__/debug-median.test.ts:29:13)

    console.log
      Is Array?: false

      at Object.<anonymous> (__tests__/debug-median.test.ts:30:13)

PASS packages/core/__tests__/functions/financial-oracle.test.ts
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
PASS packages/renderer-canvas/__tests__/chart-accessibility-manager.test.ts
PASS packages/renderer-canvas/__tests__/error-highlighting.test.ts
PASS packages/renderer-canvas/__tests__/chart-exporter.test.ts
PASS packages/renderer-canvas/__tests__/chart-data-stream-manager.test.ts
PASS packages/core/__tests__/debug-trend.test.ts
  ‚óè Console

    console.log
      TREND result: [ 2, 4, 6, 8 ]

      at Object.<anonymous> (__tests__/debug-trend.test.ts:27:13)

    console.log
      Result type: object

      at Object.<anonymous> (__tests__/debug-trend.test.ts:28:13)

    console.log
      Is Array?: true

      at Object.<anonymous> (__tests__/debug-trend.test.ts:29:13)

    console.log
      Array length: 4

      at Object.<anonymous> (__tests__/debug-trend.test.ts:31:15)

    console.log
      result[0]: 2

      at Object.<anonymous> (__tests__/debug-trend.test.ts:32:15)

    console.log
      result[1]: 4

      at Object.<anonymous> (__tests__/debug-trend.test.ts:33:15)

    console.log
      result[2]: 6

      at Object.<anonymous> (__tests__/debug-trend.test.ts:34:15)

    console.log
      result[3]: 8

      at Object.<anonymous> (__tests__/debug-trend.test.ts:35:15)

PASS packages/core/__tests__/conditional-formatting-batch-benchmark.test.ts
PASS packages/core/__tests__/conditional-aggregation.test.ts
PASS packages/core/test/temporal-identity-stability.test.ts
PASS packages/core/test/benchmarks/styleCache.step1.bench.test.ts
  ‚óè Console

    console.log
      [Cold Cache] Hit rate: 99.96%

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:44:15)

    console.log
      [Cold Cache] Avg intern: 0.0038ms

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:45:15)

    console.log
      [Cold Cache] Total time: 433.03ms

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:46:15)

    console.log
      [Cold Cache] Cache size: 36

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:47:15)

    console.log
      [Cold Cache] Max bucket depth: 1

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:48:15)

    console.log
      [Hot Cache] Avg intern: 0.0065ms

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:79:15)

    console.log
      [Hot Cache] Total time: 716.61ms

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:80:15)

    console.log
      [Hot Cache] Hit count: 99999

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:81:15)

    console.log
      [Hot Cache] Miss count: 1

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:82:15)

    console.log
      [Buckets] Cache size: 1000

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:107:15)

    console.log
      [Buckets] Bucket count: 1000

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:108:15)

    console.log
      [Buckets] Max depth: 1

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:109:15)

    console.log
      [Buckets] Avg depth: 1.00

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:110:15)

    console.log
      [Buckets] Collision rate: 0.00%

      at Object.<anonymous> (test/benchmarks/styleCache.step1.bench.test.ts:111:15)

PASS packages/core/test/benchmarks/freezeIsolated.bench.test.ts
  ‚óè Console

    console.log
      
      üî• Warmup: Shape-specific for all 3 modes

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:25:13)

    console.log
      ‚úÖ Warmup complete (15k iterations, V8 JIT stabilized)

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:55:13)

    console.log
      
      [Shallow/Simple] Avg: 0.313¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:85:13)

    console.log
      [Shallow/Simple] Max: 3.574¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:86:13)

    console.log
      [Shallow/Simple] Min: 0.125¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:87:13)

    console.log
      
      [Deep/Complex] Avg: 3.134¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:119:13)

    console.log
      [Deep/Complex] Max: 15.645¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:120:13)

    console.log
      [Deep/Complex] Min: 0.809¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:121:13)

    console.log
      ‚úÖ Deep freeze ‚â§0.05ms ‚Üí Production deep freeze acceptable

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:130:15)

    console.log
      
      [Proxy/DevOnly] Avg: 0.377¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:159:13)

    console.log
      [Proxy/DevOnly] Max: 7.637¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:160:13)

    console.log
      ‚ö†Ô∏è  Proxy is dev-only (not recommended for production)

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:161:13)

    console.log
      
      [Shallow/Batch] Total: 15.48ms

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:184:13)

    console.log
      [Shallow/Batch] Avg: 3.096¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:185:13)

    console.log
      [Shallow/Batch] Throughput: 322972 freezes/sec

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:186:13)

    console.log
      
      [Deep/WorstCase] Avg: 5.221¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:238:13)

    console.log
      [Deep/WorstCase] Max: 44.099¬µs

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:239:13)

    console.log
      [Deep/WorstCase] Nesting: borders (4 sides) + gradient (3 stops)

      at Object.<anonymous> (test/benchmarks/freezeIsolated.bench.test.ts:240:13)

PASS packages/core/__tests__/performance/performance-benchmark.test.ts
  ‚óè Console

    console.log
      
      üìä SUM Performance (100 items):

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:94:15)

    console.log
         Average: 0.184ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:95:15)

    console.log
         Ops/sec: 5423.8

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:96:15)

    console.log
      
      üìä AVERAGE Performance (100 items):

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:110:15)

    console.log
         Average: 0.176ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:111:15)

    console.log
         Ops/sec: 5670.63

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:112:15)

    console.log
      
      üìä PRODUCT Performance (20 items):

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:126:15)

    console.log
         Average: 0.032ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:127:15)

    console.log
         Ops/sec: 30934.84

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:128:15)

    console.log
      
      üìä MEDIAN Performance (1K items):

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:145:15)

    console.log
         Average: 2.23ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:146:15)

    console.log
         Ops/sec: 448.48

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:147:15)

    console.log
      
      üìä STDEV.S Performance (1K items):

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:161:15)

    console.log
         Average: 2.354ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:162:15)

    console.log
         Ops/sec: 424.75

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:163:15)

    console.log
      
      üìä CONCAT Performance (50 strings):

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:180:15)

    console.log
         Average: 0.206ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:181:15)

    console.log
         Ops/sec: 4853.85

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:182:15)

    console.log
      
      üìä TEXTJOIN Performance (50 strings):

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:195:15)

    console.log
         Average: 0.215ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:196:15)

    console.log
         Ops/sec: 4646.86

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:197:15)

    console.log
      
      üìä DATE Performance (single date):

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:212:15)

    console.log
         Average: 0.013ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:213:15)

    console.log
         Ops/sec: 75338.27

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:214:15)

    console.log
      
      üìä YEAR Performance:

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:228:15)

    console.log
         Average: 0.056ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:229:15)

    console.log
         Ops/sec: 17922.89

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:230:15)

    console.log
      
      üìä Nested Date Operations:

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:243:15)

    console.log
         Average: 0.107ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:244:15)

    console.log
         Ops/sec: 9381.11

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:245:15)

    console.log
      
      üìä Nested IF Performance:

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:260:15)

    console.log
         Average: 0.15ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:261:15)

    console.log
         Ops/sec: 6685.33

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:262:15)

    console.log
      
      üìä Mixed Formula Performance:

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:275:15)

    console.log
         Average: 0.082ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:276:15)

    console.log
         Ops/sec: 12210.77

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:277:15)

    console.log
      
      üìä Error Handling Performance:

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:292:15)

    console.log
         Average: 0.058ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:293:15)

    console.log
         Ops/sec: 17241.09

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:294:15)

    console.log
      
      
      ============================================================

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:303:13)

    console.log
      üìä PERFORMANCE BENCHMARK SUMMARY

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:304:13)

    console.log
      ============================================================

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:305:13)

    console.log
      
      ‚úÖ All performance benchmarks completed

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:306:13)

    console.log
      üìù Review logs above for detailed metrics

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:307:13)

    console.log
      
      üí° Optimization Opportunities:

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:308:13)

    console.log
         - Functions > 5ms average: Consider optimization

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:309:13)

    console.log
         - Functions > 20ms average: Priority optimization

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:310:13)

    console.log
      
      üéØ Performance Goals:

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:311:13)

    console.log
         - Simple operations: < 1ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:312:13)

    console.log
         - Complex operations: < 5ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:313:13)

    console.log
         - Large dataset operations: < 20ms

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:314:13)

    console.log
      
      ============================================================

      at Object.<anonymous> (__tests__/performance/performance-benchmark.test.ts:315:13)

PASS packages/renderer-canvas/__tests__/chart-animation-engine.test.ts
PASS packages/core/__tests__/metadata-validation.test.ts
  ‚óè Console

    console.log
      ‚úÖ 279 functions with complete metadata

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:133:13)

    console.log
      ‚úÖ Volatile functions: RAND, RANDBETWEEN, NOW, TODAY, RANDARRAY

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:252:13)

    console.log
      ‚úÖ Iterative functions: IRR, XIRR, RATE

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:277:13)

    console.log
      ‚úÖ Context-aware functions: ROW, COLUMN, ISFORMULA, CELL, INFO

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:314:13)

    console.log
      ‚úÖ Special functions (9): AGGREGATE, SUBTOTAL, IF, IFS, IFERROR, IFNA, SWITCH, AND, OR

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:332:13)

    console.log
      ‚úÖ Complexity distribution:

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:367:13)

    console.log
         O(1): 161

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:368:13)

    console.log
         O(n): 91

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:369:13)

    console.log
         O(n log n): 21

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:370:13)

    console.log
         O(n¬≤): 3

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:371:13)

    console.log
         ITERATIVE: 3

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:372:13)

    console.log
      ‚úÖ Precision distribution:

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:400:13)

    console.log
         EXACT: 181

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:401:13)

    console.log
         STATISTICAL: 45

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:402:13)

    console.log
         ERF_LIMITED: 34

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:403:13)

    console.log
         FINANCIAL: 16

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:404:13)

    console.log
         ITERATIVE: 3

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:405:13)

    console.log
      ‚úÖ ErrorStrategy distribution:

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:435:13)

    console.log
         PROPAGATE_FIRST: 192

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:436:13)

    console.log
         SKIP_ERRORS: 54

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:437:13)

    console.log
         FINANCIAL_STRICT: 19

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:438:13)

    console.log
         LOOKUP_STRICT: 7

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:439:13)

    console.log
         LAZY_EVALUATION: 5

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:440:13)

    console.log
         SHORT_CIRCUIT: 2

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:441:13)

    console.log
      
      üèÜ WAVE 0 DAY 3: METADATA VALIDATION COMPLETE

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:523:13)

    console.log
      ================================================

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:524:13)

    console.log
      ‚úÖ Total functions validated: 279

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:525:13)

    console.log
      ‚úÖ Volatile functions: 5

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:526:13)

    console.log
      ‚úÖ Iterative functions: 3

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:527:13)

    console.log
      ‚úÖ Context-aware functions: 5

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:528:13)

    console.log
      ‚úÖ Special functions: 9

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:529:13)

    console.log
      ‚úÖ All required fields present

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:530:13)

    console.log
      ‚úÖ All SDK-grade enforcement fields validated

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:531:13)

    console.log
      ‚úÖ Ready for pre-commit hook integration

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:532:13)

    console.log
      ================================================

      at Object.<anonymous> (__tests__/metadata-validation.test.ts:533:13)

PASS packages/renderer-canvas/__tests__/chart-animation-integration.test.ts
PASS packages/renderer-canvas/__tests__/chart-dual-axis-manager.test.ts
PASS packages/core/__tests__/functions/statistical-week2-day4.test.ts
PASS packages/core/__tests__/functions/statistical-week2-day5.test.ts
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
PASS packages/core/__tests__/lazy-evaluation-integration.test.ts
PASS packages/renderer-canvas/__tests__/canvas-cache.test.ts
PASS packages/core/__tests__/functions/error-handling.test.ts
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
PASS packages/core/__tests__/functions/text-search-extract.test.ts
PASS packages/core/__tests__/xmatch.test.ts
PASS packages/core/__tests__/functions/type-conversion.test.ts
PASS packages/core/__tests__/filter.test.ts
PASS packages/core/__tests__/makearray.test.ts
PASS packages/core/__tests__/utils/formula-live-preview.test.ts
PASS packages/renderer-canvas/__tests__/3d-gantt-radar.test.ts
PASS packages/renderer-canvas/__tests__/chart-renderer-plugin.test.ts
PASS packages/core/__tests__/array-slicing.test.ts
PASS packages/renderer-canvas/__tests__/chart-interaction-enhancer.test.ts
PASS packages/core/__tests__/sort.test.ts
PASS io-xlsx packages/io-xlsx/test/round-trip-symmetry.test.ts
PASS packages/core/__tests__/functions/financial-week1-day3.test.ts
PASS packages/renderer-canvas/__tests__/advanced-chart-types.test.ts
PASS packages/renderer-canvas/__tests__/chart-interaction-integration.test.ts
PASS packages/core/__tests__/functions/statistical-distributions.test.ts
PASS packages/core/__tests__/random.test.ts
PASS packages/renderer-canvas/__tests__/treemap-waterfall.test.ts
PASS packages/core/__tests__/sortby.test.ts
PASS packages/core/__tests__/offset.test.ts
PASS packages/renderer-canvas/__tests__/chart-engine.test.ts
PASS packages/core/__tests__/multi-conditional-aggregation.test.ts
FAIL packages/core/test/benchmarks/hashFunction.bench.test.ts
  ‚óè Console

    console.log
      [Typical] Collision rate: 0.00%

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:48:15)

    console.log
      [Typical] Unique hashes: 36 / 36

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:49:15)

    console.log
      [Sequential Colors] Collision rate: 0.00%

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:87:15)

    console.log
      [Sequential Colors] Unique hashes: 10000 / 10000

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:88:15)

    console.log
      [Sequential Colors] Bucket count: 10000

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:89:15)

    console.log
      [Distribution] Chi-squared: 211.33

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:122:15)

    console.log
      [Distribution] Critical value (p=0.05): 293

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:123:15)

    console.log
      [Distribution] Uniform: YES

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:124:15)

    console.log
      [Designer] Collision rate: 0.00%

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:160:15)

    console.log
      [Designer] Unique hashes: 5000 / 5000

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:161:15)

    console.log
      [Designer] Max bucket depth: 0

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:162:15)

    console.log
      [Performance] Avg hash time: 0.0450ms

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:188:15)

    console.log
      [Performance] Total time: 44.97ms for 1000 styles

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:189:15)

  ‚óè Hash Function Quality Benchmarks ‚Ä∫ Hash Performance ‚Ä∫ Hash computation <0.01ms avg

    expect(received).toBeLessThan(expected)

    Expected: < 0.01
    Received:   0.04497176800000125

      189 |       console.log('[Performance] Total time:', (end - start).toFixed(2) + 'ms for 1000 styles');
      190 |       
    > 191 |       expect(avgTime).toBeLessThan(0.01); // <0.01ms per hash
          |                       ^
      192 |     });
      193 |   });
      194 | });

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:191:23)

FAIL packages/core/test/benchmarks/styleCache.step2.bench.test.ts (11.252 s)
  ‚óè Console

    console.log
      
      [Typical] Total time: 1304.34ms

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:45:13)

    console.log
      [Typical] Avg intern: 11.594¬µs

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:46:13)

    console.log
      [Typical] Hit rate: 99.97%

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:47:13)

    console.log
      [Typical] Cache size: 30

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:48:13)

    console.log
      [Typical] Max bucket depth: 1

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:49:13)

    console.log
      [Typical] Collision rate: 0.00%

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:50:13)

    console.log
      [Typical] Memory delta: 31738.05 KB

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:51:13)

    console.log
      [Typical] Freeze overhead: 0.00%

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:55:13)

    console.log
      
      [HighDiversity] Total time: 6123.28ms

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:97:13)

    console.log
      [HighDiversity] Avg intern: 11.752¬µs

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:98:13)

    console.log
      [HighDiversity] Hit rate: 99.00%

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:99:13)

    console.log
      [HighDiversity] Cache size: 5000

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:100:13)

    console.log
      [HighDiversity] Max bucket depth: 1

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:101:13)

    console.log
      [HighDiversity] Collision rate: 0.00%

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:102:13)

    console.log
      [HighDiversity] Memory delta: 40352.00 KB

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:103:13)

    console.log
      [HighDiversity] Freeze overhead: 0.08%

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:107:13)

    console.log
      
      [HotCache] Total time: 415.69ms

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:151:13)

    console.log
      [HotCache] Avg intern: 4.157¬µs

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:152:13)

    console.log
      [HotCache] Hit count: 100000

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:153:13)

    console.log
      [HotCache] Miss count: 1

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:154:13)

    console.log
      
      [MemoryLeak] Initial: 211986.03 KB

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:197:13)

    console.log
      [MemoryLeak] Final: 206821.97 KB

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:198:13)

    console.log
      [MemoryLeak] Growth: -5164.06 KB

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:199:13)

    console.log
      
      [Buckets] Cache size: 5000

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:220:13)

    console.log
      [Buckets] Bucket count: 5000

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:221:13)

    console.log
      [Buckets] Max depth: 1

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:222:13)

    console.log
      [Buckets] Avg depth: 1.00

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:223:13)

    console.log
      [Buckets] Collision rate: 0.00%

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:224:13)

  ‚óè StyleCache with Freeze (Step 2.2) ‚Ä∫ Typical workload: 100k cells, 50 unique styles WITH deep freeze

    expect(received).toBeLessThan(expected)

    Expected: < 0.005
    Received:   0.011593552700000828

      56 |     
      57 |     // Gate: Intern avg ‚â§ 5¬µs
    > 58 |     expect(avgIntern).toBeLessThan(0.005);
         |                       ^
      59 |     
      60 |     // Gate: Hit rate ‚â•99.95%
      61 |     expect(hitRate).toBeGreaterThanOrEqual(0.9995);

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:58:23)

  ‚óè StyleCache with Freeze (Step 2.2) ‚Ä∫ High diversity: 500k cells, 5000 unique styles (Rich Text Phase 2 scenario)

    expect(received).toBeLessThan(expected)

    Expected: < 0.005
    Received:   0.01175183478400137

      108 |     
      109 |     // Gate: Intern avg ‚â§ 5¬µs
    > 110 |     expect(avgIntern).toBeLessThan(0.005);
          |                       ^
      111 |     
      112 |     // Gate: Hit rate ‚â•99% (relaxed for high diversity)
      113 |     expect(hitRate).toBeGreaterThanOrEqual(0.99);

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:110:23)

  ‚óè StyleCache with Freeze (Step 2.2) ‚Ä∫ Memory leak check: 10 cycles of 10k interns + clear

    expect(received).toBeLessThan(expected)

    Expected: < 102400
    Received:   5288000

      200 |     
      201 |     // Gate: Memory growth <100 KB (acceptable for GC noise)
    > 202 |     expect(Math.abs(memoryGrowth)).toBeLessThan(100 * 1024);
          |                                    ^
      203 |   });
      204 |   
      205 |   // ============================================================

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:202:36)

(node:75037) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
PASS packages/core/__tests__/conditional-formatting-performance.test.ts
  ‚óè Console

    console.log
      üìä Large Dataset (1000 cells, 1 rule):

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:84:12)

    console.log
         Average time: 0.022ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:85:12)

    console.log
         Max time: 19.021ms

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:86:12)

    console.log
         Total time: 22.14ms for 1000 cells

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:87:12)

    console.log
      üìä Large Dataset (10,000 cells, 1 rule) [sampled]:

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:118:12)

    console.log
         Average time: 0.001ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:119:12)

    console.log
         Estimated total: 13.14ms for 10,000 cells

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:120:12)

    console.log
         Estimated total: 0.01s

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:121:12)

    console.log
      üìä Large Dataset with getValue (1000 cells):

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:164:12)

    console.log
         Average time: 0.004ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:165:12)

    console.log
         Overhead vs baseline: includes getValue callback cost

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:166:12)

    console.log
      üéõÔ∏è Many Rules (10 concurrent rules):

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:199:12)

    console.log
         Average time: 0.011ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:200:12)

    console.log
         Rules processed: 10

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:201:12)

    console.log
      üéõÔ∏è Many Rules (20 concurrent rules, mixed types):

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:253:12)

    console.log
         Average time: 0.021ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:254:12)

    console.log
         10 value rules + 10 formula rules

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:255:12)

    console.log
      üéõÔ∏è stopIfTrue Optimization (10 rules, first matches):

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:296:12)

    console.log
         Average time: 0.014ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:297:12)

    console.log
         Expected: Should be faster than 10 rules without stopIfTrue

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:298:12)

    console.log
      üîÑ Complex Formula (nested AND/OR/NOT):

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:344:12)

    console.log
         Average time: 0.003ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:345:12)

    console.log
         Multiple getValue calls per evaluation

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:346:12)

    console.log
      üîÑ Formula with Many References (SUM across 10 cells):

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:392:12)

    console.log
         Average time: 0.002ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:393:12)

    console.log
         10 getValue calls per evaluation

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:394:12)

    console.log
      üîÑ Circular Reference Detection:

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:433:12)

    console.log
         Average time: 0.002ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:434:12)

    console.log
         Detection calls: 100

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:435:12)

    console.log
         Overhead: Includes safety checks

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:436:12)

    console.log
      üìà Top-Bottom Rule (1000 cells, top 10):

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:476:12)

    console.log
         Average time: 10.801ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:477:12)

    console.log
         Note: Range-aware calculation - may need full dataset scan

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:478:12)

    console.log
         Status: NOT IMPLEMENTED - baseline measurement

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:479:12)

    console.log
      üìà Above-Average Rule (1000 cells):

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:514:12)

    console.log
         Average time: 11.027ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:515:12)

    console.log
         Note: Requires average calculation across range

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:516:12)

    console.log
         Status: NOT IMPLEMENTED - baseline measurement

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:517:12)

    console.log
      
      ‚ö° PERFORMANCE SUMMARY:

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:526:12)

    console.log
         ‚úÖ Tests document CURRENT performance

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:527:12)

    console.log
         ‚úÖ No optimization performed (per user directive)

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:528:12)

    console.log
         ‚úÖ Baseline established for future improvements

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:529:12)

    console.log
         
         Key Findings:

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:530:12)

    console.log
         - Single rule performance: Sub-millisecond per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:531:12)

    console.log
         - Multi-rule overhead: Linear scaling with rule count

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:532:12)

    console.log
         - stopIfTrue optimization: Effective early exit

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:533:12)

    console.log
         - Formula evaluation: Depends on getValue complexity

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:534:12)

    console.log
         - Statistical rules: NOT IMPLEMENTED (baseline only)

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:535:12)

    console.log
         
         Recommendations:

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:536:12)

    console.log
         - Current performance acceptable for < 10,000 cells

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:537:12)

    console.log
         - Consider batch processing for larger datasets

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:538:12)

    console.log
         - Formula caching could reduce repeated evaluations

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:539:12)

    console.log
         - Statistical rules will need efficient range algorithms

      at Object.<anonymous> (__tests__/conditional-formatting-performance.test.ts:540:12)

PASS packages/core/__tests__/conditional-formatting-icon-sets-comprehensive.test.ts
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
PASS packages/core/__tests__/sequence.test.ts
PASS packages/core/__tests__/functions/distribution-oracle-validation.test.ts
PASS packages/core/__tests__/functional-programming.test.ts
PASS packages/core/__tests__/utils/formula-tokenizer.test.ts
PASS packages/core/__tests__/utils/formula-syntax-highlighter.test.ts
PASS packages/core/__tests__/conditional-formatting-strategies.test.ts
  ‚óè Console

    console.log
      
      ‚úÖ PERFORMANCE TEST PASSED: 36.51ms for 10k cells √ó 5 rules

      at Object.<anonymous> (__tests__/conditional-formatting-strategies.test.ts:441:12)

PASS packages/core/__tests__/functions/financial-debug.test.ts
  ‚óè Console

    console.log
      Result type: number

      at Object.<anonymous> (__tests__/functions/financial-debug.test.ts:26:13)

    console.log
      Result value: 950.9596339047878

      at Object.<anonymous> (__tests__/functions/financial-debug.test.ts:27:13)

    console.log
      Is Error: false

      at Object.<anonymous> (__tests__/functions/financial-debug.test.ts:28:13)

    console.log
      SUM result: 6

      at Object.<anonymous> (__tests__/functions/financial-debug.test.ts:37:13)

PASS packages/core/__tests__/conditional-formatting-performance-guardrails.test.ts
  ‚óè Console

    console.log
      O(n¬≤) Detector: 100 scans, 1.08ms

      at Object.<anonymous> (__tests__/conditional-formatting-performance-guardrails.test.ts:66:12)

    console.log
      Average Recompute: 100 scans, 1.07ms

      at Object.<anonymous> (__tests__/conditional-formatting-performance-guardrails.test.ts:103:12)

    console.log
      10 Rules Benchmark: 0.021ms per evaluation

      at Object.<anonymous> (__tests__/conditional-formatting-performance-guardrails.test.ts:137:12)

    console.log
      50 Rules Stress Test: 0.04ms

      at Object.<anonymous> (__tests__/conditional-formatting-performance-guardrails.test.ts:164:12)

    console.log
      1000-Cell Range Scan: 1.29ms

      at Object.<anonymous> (__tests__/conditional-formatting-performance-guardrails.test.ts:198:12)

    console.log
      10k√ó10k Grid (mocked): 0.004ms per cell

      at Object.<anonymous> (__tests__/conditional-formatting-performance-guardrails.test.ts:227:12)

    console.log
      Cache Stats: {
        firstPass: { hits: 99, misses: 1, hitRatio: 0.99, size: 1 },
        secondPass: { hits: 199, misses: 1, hitRatio: 0.995, size: 1 }
      }

      at Object.<anonymous> (__tests__/conditional-formatting-performance-guardrails.test.ts:278:12)

    console.log
      Formula Stress: 0.005ms per evaluation

      at Object.<anonymous> (__tests__/conditional-formatting-performance-guardrails.test.ts:317:12)

PASS packages/core/__tests__/conditional-formatting-formula-compiler.test.ts
  ‚óè Console

    console.log
      ‚úÖ PERFORMANCE: 53.68ms for 10k formula evaluations

      at Object.<anonymous> (__tests__/conditional-formatting-formula-compiler.test.ts:170:9)

PASS packages/core/__tests__/excel-oracle/conditional-formatting-wave4-regression.test.ts
PASS packages/core/__tests__/parser.test.ts
PASS packages/core/__tests__/indirect.test.ts
PASS packages/core/__tests__/functions/database-functions.test.ts
PASS packages/core/__tests__/conditional-formatting-edge-types.test.ts
PASS packages/core/__tests__/functions/information.test.ts
PASS packages/core/__tests__/index-match.test.ts
PASS packages/core/__tests__/lambda.test.ts
PASS packages/core/__tests__/scan.test.ts
PASS packages/core/__tests__/spill.test.ts
PASS packages/core/__tests__/functions/text-manipulation.test.ts
PASS packages/core/test/interning-safeguard.test.ts
PASS packages/renderer-canvas/__tests__/performance-monitor.test.ts
PASS packages/core/__tests__/conditional-formatting-dirty-propagation-engine.test.ts
PASS packages/core/__tests__/conditional-formatting-dependency-graph.test.ts
PASS packages/core/__tests__/conditional-formatting-display-semantics.test.ts
PASS packages/core/test/phase1-ui-identity.test.ts
  ‚óè Console

    console.log
      Generated 72 unique styles from 1000 iterations (92.8% collision rate)

      at Object.<anonymous> (test/phase1-ui-identity.test.ts:351:15)

PASS packages/core/__tests__/conditional-formatting-icon-sets.test.ts
PASS packages/core/__tests__/conditional-formatting-determinism.test.ts
PASS packages/core/__tests__/advanced/advanced-functions.test.ts
  ‚óè Console

    console.log
      
      ============================================================

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:363:15)

    console.log
      üìä ADVANCED FUNCTIONS TEST SUMMARY

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:364:15)

    console.log
      ============================================================

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:365:15)

    console.log
      
      ‚úÖ Functions Tested:

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:366:15)

    console.log
         - XLOOKUP: Match modes, search modes, wildcards, binary search

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:367:15)

    console.log
         - XMATCH: Position finding, all modes

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:368:15)

    console.log
         - FILTER: Conditional filtering, empty handling

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:369:15)

    console.log
         - SORT: Ascending/descending, mixed types

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:370:15)

    console.log
         - UNIQUE: Deduplication, order preservation

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:371:15)

    console.log
      
      üìà Coverage: Excel 365 advanced array functions

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:372:15)

    console.log
      üéØ Status: Production ready

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:373:15)

    console.log
      ‚ö° Performance: All operations < 100ms for 10K items

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:374:15)

    console.log
      
      ============================================================

      at Object.<anonymous> (__tests__/advanced/advanced-functions.test.ts:375:15)

PASS packages/core/__tests__/conditional-formatting-interaction-overlapping.test.ts
PASS packages/renderer-canvas/__tests__/renderer.test.ts
PASS packages/core/__tests__/conditional-formatting-relative-references-batch.test.ts
PASS packages/core/__tests__/xlookup.test.ts
PASS packages/core/__tests__/versionManager.test.ts
PASS packages/core/__tests__/conditional-formatting-dependency-graph-range-stats.test.ts
PASS packages/core/__tests__/conditional-formatting-edge-formula.test.ts
PASS packages/core/__tests__/functions/week3-info-functions.test.ts
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
PASS packages/core/test/border-normalization.test.ts
PASS packages/core/__tests__/range-stats-manager.test.ts
PASS packages/core/__tests__/conditional-formatting-golden-behavior.test.ts
PASS packages/core/__tests__/conditional-formatting-edge-statistical.test.ts
PASS packages/core/__tests__/conditional-formatting-interaction-mixed-types.test.ts
PASS packages/core/__tests__/lazy-evaluation-handler.test.ts
PASS packages/core/__tests__/conditional-formatting-edge-blank.test.ts
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
ts-jest[ts-jest-transformer] (WARN) Define `ts-jest` config under `globals` is deprecated. Please do
transform: {
    <transform_regex>: ['ts-jest', { /* ts-jest config goes here in Jest */ }],
},
See more at https://kulshekhar.github.io/ts-jest/docs/getting-started/presets#advanced
ts-jest[config] (WARN) [94mmessage[0m[90m TS151001: [0mIf you have issues related to imports, you should consider setting `esModuleInterop` to `true` in your TypeScript configuration file (usually `tsconfig.json`). See https://blogs.msdn.microsoft.com/typescript/2018/01/31/announcing-typescript-2-7/#easier-ecmascript-module-interoperability for more information.
PASS packages/core/__tests__/maxifs-minifs.test.ts
PASS packages/core/__tests__/conditional-formatting-interaction-manual-styles.test.ts
PASS packages/core/__tests__/hlookup.test.ts
FAIL packages/renderer-canvas/__tests__/chart-manager.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/chart-manager.test.ts[0m:[93m9[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ChartCreateParams'.

    [7m9[0m import type { ChartCreateParams, ChartObject } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/__tests__/chart-manager.test.ts[0m:[93m9[0m:[93m34[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ChartObject'.

    [7m9[0m import type { ChartCreateParams, ChartObject } from '@cyber-sheet/core';
    [7m [0m [91m                                 ~~~~~~~~~~~[0m

FAIL packages/core/__tests__/registry/autocomplete.test.ts
  ‚óè Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (../../node_modules/@jest/core/build/TestScheduler.js:133:18)
      at ../../node_modules/@jest/core/build/TestScheduler.js:254:19
      at ../../node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (../../node_modules/emittery/index.js:361:23)

FAIL packages/core/__tests__/debug-correlation.test.ts
  ‚óè Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (../../node_modules/@jest/core/build/TestScheduler.js:133:18)
      at ../../node_modules/@jest/core/build/TestScheduler.js:254:19
      at ../../node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (../../node_modules/emittery/index.js:361:23)

FAIL packages/renderer-canvas/__tests__/advanced-chart-renderer.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/advanced-chart-renderer.test.ts[0m:[93m9[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ComboChartConfig'.

    [7m9[0m import type { ComboChartConfig, AdvancedChartOptions } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/__tests__/advanced-chart-renderer.test.ts[0m:[93m9[0m:[93m33[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AdvancedChartOptions'.

    [7m9[0m import type { ComboChartConfig, AdvancedChartOptions } from '@cyber-sheet/core';
    [7m [0m [91m                                ~~~~~~~~~~~~~~~~~~~~[0m

PASS packages/core/__tests__/choose.test.ts
PASS packages/core/__tests__/error-strategy-semantic-invariants.test.ts
  ‚óè Console

    console.log
      ‚ÑπÔ∏è  SKIP_ERRORS functions: 54

      at Object.<anonymous> (__tests__/error-strategy-semantic-invariants.test.ts:207:15)

    console.log
      ‚ÑπÔ∏è  PROPAGATE_FIRST functions: 192

      at Object.<anonymous> (__tests__/error-strategy-semantic-invariants.test.ts:222:15)

FAIL packages/core/test/benchmarks/layout.bench.test.ts
  ‚óè Test suite failed to run

    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m45[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m45[0m     const input: LayoutInput = {
    [7m  [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m88[0m:[93m13[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m88[0m       const input: LayoutInput = {
    [7m  [0m [91m            ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m112[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m112[0m     const input: LayoutInput = {
    [7m   [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m149[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m149[0m     const input1: LayoutInput = { value: 'Test', style: style1, width: 100 };
    [7m   [0m [91m          ~~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m150[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m150[0m     const input2: LayoutInput = { value: 'Test', style: style2, width: 100 };
    [7m   [0m [91m          ~~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m151[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m151[0m     const input3: LayoutInput = { value: 'Test', style: style3, width: 100 };
    [7m   [0m [91m          ~~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m175[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m175[0m     const input: LayoutInput = { value: 'Test', style, width: 100 };
    [7m   [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m188[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m188[0m     const input: LayoutInput = { value: '', style, width: 100 };
    [7m   [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m203[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m203[0m     const input: LayoutInput = { value: 'Test', style, width: 100 };
    [7m   [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m211[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m211[0m     const input: LayoutInput = {
    [7m   [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.

PASS packages/core/__tests__/let.test.ts
PASS packages/core/__tests__/bycol.test.ts
FAIL packages/core/__tests__/ChartBuilderController.test.ts
  ‚óè Test suite failed to run

    [96mpackages/core/__tests__/ChartBuilderController.test.ts[0m:[93m9[0m:[93m27[0m - [91merror[0m[90m TS2307: [0mCannot find module '@cyber-sheet/core' or its corresponding type declarations.

    [7m9[0m import { Worksheet } from '@cyber-sheet/core';
    [7m [0m [91m                          ~~~~~~~~~~~~~~~~~~~[0m

PASS packages/renderer-canvas/__tests__/chart-data-callback-manager.test.ts
FAIL packages/renderer-canvas/__tests__/trendline-calculator.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/src/TrendlineCalculator.ts[0m:[93m8[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'TrendlineType'.

    [7m8[0m import type { TrendlineType, TrendlineResult } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/TrendlineCalculator.ts[0m:[93m8[0m:[93m30[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'TrendlineResult'.

    [7m8[0m import type { TrendlineType, TrendlineResult } from '@cyber-sheet/core';
    [7m [0m [91m                             ~~~~~~~~~~~~~~~[0m

FAIL packages/renderer-canvas/__tests__/axis-scaler.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/axis-scaler.test.ts[0m:[93m9[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AxisScale'.

    [7m9[0m import type { AxisScale, AxisBounds, AxisConfig } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~[0m
    [96mpackages/renderer-canvas/__tests__/axis-scaler.test.ts[0m:[93m9[0m:[93m26[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AxisBounds'.

    [7m9[0m import type { AxisScale, AxisBounds, AxisConfig } from '@cyber-sheet/core';
    [7m [0m [91m                         ~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/__tests__/axis-scaler.test.ts[0m:[93m9[0m:[93m38[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AxisConfig'.

    [7m9[0m import type { AxisScale, AxisBounds, AxisConfig } from '@cyber-sheet/core';
    [7m [0m [91m                                     ~~~~~~~~~~[0m

FAIL packages/renderer-canvas/__tests__/chart-data-adapter.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/chart-data-adapter.test.ts[0m:[93m9[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'CellRange'.

    [7m9[0m import type { CellRange } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~[0m

FAIL packages/renderer-canvas/__tests__/chart-engine-integration.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m14[0m:[93m3[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ExtendedChartType'.

    [7m14[0m   ExtendedChartType,
    [7m  [0m [91m  ~~~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m15[0m:[93m3[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AdvancedChartOptions'.

    [7m15[0m   AdvancedChartOptions,
    [7m  [0m [91m  ~~~~~~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m16[0m:[93m3[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'TrendlineConfig'.

    [7m16[0m   TrendlineConfig,
    [7m  [0m [91m  ~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m17[0m:[93m3[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AxisConfig'.

    [7m17[0m   AxisConfig,
    [7m  [0m [91m  ~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m18[0m:[93m3[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ComboChartConfig'.

    [7m18[0m   ComboChartConfig
    [7m  [0m [91m  ~~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m176[0m:[93m33[0m - [91merror[0m[90m TS7006: [0mParameter 'point' implicitly has an 'any' type.

    [7m176[0m       trendline.points.forEach((point, idx) => {
    [7m   [0m [91m                                ~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m176[0m:[93m40[0m - [91merror[0m[90m TS7006: [0mParameter 'idx' implicitly has an 'any' type.

    [7m176[0m       trendline.points.forEach((point, idx) => {
    [7m   [0m [91m                                       ~~~[0m

PASS packages/core/__tests__/formulaEngine.test.ts
FAIL packages/renderer-canvas/__tests__/chart-renderer.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/chart-renderer.test.ts[0m:[93m8[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ChartObject'.

    [7m8[0m import type { ChartObject } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~~~[0m

FAIL packages/renderer-canvas/__tests__/phase1-ui-performance.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/phase1-ui-performance.test.ts[0m:[93m22[0m:[93m13[0m - [91merror[0m[90m TS2554: [0mExpected 1-5 arguments, but got 0.

    [7m22[0m     sheet = new Worksheet();
    [7m  [0m [91m            ~~~~~~~~~~~~~~~[0m

      [96mpackages/core/src/worksheet.ts[0m:[93m23[0m:[93m15[0m
        [7m23[0m   constructor(name: string, rows = 1000, cols = 26, engine?: IFormulaEngine, workbook?: any) {
        [7m  [0m [96m              ~~~~~~~~~~~~[0m
        An argument for 'name' was not provided.
    [96mpackages/renderer-canvas/__tests__/phase1-ui-performance.test.ts[0m:[93m53[0m:[93m15[0m - [91merror[0m[90m TS2551: [0mProperty 'setCell' does not exist on type 'Worksheet'. Did you mean 'getCell'?

    [7m53[0m         sheet.setCell({ row, col }, {
    [7m  [0m [91m              ~~~~~~~[0m

      [96mpackages/core/src/worksheet.ts[0m:[93m35[0m:[93m3[0m
        [7m35[0m   getCell(addr: Address): Cell | undefined {
        [7m  [0m [96m  ~~~~~~~[0m
        'getCell' is declared here.
    [96mpackages/renderer-canvas/__tests__/phase1-ui-performance.test.ts[0m:[93m109[0m:[93m15[0m - [91merror[0m[90m TS2551: [0mProperty 'setCell' does not exist on type 'Worksheet'. Did you mean 'getCell'?

    [7m109[0m         sheet.setCell({ row, col }, {
    [7m   [0m [91m              ~~~~~~~[0m

      [96mpackages/core/src/worksheet.ts[0m:[93m35[0m:[93m3[0m
        [7m35[0m   getCell(addr: Address): Cell | undefined {
        [7m  [0m [96m  ~~~~~~~[0m
        'getCell' is declared here.
    [96mpackages/renderer-canvas/__tests__/phase1-ui-performance.test.ts[0m:[93m160[0m:[93m15[0m - [91merror[0m[90m TS2551: [0mProperty 'setCell' does not exist on type 'Worksheet'. Did you mean 'getCell'?

    [7m160[0m         sheet.setCell({ row, col }, {
    [7m   [0m [91m              ~~~~~~~[0m

      [96mpackages/core/src/worksheet.ts[0m:[93m35[0m:[93m3[0m
        [7m35[0m   getCell(addr: Address): Cell | undefined {
        [7m  [0m [96m  ~~~~~~~[0m
        'getCell' is declared here.

FAIL packages/renderer-canvas/__tests__/chart-interaction-manager.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/src/ChartInteractionManager.ts[0m:[93m10[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ChartObject'.

    [7m10[0m import type { ChartObject } from '@cyber-sheet/core';
    [7m  [0m [91m              ~~~~~~~~~~~[0m

(node:75036) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL packages/core/test/benchmarks/styleCache.stress.bench.test.ts (16.342 s)
  ‚óè Console

    console.log
      
      [1M Typical] Starting 1M cell simulation...

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:40:13)

    console.log
      [1M Typical] Expected unique styles: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:41:13)

    console.log
      [1M Typical] 200000 cells: 1580ms, hit rate: 99.99%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:55:17)

    console.log
      [1M Typical] 400000 cells: 2808ms, hit rate: 99.99%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:55:17)

    console.log
      [1M Typical] 600000 cells: 3847ms, hit rate: 100.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:55:17)

    console.log
      [1M Typical] 800000 cells: 4967ms, hit rate: 100.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:55:17)

    console.log
      
      [1M Typical] Complete:

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:67:13)

    console.log
        Total time: 6370.25ms (6.37s)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:68:13)

    console.log
        Avg intern: 5.881¬µs

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:69:13)

    console.log
        Hit rate: 100.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:70:13)

    console.log
        Cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:71:13)

    console.log
        Max bucket depth: 1

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:72:13)

    console.log
        Collision rate: 0.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:73:13)

    console.log
        Memory delta: 58.41 MB

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:74:13)

    console.log
        Throughput: 157K interns/sec

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:75:13)

    console.log
      
      [MultiSheet] Starting 10-sheet simulation...

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:129:13)

    console.log
      [MultiSheet] Expected unique styles: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:130:13)

    console.log
      [MultiSheet] Sheet 1/10: 509ms, cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:149:15)

    console.log
      [MultiSheet] Sheet 2/10: 821ms, cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:149:15)

    console.log
      [MultiSheet] Sheet 3/10: 1294ms, cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:149:15)

    console.log
      [MultiSheet] Sheet 4/10: 1722ms, cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:149:15)

    console.log
      [MultiSheet] Sheet 5/10: 2440ms, cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:149:15)

    console.log
      [MultiSheet] Sheet 6/10: 2871ms, cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:149:15)

    console.log
      [MultiSheet] Sheet 7/10: 3353ms, cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:149:15)

    console.log
      [MultiSheet] Sheet 8/10: 3797ms, cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:149:15)

    console.log
      [MultiSheet] Sheet 9/10: 4118ms, cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:149:15)

    console.log
      [MultiSheet] Sheet 10/10: 4396ms, cache size: 24

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:149:15)

    console.log
      
      [MultiSheet] Complete:

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:159:13)

    console.log
        Total time: 4396.70ms (4.40s)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:160:13)

    console.log
        Total cells: 1000000

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:161:13)

    console.log
        Hit rate: 100.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:162:13)

    console.log
        Cache size: 24 (expected: 24)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:163:13)

    console.log
        Cross-sheet dedup: 100.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:164:13)

    console.log
        Memory delta: 25.45 MB

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:165:13)

    console.log
      [MultiSheet] ‚úÖ All performance gates passed (cross-sheet dedup verified)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:176:13)

    console.log
      [MultiSheet] ‚úÖ Structural memory gates passed (no leaks)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:192:13)

    console.log
      [MultiSheet]    - Cache size: 0 ‚úì

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:193:13)

    console.log
      [MultiSheet]    - Bucket count: 0 ‚úì

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:194:13)

    console.log
      
      [Designer] Starting 500k cell simulation (high diversity)...

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:205:13)

    console.log
      [Designer] 100000 cells: 494ms, hit rate: 95.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:218:17)

    console.log
      [Designer] 200000 cells: 973ms, hit rate: 97.50%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:218:17)

    console.log
      [Designer] 300000 cells: 1444ms, hit rate: 98.33%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:218:17)

    console.log
      [Designer] 400000 cells: 1918ms, hit rate: 98.75%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:218:17)

    console.log
      
      [Designer] Complete:

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:230:13)

    console.log
        Total time: 2396.29ms (2.40s)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:231:13)

    console.log
        Avg intern: 4.575¬µs

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:232:13)

    console.log
        Hit rate: 99.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:233:13)

    console.log
        Cache size: 5000

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:234:13)

    console.log
        Max bucket depth: 1

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:235:13)

    console.log
        Collision rate: 0.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:236:13)

    console.log
        Memory delta: 50.38 MB

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:237:13)

    console.log
      [Designer] ‚úÖ All performance gates passed (high diversity validated)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:257:13)

    console.log
      [Designer] ‚úÖ Structural memory gates passed (no leaks)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:271:13)

    console.log
      [Designer]    - Cache size: 0 ‚úì

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:272:13)

    console.log
      [Designer]    - Bucket count: 0 ‚úì

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:273:13)

    console.log
      
      [Pathological] Starting 100k unique styles (worst-case)...

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:283:13)

    console.log
      [Pathological] 20000 cells: 49ms, cache size: 20001

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:300:17)

    console.log
      [Pathological] 40000 cells: 106ms, cache size: 40001

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:300:17)

    console.log
      [Pathological] 60000 cells: 162ms, cache size: 60001

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:300:17)

    console.log
      [Pathological] 80000 cells: 226ms, cache size: 80001

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:300:17)

    console.log
      
      [Pathological] Complete:

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:312:13)

    console.log
        Total time: 285.99ms (0.29s)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:313:13)

    console.log
        Avg intern: 2.574¬µs

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:314:13)

    console.log
        Hit rate: 0.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:315:13)

    console.log
        Cache size: 100000

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:316:13)

    console.log
        Max bucket depth: 1

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:317:13)

    console.log
        Collision rate: 0.00%

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:318:13)

    console.log
        Memory delta: 56.70 MB

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:319:13)

    console.log
      [Pathological] ‚úÖ Graceful degradation verified (no catastrophic failure)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:336:13)

    console.log
      [Pathological] Releasing 100k styles...

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:339:13)

    console.log
      [Pathological] ‚úÖ Structural memory gates passed (cleanup: 136ms)

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:352:13)

    console.log
      [Pathological]    - Cache size: 0 ‚úì

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:353:13)

    console.log
      [Pathological]    - Bucket count: 0 ‚úì

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:354:13)

  ‚óè StyleCache Final Stress Test (Production Scale) ‚Ä∫ 1M cells, typical enterprise patterns (50 unique styles)

    expect(received).toBeLessThan(expected)

    Expected: < 5000
    Received:   6370.253398

      76 |     
      77 |     // Gate: Performance <5s
    > 78 |     expect(elapsed).toBeLessThan(5000);
         |                     ^
      79 |     
      80 |     // Gate: Avg intern <5¬µs
      81 |     expect(avgIntern).toBeLessThan(0.005);

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:78:21)

------------------------------------------|---------|----------|---------|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
File                                      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
------------------------------------------|---------|----------|---------|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
All files                                 |   62.16 |    51.98 |   61.36 |   65.64 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/__tests__/excel-oracle              |   75.37 |    18.18 |   76.92 |    78.4 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  oracle-test-data.ts                     |   75.37 |    18.18 |   76.92 |    78.4 | 38-78,230-246,300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
 core/src                                 |   60.77 |    55.49 |    48.5 |   63.45 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  CFDirtyPropagationEngine.ts             |   94.73 |        0 |     100 |     100 | 28                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
  CellLayout.ts                           |   34.09 |       20 |      20 |   34.88 | 66-85,99-102,149,169-203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
  CollaborationEngine.ts                  |    0.75 |        0 |       0 |    0.78 | 52-492                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
  CommandManager.ts                       |   76.71 |    16.66 |   61.53 |   77.27 | 65-76,222,263-296,309                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  ConditionalFormattingBatchEngine.ts     |    89.8 |    65.07 |   96.15 |    93.1 | 174,209-210,256-261,344,412,431,434,473                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  ConditionalFormattingDependencyGraph.ts |   91.37 |    78.12 |     100 |   92.72 | 171-172,275-277,333-339                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  ConditionalFormattingEngine.ts          |   69.97 |    70.38 |   88.57 |   74.22 | 389,396,461-463,477-489,517-537,555-575,601,619,627,680,700,712-746,798,812-813,895-897,953,961,972-979,988-1006,1012-1020,1056-1062,1070,1076,1099                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  ConditionalFormattingFormulaCompiler.ts |   77.94 |    69.56 |   66.66 |      80 | 83-90,301-311,354-355,368-369,374-375                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  ConditionalFormattingStrategies.ts      |   86.11 |    70.37 |   83.33 |    88.8 | 88,99,107,137,292-293,331,381-384,423-430,465-468                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  ErrorStrategyDispatcher.ts              |    69.9 |    67.46 |     100 |   69.15 | 230,278,306-307,313,325-326,331,343-344,349,365,371-372,381-385,393-402,409-413,423-432,442-445,452-461,467,470-473,486-487,503-504,561,564,586-587,596,617                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  ExcelColor.ts                           |   15.48 |     2.63 |   16.66 |   17.26 | 182-210,219-242,259-278,313-358,380-406,417-424,440-471,481-488,498-504,519-521                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  FormulaController.ts                    |    2.38 |        0 |       0 |     2.7 | 26-235                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
  FormulaEngine.ts                        |   80.62 |    73.97 |   56.81 |   82.65 | 55-102,138,149,206-212,275-283,288,361,460,468-473,479-491,509,517,521,540,565,628,639,725,797-799,863,894,924-932,1065,1110,1145,1158,1212,1227,1329-1330,1354,1380-1484                                                                                                                                                                                                                                                                                                                                                                                                                                                              
  I18nManager.ts                          |    4.25 |        0 |       0 |    4.25 | 275-439                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  PivotEngine.ts                          |    0.96 |        0 |       0 |    1.21 | 46-276                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
  RangeStatsManager.ts                    |   86.56 |    91.66 |   78.94 |   85.48 | 76-80,89,113,126,136-139                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
  SpillEngine.ts                          |    98.9 |     92.1 |     100 |   98.73 | 62                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
  StatisticalCacheManager.ts              |   91.21 |    85.41 |   93.75 |   91.04 | 182-190,354-358,411-414                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  StyleCache.ts                           |   86.44 |    68.93 |      95 |   89.04 | 144-145,161-162,181-183,236-244,370,393-396,502,622-624                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  VersionManager.ts                       |   16.86 |        0 |   10.52 |   18.91 | 53-152,294-317,334-376                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
  events.ts                               |    37.5 |      100 |      40 |      50 | 7-12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
  fillPatterns.ts                         |    1.47 |        0 |       0 |    2.04 | 19-98                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  metadata-api.ts                         |    42.3 |        0 |       0 |      50 | 77-81,102-103,121,138-150,167,183,200,219,235,254-259,315-326                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  workbook.ts                             |   54.54 |       20 |    37.5 |    64.7 | 23-31                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  worksheet.ts                            |   11.89 |     9.32 |   13.46 |   14.09 | 32,85-505                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
 core/src/autocomplete                    |    1.54 |        0 |       0 |    1.08 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  FormulaAutocomplete.ts                  |    0.52 |        0 |       0 |    0.54 | 50-426                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
  index.ts                                |     100 |      100 |       0 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/formatting                      |   88.09 |    69.35 |     100 |   88.09 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  NumberFormatSpec.ts                     |   95.83 |    64.51 |     100 |   95.83 | 175                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  NumberFormatter.ts                      |      85 |    74.19 |     100 |      85 | 140-144,169,204,234,264,292                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
 core/src/functions                       |   71.42 |      100 |     100 |   71.42 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  function-initializer.ts                 |   71.42 |      100 |     100 |   71.42 | 484-495                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
 core/src/functions/array                 |   80.28 |    71.89 |   64.86 |   83.58 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  array-functions.ts                      |   80.25 |    71.89 |   64.86 |   83.55 | 16-25,98,140,269,301,303,305,310-313,320,361,363,365,370-374,469-470,483,575,625,651,870-873,927,944-954,962-972,979-983,990-993,1000-1003,1010-1030,1037-1057,1064-1065,1072-1073,1096-1114                                                                                                                                                                                                                                                                                                                                                                                                                                           
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/functions/database              |    86.9 |     66.1 |     100 |   90.65 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  database-functions.ts                   |   86.85 |     66.1 |     100 |   90.62 | 23,41,59,72,136-140,142,161,210,271,317,322,380,438,485,490,546,603,651,656,711,716,771,776                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/functions/datetime              |   65.71 |    41.79 |   72.72 |   66.48 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  datetime-functions.ts                   |   65.57 |    41.79 |   72.72 |   66.31 | 103,246-264,271-280,323-353,401-421,428-436,443-455                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/functions/engineering           |   45.96 |    36.84 |   45.65 |   48.43 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  engineering-functions.ts                |   45.85 |    36.84 |   45.65 |    48.3 | 141,169,177,182,200,228,236,241,259,263,463-488,504-528,544-568,584-616,632-662,675,713,894-906,929-940,964-976,1000-1018,1042-1069,1092,1115-1125,1149-1166,1189-1199,1222-1231,1253-1262,1284-1293,1315-1321,1344-1348,1371-1375,1398-1404,1426-1435,1457-1466,1488-1492,1514-1518                                                                                                                                                                                                                                                                                                                                                   
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/functions/exotic                |   31.08 |        0 |       0 |   19.04 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  exotic-functions.ts                     |   30.13 |        0 |       0 |   17.74 | 26-52,69-96,114-126,142-155,179-190,210-220,235-245,262-266,282-286,299-303,313                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/functions/financial             |   55.13 |    36.45 |   80.28 |   61.03 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  financial-functions.ts                  |   53.83 |    36.45 |   66.66 |   59.67 | 95-105,260,331,397,430,437-442,487-496,531,538-543,595,651-654,671,691-692,711,728,746-759,783,801-822,840-861,889,919,925,945-960,981-1035,1056-1109,1146,1154,1206,1214,1264,1276,1298,1311,1350,1383,1472,1546,1550,1592,1613,1654-1730,1760-1828,1859-1936,1961-2013,2042-2133                                                                                                                                                                                                                                                                                                                                                     
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/functions/functional            |   75.75 |      100 |      50 |      68 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  functional-functions.ts                 |   66.66 |      100 |       0 |      50 | 32,56,79,102,126,149,172,196                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/functions/information           |    95.8 |    94.01 |     100 |   95.39 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  information-functions.ts                |   95.39 |    94.01 |     100 |   94.89 | 27,171,392,411,515,537,568                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 core/src/functions/logical               |   73.37 |    65.47 |   71.42 |   71.64 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  logical-functions.ts                    |   73.21 |    65.47 |   71.42 |   71.42 | 52-72,79-99,130,159,166,192,219-223,243,348-349,374-375                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
 core/src/functions/lookup                |   82.59 |    75.74 |   83.33 |   84.67 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  lookup-functions.ts                     |   82.56 |    75.74 |   83.33 |   84.64 | 21-61,142,186,206,245,271,285-287,338,399-403,576-579,589-590,670,677-727,828,835,951,1014,1023                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/functions/math                  |   53.93 |    41.86 |   45.71 |   57.95 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  math-functions.ts                       |   53.86 |    41.86 |   45.71 |   57.87 | 126,164-171,178-185,218-220,227-233,240-249,256-262,292,322-324,331-333,340-342,349-352,359-362,369-371,378-384,391-393,400-402,409-411,418-425,432-434,441-450,457-466,473-481,488-500,507-518,525-539,546-570,957,966-967,973,979-985,997-1001,1010-1020,1033-1108,1151,1156,1162,1175,1230,1237,1250                                                                                                                                                                                                                                                                                                                                
 core/src/functions/metadata              |   99.57 |        0 |     100 |   99.57 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  array-metadata.ts                       |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  datetime-metadata.ts                    |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  financial-metadata.ts                   |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  index.ts                                |    92.3 |        0 |     100 |    92.3 | 89                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
  information-metadata.ts                 |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  logical-metadata.ts                     |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  lookup-metadata.ts                      |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  math-metadata.ts                        |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  statistical-metadata.ts                 |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  text-metadata.ts                        |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/functions/statistical           |   61.06 |    45.51 |   52.17 |    66.2 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  regression-functions.ts                 |    3.18 |        0 |       0 |    2.51 | 21-151,188-287,326-368,400-492                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  statistical-functions.ts                |   68.43 |    51.12 |   60.75 |   74.09 | 86,139,153,169,179,203-229,266,286-300,308,350-373,387-396,410-419,427,434-451,458-482,489-499,506-516,523-541,553,573-626,646-704,711,718-719,747,773,809,1301,1330,1350,1367,1412-1415,1439-1460,1487-1489,1529,1552,1596-1597,1607-1608,1653-1660,1865,1941,2095-2099,2121-2133,2154-2166,2185-2198,2217-2230,2249-2262,2281-2294,2320-2332,2354-2363,2386-2401,2424-2438,2462-2469,2493-2497,2542,2604,2608,2814,2865,2901-2963,3086,3105-3107,3156,3219,3293-3298,3334,3367,3385-3387,3413,3541,3545,3592,3610-3611,3623,3639-3643,3827,3831,3878,3909-3921,3934,3949-3954,3964-3969,4005,4039,4043,4062,4080-4085,4133,4145,4159 
 core/src/functions/text                  |   71.56 |    50.44 |   78.78 |   78.71 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  text-functions.ts                       |   71.52 |    50.44 |   78.78 |   78.68 | 19,83,141,206,222,394-395,414,542-543,590,597,630-631,684,715,739-744,751-757,764-772,1119,1233-1272,1306-1364,1398-1456                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
 core/src/functions/web                   |   15.27 |        0 |      50 |   12.69 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  index.ts                                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  web-functions.ts                        |   10.29 |        0 |       0 |    6.77 | 39-46,77-103,139-225                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
 core/src/operators                       |    21.9 |     4.16 |   30.76 |   26.74 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  operators.ts                            |    21.9 |     4.16 |   30.76 |   26.74 | 29-78,101-133,150-156,202-234,246-249,256                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
 core/src/parser                          |   58.69 |    42.85 |    61.9 |   58.31 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  ExpressionParser.ts                     |   50.26 |    37.68 |    64.7 |   49.69 | 39,51,112-140,148-166,213-242,249,256,284-285,301-303,317,337-401                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  ReferenceParser.ts                      |   88.05 |    38.09 |   54.54 |   90.32 | 35,95,124,153,181,191                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  TokenParser.ts                          |   56.75 |    49.29 |   64.28 |   54.81 | 132,189-190,211-231,242-345,352                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/registry                        |   25.26 |       25 |    23.8 |   26.08 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  FunctionRegistry.ts                     |   25.26 |       25 |    23.8 |   26.08 | 94,120-157,172-320,332-338,345,352                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
 core/src/types                           |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  formula-types.ts                        |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 core/src/utils                           |   71.47 |    67.07 |   56.75 |   74.87 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  array-utils.ts                          |   29.35 |    16.12 |    12.5 |   34.09 | 57,64-72,80-91,99-114,122-132,139-146,154-163,170-178,185-190,198-204,212-223                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  criteria-utils.ts                       |   84.78 |     87.5 |     100 |   84.78 | 37,44,55,94,100,121,136                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  formula-live-preview.ts                 |   81.25 |    67.08 |   78.57 |   83.47 | 37,41,45,67,87,117-130,219,231-232,245,277-280,361                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
  formula-syntax-highlighter.ts           |   97.22 |    80.76 |     100 |   98.46 | 166                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  formula-tokenizer.ts                    |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  type-utils.ts                           |   60.86 |    54.73 |      50 |   66.66 | 15,23,31,39,47,81,101,130-139,159-162,167,175,184-200,219,233                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  validation-utils.ts                     |   24.52 |        0 |      10 |      26 | 19-27,34-42,49-57,68-71,79,88-91,98-101,111-114,124-127,134-139                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
 io-xlsx/src                              |   32.36 |    34.03 |   30.33 |   32.07 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  CommentParser.ts                        |    1.65 |        0 |       0 |    1.69 | 35-286                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
  LightweightParser.ts                    |    0.99 |        0 |       0 |    1.04 | 98-470,478-802                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  export.ts                               |   76.74 |    66.66 |   90.47 |   78.14 | 70-72,162-163,168-169,235-236,248-250,256-267,312,314,345-360                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  import.ts                               |    5.17 |        0 |       0 |    5.55 | 57-161,172-293,313-347,368-376                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  index.ts                                |   63.25 |    56.81 |    42.1 |   67.51 | 16-20,46,66-69,107-108,110,115-116,145,190-192,209-216,227-241,278-279,310-316,325-374                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
 renderer-canvas/src                      |   66.44 |    52.47 |   79.36 |   71.87 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  CanvasCache.ts                          |   98.76 |      100 |   95.45 |   98.76 | 381                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  CanvasRenderer.ts                       |   12.21 |     5.01 |   10.84 |   15.69 | 71-110,139-140,145-152,159-218,224-376,383-384,410-412,415-417,437-449,482-486,494-500,508-846,853-855,860-868,882-1027,1032-1036,1042-1078,1083-1112,1120-1149,1160-1293                                                                                                                                                                                                                                                                                                                                                                                                                                                              
  ChartAccessibilityManager.ts            |   73.56 |    52.63 |   81.25 |   76.22 | 223-224,231,318-323,362-367,494-529,541-542,564-565,573-578,652,666,731-736                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  ChartAnimationEngine.ts                 |   86.47 |    76.69 |   91.37 |   87.89 | 112-114,122-133,146,160-162,261,273,308-309                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  ChartAnimationIntegration.ts            |   95.55 |    88.23 |     100 |   95.45 | 90,193,198,234                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  ChartDataCallbackManager.ts             |   92.66 |    79.62 |   96.15 |   93.05 | 204,222,228,420-425,430,442,466                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  ChartDataStreamManager.ts               |   93.66 |    84.93 |   92.85 |   94.77 | 142-143,189,276,299,431-432                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  ChartDualAxisManager.ts                 |   97.41 |    92.15 |     100 |   97.27 | 294,388,423                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  ChartEngine.ts                          |   99.15 |    91.07 |   98.64 |   99.41 | 398,1296-1297,1309                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
  ChartExporter.ts                        |    89.6 |    70.42 |     100 |   89.51 | 312,349,353,365,433,458,511,530,549,575,603,626,681                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  ChartInteractionEnhancer.ts             |   68.16 |    66.38 |    77.5 |   69.08 | 232-236,241-251,256-258,277-281,285-286,293,302-329,421-422,442,501-530,547-568,577-594,713                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  ChartRendererPlugin.ts                  |      97 |     82.5 |     100 |   96.87 | 174-176                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  FormatCache.ts                          |   71.42 |    60.83 |   70.58 |   75.91 | 48-79,126-131,162,220-221,223-224                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  PerformanceMonitor.ts                   |   92.17 |    58.06 |   96.55 |   92.38 | 234,262-264,349,351,436-437                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  TextMeasureCache.ts                     |   27.27 |       50 |      25 |   33.33 | 5-13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
  Theme.ts                                |   72.72 |        0 |   33.33 |      80 | 54,58                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  error-highlighter.ts                    |   98.38 |       80 |      90 |   98.36 | 225                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  error-solutions.ts                      |     100 |     92.3 |     100 |     100 | 229                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  error-tooltip.ts                        |   66.66 |    35.13 |   82.35 |   67.59 | 122,138-157,170,226-278,313-314                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
------------------------------------------|---------|----------|---------|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Summary of all failing tests
FAIL packages/core/test/CellLayout.test.ts
  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ single-line text ‚Ä∫ should align to top when valign is "top"

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      14 |       it('should align to top when valign is "top"', () => {
      15 |         const offset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 16 |         expect(offset).toBe(paddingTop);
         |                        ^
      17 |       });
      18 |
      19 |       it('should align to middle when valign is "middle"', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:16:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ single-line text ‚Ä∫ should align to middle when valign is "middle"

    expect(received).toBe(expected) // Object.is equality

    Expected: 6
    Received: 17

      20 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      21 |         const expected = (cellHeight - contentHeight) / 2;
    > 22 |         expect(offset).toBe(expected);
         |                        ^
      23 |       });
      24 |
      25 |       it('should align to bottom when valign is "bottom"', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:22:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ single-line text ‚Ä∫ should align to bottom when valign is "bottom"

    expect(received).toBe(expected) // Object.is equality

    Expected: 8
    Received: 20

      26 |         const offset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      27 |         const expected = cellHeight - contentHeight - paddingBottom;
    > 28 |         expect(offset).toBe(expected);
         |                        ^
      29 |       });
      30 |
      31 |       it('should default to bottom when valign is undefined', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:28:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ single-line text ‚Ä∫ should default to bottom when valign is undefined

    expect(received).toBe(expected) // Object.is equality

    Expected: 8
    Received: 20

      32 |         const offset = computeVerticalOffset(undefined, cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      33 |         const expected = cellHeight - contentHeight - paddingBottom;
    > 34 |         expect(offset).toBe(expected);
         |                        ^
      35 |       });
      36 |     });
      37 |

      at Object.<anonymous> (test/CellLayout.test.ts:34:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ wrapped text (multi-line) ‚Ä∫ should align to top when valign is "top"

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      44 |       it('should align to top when valign is "top"', () => {
      45 |         const offset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 46 |         expect(offset).toBe(paddingTop);
         |                        ^
      47 |       });
      48 |
      49 |       it('should center multi-line content when valign is "middle"', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:46:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ wrapped text (multi-line) ‚Ä∫ should center multi-line content when valign is "middle"

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: 44

      50 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      51 |         const expected = (cellHeight - contentHeight) / 2;
    > 52 |         expect(offset).toBe(expected);
         |                        ^
      53 |       });
      54 |
      55 |       it('should align to bottom when valign is "bottom"', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:52:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ wrapped text (multi-line) ‚Ä∫ should align to bottom when valign is "bottom"

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 44

      56 |         const offset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      57 |         const expected = cellHeight - contentHeight - paddingBottom;
    > 58 |         expect(offset).toBe(expected);
         |                        ^
      59 |       });
      60 |     });
      61 |

      at Object.<anonymous> (test/CellLayout.test.ts:58:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ edge cases ‚Ä∫ should handle content taller than cell (no negative offset)

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      66 |         
      67 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 68 |         expect(topOffset).toBe(paddingTop);
         |                           ^
      69 |
      70 |         const middleOffset = computeVerticalOffset('middle', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      71 |         // When content > cell, middle produces negative offset, but still valid

      at Object.<anonymous> (test/CellLayout.test.ts:68:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ edge cases ‚Ä∫ should handle zero cell height

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      83 |
      84 |         const offset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 85 |         expect(offset).toBe(paddingTop);
         |                        ^
      86 |       });
      87 |
      88 |       it('should handle exact fit (content equals cell minus padding)', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:85:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ edge cases ‚Ä∫ should handle exact fit (content equals cell minus padding)

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      91 |
      92 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 93 |         expect(topOffset).toBe(paddingTop);
         |                           ^
      94 |
      95 |         const bottomOffset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      96 |         expect(bottomOffset).toBe(paddingTop); // Should equal top when exact fit

      at Object.<anonymous> (test/CellLayout.test.ts:93:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different cell dimensions ‚Ä∫ should handle standard Excel row height (20.25px)

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      120 |         
      121 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 122 |         expect(topOffset).toBe(paddingTop);
          |                           ^
      123 |
      124 |         const middleOffset = computeVerticalOffset('middle', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      125 |         expect(middleOffset).toBeCloseTo((cellHeight - contentHeight) / 2, 2);

      at Object.<anonymous> (test/CellLayout.test.ts:122:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different cell dimensions ‚Ä∫ should handle tall cells (e.g., merged or manually resized)

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      133 |         
      134 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 135 |         expect(topOffset).toBe(paddingTop);
          |                           ^
      136 |
      137 |         const middleOffset = computeVerticalOffset('middle', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
      138 |         expect(middleOffset).toBe((cellHeight - contentHeight) / 2);

      at Object.<anonymous> (test/CellLayout.test.ts:135:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different cell dimensions ‚Ä∫ should handle small cells

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 14

      147 |         const cellHeight = 10;
      148 |         const offset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 149 |         expect(offset).toBe(paddingTop);
          |                        ^
      150 |       });
      151 |     });
      152 |

      at Object.<anonymous> (test/CellLayout.test.ts:149:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different font sizes and padding ‚Ä∫ should handle large font size

    expect(received).toBe(expected) // Object.is equality

    Expected: 8
    Received: 31

      159 |
      160 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, largeFontSize, paddingTop, paddingBottom);
    > 161 |         expect(offset).toBe((cellHeight - contentHeight) / 2);
          |                        ^
      162 |       });
      163 |
      164 |       it('should handle small font size', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:161:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different font sizes and padding ‚Ä∫ should handle small font size

    expect(received).toBe(expected) // Object.is equality

    Expected: 16
    Received: 23

      167 |
      168 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, smallFontSize, paddingTop, paddingBottom);
    > 169 |         expect(offset).toBe((cellHeight - contentHeight) / 2);
          |                        ^
      170 |       });
      171 |
      172 |       it('should respect custom padding values', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:169:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different font sizes and padding ‚Ä∫ should respect custom padding values

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 22

      176 |
      177 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, customPaddingTop, customPaddingBottom);
    > 178 |         expect(topOffset).toBe(customPaddingTop);
          |                           ^
      179 |
      180 |         const bottomOffset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, customPaddingTop, customPaddingBottom);
      181 |         expect(bottomOffset).toBe(cellHeight - contentHeight - customPaddingBottom);

      at Object.<anonymous> (test/CellLayout.test.ts:178:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ different font sizes and padding ‚Ä∫ should handle zero padding

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: 12

      186 |
      187 |         const topOffset = computeVerticalOffset('top', cellHeight, contentHeight, fontSize, 0, 0);
    > 188 |         expect(topOffset).toBe(0);
          |                           ^
      189 |
      190 |         const bottomOffset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, 0, 0);
      191 |         expect(bottomOffset).toBe(cellHeight - contentHeight);

      at Object.<anonymous> (test/CellLayout.test.ts:188:27)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ Excel compatibility ‚Ä∫ should match Excel default alignment (bottom with Excel padding)

    expect(received).toBeCloseTo(expected, precision)

    Expected: 1.583333333333334
    Received: 16.666666666666664

    Expected precision:    2
    Expected difference: < 0.005
    Received difference:   15.08333333333333

      202 |         const offset = computeVerticalOffset(undefined, excelRowHeight, contentHeight, excelFontSize, 2, 4);
      203 |         const expected = excelRowHeight - contentHeight - 4;
    > 204 |         expect(offset).toBeCloseTo(expected, 2);
          |                        ^
      205 |       });
      206 |
      207 |       it('should match Excel middle alignment calculation', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:204:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ Excel compatibility ‚Ä∫ should match Excel middle alignment calculation

    expect(received).toBe(expected) // Object.is equality

    Expected: 9
    Received: 20

      211 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, 12, 2, 4);
      212 |         // Excel centers ignoring padding
    > 213 |         expect(offset).toBe((cellHeight - contentHeight) / 2);
          |                        ^
      214 |       });
      215 |     });
      216 |

      at Object.<anonymous> (test/CellLayout.test.ts:213:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ boundary conditions ‚Ä∫ should handle fractional pixel values

    expect(received).toBeCloseTo(expected, precision)

    Expected: 4.125
    Received: 15.625

    Expected precision:    2
    Expected difference: < 0.005
    Received difference:   11.5

      221 |
      222 |         const offset = computeVerticalOffset('middle', cellHeight, contentHeight, 12, 2, 4);
    > 223 |         expect(offset).toBeCloseTo((cellHeight - contentHeight) / 2, 2);
          |                        ^
      224 |       });
      225 |
      226 |       it('should handle very large cells', () => {

      at Object.<anonymous> (test/CellLayout.test.ts:223:24)

  ‚óè CellLayout - Vertical Alignment ‚Ä∫ computeVerticalOffset ‚Ä∫ boundary conditions ‚Ä∫ should handle very large cells

    expect(received).toBe(expected) // Object.is equality

    Expected: 984
    Received: 996

      229 |
      230 |         const bottomOffset = computeVerticalOffset('bottom', cellHeight, contentHeight, fontSize, paddingTop, paddingBottom);
    > 231 |         expect(bottomOffset).toBe(cellHeight - contentHeight - paddingBottom);
          |                              ^
      232 |         expect(bottomOffset).toBeGreaterThan(900);
      233 |       });
      234 |

      at Object.<anonymous> (test/CellLayout.test.ts:231:30)

FAIL packages/core/src/formatting/__tests__/NumberFormatter.test.ts
  ‚óè NumberFormatter ‚Ä∫ Performance: Precompiled Intl Formatters ‚Ä∫ should format single value in <0.5¬µs (target: <1¬µs)

    expect(received).toBeLessThan(expected)

    Expected: < 1
    Received:   1.456843999999819

      322 |       
      323 |       // Target: <1¬µs per call (achievable with precompiled formatters)
    > 324 |       expect(perCall).toBeLessThan(1.0);
          |                       ^
      325 |     });
      326 |   });
      327 |   

      at Object.<anonymous> (src/formatting/__tests__/NumberFormatter.test.ts:324:23)

  ‚óè NumberFormatter ‚Ä∫ Performance: Large Grid Fast Scroll ‚Ä∫ should handle mixed formats efficiently

    expect(received).toBeLessThan(expected)

    Expected: < 10
    Received:   23.52401400000008

      361 |       console.log(`  ‚è±Ô∏è  10,000 mixed formats: ${elapsed.toFixed(2)}ms`);
      362 |       
    > 363 |       expect(elapsed).toBeLessThan(10.0); // Allow slightly more time for mixed formats
          |                       ^
      364 |     });
      365 |   });
      366 |   

      at Object.<anonymous> (src/formatting/__tests__/NumberFormatter.test.ts:363:23)

FAIL packages/core/__tests__/error-strategy-enforcement.test.ts
  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.SKIP_ERRORS - Aggregations ‚Ä∫ Metadata: COUNT has SKIP_ERRORS strategy

    expect(received).toBeDefined()

    Received: undefined

      74 |     test('Metadata: COUNT has SKIP_ERRORS strategy', () => {
      75 |       const countMeta = STATISTICAL_METADATA.find(m => m.name === 'COUNT');
    > 76 |       expect(countMeta).toBeDefined();
         |                         ^
      77 |       expect(countMeta?.errorStrategy).toBe(ErrorStrategy.SKIP_ERRORS);
      78 |     });
      79 |

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:76:25)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.SKIP_ERRORS - Aggregations ‚Ä∫ Metadata: COUNTA has SKIP_ERRORS strategy

    expect(received).toBeDefined()

    Received: undefined

      80 |     test('Metadata: COUNTA has SKIP_ERRORS strategy', () => {
      81 |       const countaMeta = STATISTICAL_METADATA.find(m => m.name === 'COUNTA');
    > 82 |       expect(countaMeta).toBeDefined();
         |                          ^
      83 |       expect(countaMeta?.errorStrategy).toBe(ErrorStrategy.SKIP_ERRORS);
      84 |     });
      85 |

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:82:26)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.SKIP_ERRORS - Aggregations ‚Ä∫ Metadata: SUMIF has SKIP_ERRORS strategy

    expect(received).toBeDefined()

    Received: undefined

      104 |     test('Metadata: SUMIF has SKIP_ERRORS strategy', () => {
      105 |       const sumifMeta = MATH_METADATA.find(m => m.name === 'SUMIF');
    > 106 |       expect(sumifMeta).toBeDefined();
          |                         ^
      107 |       expect(sumifMeta?.errorStrategy).toBe(ErrorStrategy.SKIP_ERRORS);
      108 |     });
      109 |

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:106:25)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.SKIP_ERRORS - Aggregations ‚Ä∫ All SKIP_ERRORS functions are aggregations

    expect(received).toBeTruthy()

    Received: false

      132 |           'AVEDEV', 'DEVSQ', 'CORREL', 'PEARSON', 'COVARIANCE.P', 'COVARIANCE.S',
      133 |           'RSQ', 'STEYX', 'STDEVA', 'STDEVPA', 'VARA', 'VARPA', 'MAXA', 'MINA'
    > 134 |         ].some(name => func.name.toUpperCase().includes(name))).toBeTruthy();
          |                                                                 ^
      135 |       });
      136 |     });
      137 |   });

      at __tests__/error-strategy-enforcement.test.ts:134:65
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:125:23)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.LAZY_EVALUATION - Conditionals ‚Ä∫ Metadata: CHOOSE has LAZY_EVALUATION strategy

    expect(received).toBeDefined()

    Received: undefined

      174 |     test('Metadata: CHOOSE has LAZY_EVALUATION strategy', () => {
      175 |       const chooseMeta = LOGICAL_METADATA.find(m => m.name === 'CHOOSE');
    > 176 |       expect(chooseMeta).toBeDefined();
          |                          ^
      177 |       expect(chooseMeta?.errorStrategy).toBe(ErrorStrategy.LAZY_EVALUATION);
      178 |     });
      179 |

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:176:26)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.LAZY_EVALUATION - Conditionals ‚Ä∫ All LAZY_EVALUATION functions are conditionals

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 6
    Received:    5

      182 |       
      183 |       // Should have ~9 LAZY_EVALUATION functions
    > 184 |       expect(lazyFuncs.length).toBeGreaterThanOrEqual(6);
          |                                ^
      185 |       expect(lazyFuncs.length).toBeLessThanOrEqual(12);
      186 |       
      187 |       // All should be conditional-type functions

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:184:32)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.LOOKUP_STRICT - Lookup Functions ‚Ä∫ All 12 lookup functions have LOOKUP_STRICT strategy

    expect(received).toBe(expected) // Object.is equality

    Expected: 12
    Received: 7

      271 |       
      272 |       // Should have exactly 12 LOOKUP_STRICT functions
    > 273 |       expect(lookupStrictFuncs.length).toBe(12);
          |                                        ^
      274 |       
      275 |       // All should be in LOOKUP category
      276 |       lookupStrictFuncs.forEach(func => {

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:273:40)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy.PROPAGATE_FIRST - Standard Functions ‚Ä∫ PROPAGATE_FIRST is the most common strategy

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 150
    Received:    107

      370 |       
      371 |       // Should have ~178 PROPAGATE_FIRST functions (default behavior)
    > 372 |       expect(propagateFuncs.length).toBeGreaterThanOrEqual(150);
          |                                     ^
      373 |       expect(propagateFuncs.length).toBeLessThanOrEqual(200);
      374 |     });
      375 |   });

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:372:37)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy Distribution Consistency ‚Ä∫ LAZY_EVALUATION: All conditionals use this strategy

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 6
    Received:    5

      393 |       
      394 |       // Should be ~3% of total functions (9/279)
    > 395 |       expect(lazyFuncs.length).toBeGreaterThanOrEqual(6);
          |                                ^
      396 |       expect(lazyFuncs.length).toBeLessThanOrEqual(12);
      397 |     });
      398 |

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:395:32)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy Distribution Consistency ‚Ä∫ LOOKUP_STRICT: All lookup functions use this strategy

    expect(received).toBe(expected) // Object.is equality

    Expected: 12
    Received: 7

      409 |       
      410 |       // Should be ~4% of total functions (12/279)
    > 411 |       expect(lookupStrictFuncs.length).toBe(12);
          |                                        ^
      412 |     });
      413 |
      414 |     test('FINANCIAL_STRICT: ALL financial functions use this strategy', () => {

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:411:40)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy Distribution Consistency ‚Ä∫ PROPAGATE_FIRST: Most functions use this strategy

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 150
    Received:    107

      424 |       
      425 |       // Should be ~64% of total functions (178/279)
    > 426 |       expect(propagateFuncs.length).toBeGreaterThanOrEqual(150);
          |                                     ^
      427 |       expect(propagateFuncs.length).toBeLessThanOrEqual(200);
      428 |     });
      429 |   });

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:426:37)

  ‚óè Wave 0 Day 3: ErrorStrategy Enforcement ‚Ä∫ ErrorStrategy Enforcement: Summary

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 6
    Received:    5

      460 |     expect(skipErrors).toBeGreaterThanOrEqual(50);
      461 |     expect(skipErrors).toBeLessThanOrEqual(70);
    > 462 |     expect(lazyEval).toBeGreaterThanOrEqual(6);
          |                      ^
      463 |     expect(lazyEval).toBeLessThanOrEqual(12);
      464 |     expect(shortCircuit).toBe(2);
      465 |     expect(lookupStrict).toBe(12);

      at Object.<anonymous> (__tests__/error-strategy-enforcement.test.ts:462:22)

FAIL packages/core/__tests__/autocomplete/FormulaAutocomplete.test.ts
  ‚óè FormulaAutocomplete ‚Ä∫ Basic Autocomplete ‚Ä∫ getSuggestions returns suggestions for "SU"

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Basic Autocomplete ‚Ä∫ getSuggestions returns XLOOKUP for "XLOOK"

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Basic Autocomplete ‚Ä∫ getSuggestions returns FILTER for "FIL"

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Basic Autocomplete ‚Ä∫ getSuggestions handles empty input

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Basic Autocomplete ‚Ä∫ getSuggestions is case insensitive

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Match Types and Ranking ‚Ä∫ exact match has highest score

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Match Types and Ranking ‚Ä∫ startsWith match has high score

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Match Types and Ranking ‚Ä∫ contains match has medium score

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Match Types and Ranking ‚Ä∫ suggestions are sorted by match score

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Match Types and Ranking ‚Ä∫ startsWith is prioritized over contains

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Fuzzy Matching ‚Ä∫ fuzzy match for typo "XLOKUP" suggests XLOOKUP

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Fuzzy Matching ‚Ä∫ fuzzy match for "FITER" suggests FILTER

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Fuzzy Matching ‚Ä∫ fuzzy threshold controls strictness

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ suggestion includes function name

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ suggestion includes category

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ suggestion includes description

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ suggestion includes syntax

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ syntax includes argument information

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Suggestion Metadata ‚Ä∫ suggestion includes minArgs and maxArgs

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Filtering ‚Ä∫ includeCategory filters to specific categories

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Filtering ‚Ä∫ excludeCategory filters out specific categories

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Filtering ‚Ä∫ includeCategory with multiple categories

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Options and Limits ‚Ä∫ maxSuggestions limits results

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Options and Limits ‚Ä∫ default maxSuggestions is 10

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Options and Limits ‚Ä∫ maxSuggestions can return more than 10

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Browsing ‚Ä∫ getSuggestionsByCategory returns functions in category

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Browsing ‚Ä∫ getSuggestionsByCategory respects limit

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Category Browsing ‚Ä∫ getSuggestionsByCategory returns alphabetically sorted

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Common Use Cases ‚Ä∫ typing "=SU" suggests SUM family functions

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Common Use Cases ‚Ä∫ typing "=IF" suggests IF family functions

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Common Use Cases ‚Ä∫ typing "=XL" suggests XLOOKUP

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Common Use Cases ‚Ä∫ typing "=LAM" suggests LAMBDA

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Common Use Cases ‚Ä∫ typing "=DAT" suggests DATE functions

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Financial Functions Autocomplete ‚Ä∫ typing "=NP" suggests NPV or NPER

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Financial Functions Autocomplete ‚Ä∫ typing "=RATE" finds RATE function

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Financial Functions Autocomplete ‚Ä∫ all 13 financial functions are available

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Custom Descriptions ‚Ä∫ setDescription updates function description

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Custom Descriptions ‚Ä∫ setDescription is case insensitive

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Edge Cases ‚Ä∫ handles single character input

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Edge Cases ‚Ä∫ handles very long input

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Edge Cases ‚Ä∫ handles special characters gracefully

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Edge Cases ‚Ä∫ handles numeric input

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Performance ‚Ä∫ autocomplete completes within reasonable time

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

  ‚óè FormulaAutocomplete ‚Ä∫ Performance ‚Ä∫ handles large result sets efficiently

    TypeError: Cannot read properties of undefined (reading 'toUpperCase')

      70 |    */
      71 |   register(metadata: StrictFunctionMetadata): void {
    > 72 |     const upperName = metadata.name.toUpperCase();
         |                                     ^
      73 |
      74 |     // Store function handler
      75 |     this.functions.set(upperName, metadata.handler);

      at FunctionRegistry.toUpperCase [as register] (src/registry/FunctionRegistry.ts:72:37)
      at FunctionRegistry.register [as registerBatch] (src/registry/FunctionRegistry.ts:105:12)
      at registerBatch (src/functions/function-initializer.ts:483:12)
      at Object.<anonymous> (__tests__/autocomplete/FormulaAutocomplete.test.ts:19:29)

FAIL packages/renderer-canvas/__tests__/pipeline-performance.test.ts
  ‚óè Pipeline Performance: Formatting Stack ‚Ä∫ 10k Cell Formatting (Fast Scroll Simulation) ‚Ä∫ should format 10,000 mixed cells in <3.3ms (20% frame budget)

    expect(received).toBeLessThan(expected)

    Expected: < 3.3340000000000005
    Received:   25.0416409999998

      74 |       console.log(`   Status: ${formatTime < FORMAT_BUDGET_MS ? '‚úÖ PASS' : '‚ùå FAIL'}`);
      75 |       
    > 76 |       expect(formatTime).toBeLessThan(FORMAT_BUDGET_MS);
         |                          ^
      77 |     });
      78 |     
      79 |     it('should maintain <1¬µs per cell under mixed format load', () => {

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:76:26)

  ‚óè Pipeline Performance: Formatting Stack ‚Ä∫ 10k Cell Formatting (Fast Scroll Simulation) ‚Ä∫ should maintain <1¬µs per cell under mixed format load

    expect(received).toBeLessThan(expected)

    Expected: < 1
    Received:   5.816603000000032

      157 |       
      158 |       // Each cell should format in <1¬µs on average
    > 159 |       expect(perCellTime).toBeLessThan(1.0);
          |                           ^
      160 |     });
      161 |     
      162 |     it('should handle fast scroll simulation (10 frames)', () => {

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:159:27)

  ‚óè Pipeline Performance: Formatting Stack ‚Ä∫ Performance Regression Detection ‚Ä∫ should detect if spec-based formatter degrades to >1¬µs

    expect(received).toBeLessThan(expected)

    Expected: < 1
    Received:   2.151909999999771

      295 |       
      296 |       // If this fails, the spec-based formatter has regressed
    > 297 |       expect(perCellTime).toBeLessThan(1.0);
          |                           ^
      298 |     });
      299 |   });
      300 | });

      at Object.<anonymous> (__tests__/pipeline-performance.test.ts:297:27)

FAIL packages/core/__tests__/compatibility/excel-parity.test.ts
  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Week 3 - Text Advanced ‚Ä∫ WEEK3-TEXT-001: TEXTBEFORE delimiter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Week 3 - Text Advanced ‚Ä∫ WEEK3-TEXT-002: TEXTAFTER delimiter

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Week 3 - Web Functions ‚Ä∫ WEEK3-WEB-001: ENCODEURL with space

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Week 3 - Web Functions ‚Ä∫ WEEK3-WEB-002: ENCODEURL with special characters

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Week 3 - Web Functions ‚Ä∫ WEEK3-WEB-003: ENCODEURL with Unicode

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

  ‚óè Excel Parity - Compatibility Tests ‚Ä∫ Edge Cases - Boundaries ‚Ä∫ EDGE-BOUND-005: SUM with no arguments

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      113 |           }
      114 |
    > 115 |           expect(matches).toBe(true);
          |                           ^
      116 |         });
      117 |       });
      118 |     });

      at Object.<anonymous> (__tests__/compatibility/excel-parity.test.ts:115:27)

FAIL packages/core/__tests__/functions/statistical-week2-day3.test.ts
  ‚óè Statistical Functions - Week 2 Day 3 (Chi-Square) ‚Ä∫ CHISQ.TEST - Chi-Square Test ‚Ä∫ Oracle Test 1: Good fit (high p-value)

    expect(received).toBeGreaterThan(expected)

    Expected: > 0.5
    Received:   0.005089698416889221

      262 |       const result = evaluate('=CHISQ.TEST(A1:A5, B1:B5)');
      263 |       expect(typeof result).toBe('number');
    > 264 |       expect(result as number).toBeGreaterThan(0.5); // Good fit
          |                                ^
      265 |       expect(result as number).toBeLessThan(1);
      266 |     });
      267 |

      at Object.<anonymous> (__tests__/functions/statistical-week2-day3.test.ts:264:32)

  ‚óè Statistical Functions - Week 2 Day 3 (Chi-Square) ‚Ä∫ CHISQ.TEST - Chi-Square Test ‚Ä∫ Oracle Test 2: Poor fit (low p-value)

    expect(received).toBeLessThan(expected)

    Expected: < 0.1
    Received:   0.9842614960883287

      271 |       expect(typeof result).toBe('number');
      272 |       expect(result as number).toBeGreaterThan(0);
    > 273 |       expect(result as number).toBeLessThan(0.1); // Poor fit
          |                                ^
      274 |     });
      275 |
      276 |     test('Oracle Test 3: Perfect fit (p ‚âà 1)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-week2-day3.test.ts:273:32)

  ‚óè Statistical Functions - Week 2 Day 3 (Chi-Square) ‚Ä∫ CHISQ.TEST - Chi-Square Test ‚Ä∫ Oracle Test 3: Perfect fit (p ‚âà 1)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      277 |       // CHISQ.TEST with identical arrays
      278 |       const result = evaluate('=CHISQ.TEST(A1:A5, D1:D5)');
    > 279 |       expect(typeof result).toBe('number');
          |                             ^
      280 |       expect(result as number).toBeCloseTo(1, 1); // Perfect fit
      281 |     });
      282 |

      at Object.<anonymous> (__tests__/functions/statistical-week2-day3.test.ts:279:29)

  ‚óè Statistical Functions - Week 2 Day 3 (Chi-Square) ‚Ä∫ CHISQ.TEST - Chi-Square Test ‚Ä∫ Oracle Test 7: Calculation verification

    expect(received).toBeGreaterThan(expected)

    Expected: > 0.9
    Received:   0.005089698416889221

      314 |       const result = evaluate('=CHISQ.TEST(A1:A5, B1:B5)');
      315 |       expect(typeof result).toBe('number');
    > 316 |       expect(result as number).toBeGreaterThan(0.9); // High p-value
          |                                ^
      317 |     });
      318 |   });
      319 |

      at Object.<anonymous> (__tests__/functions/statistical-week2-day3.test.ts:316:32)

FAIL packages/core/__tests__/functions/datetime-fixes.test.ts
  ‚óè Date & Time Fixes - Week 7 Days 3-4 ‚Ä∫ Date Serial Number Fix (UTC-based) ‚Ä∫ TODAY returns correct day

    expect(received).toBe(expected) // Object.is equality

    Expected: 29
    Received: 17

      75 |       // This test assumes January 29, 2026
      76 |       const day = evaluate('=DAY(TODAY())');
    > 77 |       expect(day).toBe(29);
         |                   ^
      78 |     });
      79 |
      80 |     test('sequential dates are exactly 1 apart', () => {

      at Object.<anonymous> (__tests__/functions/datetime-fixes.test.ts:77:19)

  ‚óè Date & Time Fixes - Week 7 Days 3-4 ‚Ä∫ Integration: Date Serial + TIME Wrap ‚Ä∫ TODAY + wrapped TIME gives correct datetime

    expect(received).toBe(expected) // Object.is equality

    Expected: 29
    Received: 17

      278 |       const hour = evaluate(`=HOUR(${result})`);
      279 |
    > 280 |       expect(day).toBe(29); // Same day (wrapped time doesn't add days)
          |                   ^
      281 |       expect(hour).toBe(6); // 30 hours mod 24 = 6 AM
      282 |     });
      283 |

      at Object.<anonymous> (__tests__/functions/datetime-fixes.test.ts:280:19)

  ‚óè Date & Time Fixes - Week 7 Days 3-4 ‚Ä∫ Integration: Date Serial + TIME Wrap ‚Ä∫ NOW extraction works with both fixes

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      291 |
      292 |       expect(year).toBe(2026);
    > 293 |       expect(month).toBe(1);
          |                     ^
      294 |       expect(day).toBe(29);
      295 |     });
      296 |   });

      at Object.<anonymous> (__tests__/functions/datetime-fixes.test.ts:293:21)

FAIL packages/core/__tests__/functions/datetime-basic.test.ts (5.005 s)
  ‚óè Date & Time Functions - Basic ‚Ä∫ TODAY ‚Ä∫ extracting month from TODAY

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      235 |     test('extracting month from TODAY', () => {
      236 |       const result = evaluate('=MONTH(TODAY())');
    > 237 |       expect(result).toBe(1); // Current month (January)
          |                      ^
      238 |     });
      239 |
      240 |     test('extracting day from TODAY', () => {

      at Object.<anonymous> (__tests__/functions/datetime-basic.test.ts:237:22)

  ‚óè Date & Time Functions - Basic ‚Ä∫ TODAY ‚Ä∫ extracting day from TODAY

    expect(received).toBe(expected) // Object.is equality

    Expected: 29
    Received: 17

      241 |       const result = evaluate('=DAY(TODAY())');
      242 |       // Fixed: Should now return correct day (29) with UTC-based conversion
    > 243 |       expect(result).toBe(29);
          |                      ^
      244 |     });
      245 |   });
      246 |

      at Object.<anonymous> (__tests__/functions/datetime-basic.test.ts:243:22)

FAIL packages/core/__tests__/functions/financial-extended.test.ts (5.207 s)
  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT with quarterly compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      135 |       // 5% nominal compounded quarterly
      136 |       const result = evaluate('=EFFECT(0.05, 4)');
    > 137 |       expect(typeof result).toBe('number');
          |                             ^
      138 |       expect(result as number).toBeCloseTo(0.050945, 6); // ~5.0945%
      139 |     });
      140 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:137:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT with monthly compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      142 |       // 12% nominal compounded monthly
      143 |       const result = evaluate('=EFFECT(0.12, 12)');
    > 144 |       expect(typeof result).toBe('number');
          |                             ^
      145 |       expect(result as number).toBeCloseTo(0.126825, 6); // ~12.68%
      146 |     });
      147 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:144:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT with annual compounding

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NAME?]

      149 |       // Annual compounding = no change
      150 |       const result = evaluate('=EFFECT(0.05, 1)');
    > 151 |       expect(result).toBeCloseTo(0.05, 6);
          |                      ^
      152 |     });
      153 |
      154 |     test('EFFECT with daily compounding', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:151:22)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT with daily compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      155 |       // 10% nominal compounded daily (365 times)
      156 |       const result = evaluate('=EFFECT(0.10, 365)');
    > 157 |       expect(typeof result).toBe('number');
          |                             ^
      158 |       expect(result as number).toBeCloseTo(0.105156, 6); // ~10.52%
      159 |     });
      160 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:157:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT returns #NUM! for non-positive nominal rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      162 |       const result = evaluate('=EFFECT(-0.05, 4)');
      163 |       expect(result).toBeInstanceOf(Error);
    > 164 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      165 |     });
      166 |
      167 |     test('EFFECT returns #NUM! for npery < 1', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:164:41)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT returns #NUM! for npery < 1

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      168 |       const result = evaluate('=EFFECT(0.05, 0)');
      169 |       expect(result).toBeInstanceOf(Error);
    > 170 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      171 |     });
      172 |
      173 |     test('EFFECT truncates npery to integer', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:170:41)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ EFFECT (Effective Annual Rate) ‚Ä∫ EFFECT truncates npery to integer

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: expected value must be a number

    Expected has type:  object
    Expected has value: [Error: #NAME?]

      175 |       const result1 = evaluate('=EFFECT(0.05, 4.7)');
      176 |       const result2 = evaluate('=EFFECT(0.05, 4)');
    > 177 |       expect(result1).toBeCloseTo(result2 as number, 6);
          |                       ^
      178 |     });
      179 |   });
      180 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:177:23)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL with quarterly compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      183 |       // 5.0945% effective ‚Üí 5% nominal quarterly
      184 |       const result = evaluate('=NOMINAL(0.050945, 4)');
    > 185 |       expect(typeof result).toBe('number');
          |                             ^
      186 |       expect(result as number).toBeCloseTo(0.05, 4);
      187 |     });
      188 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:185:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL with monthly compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      190 |       // 12.68% effective ‚Üí 12% nominal monthly
      191 |       const result = evaluate('=NOMINAL(0.126825, 12)');
    > 192 |       expect(typeof result).toBe('number');
          |                             ^
      193 |       expect(result as number).toBeCloseTo(0.12, 4);
      194 |     });
      195 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:192:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL with annual compounding

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NAME?]

      197 |       // Annual compounding = no change
      198 |       const result = evaluate('=NOMINAL(0.05, 1)');
    > 199 |       expect(result).toBeCloseTo(0.05, 6);
          |                      ^
      200 |     });
      201 |
      202 |     test('NOMINAL with daily compounding', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:199:22)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL with daily compounding

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      203 |       // 10.52% effective ‚Üí 10% nominal daily
      204 |       const result = evaluate('=NOMINAL(0.105156, 365)');
    > 205 |       expect(typeof result).toBe('number');
          |                             ^
      206 |       expect(result as number).toBeCloseTo(0.10, 4);
      207 |     });
      208 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:205:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL returns #NUM! for non-positive effective rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      210 |       const result = evaluate('=NOMINAL(-0.05, 4)');
      211 |       expect(result).toBeInstanceOf(Error);
    > 212 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      213 |     });
      214 |
      215 |     test('NOMINAL returns #NUM! for npery < 1', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:212:41)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL returns #NUM! for npery < 1

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      216 |       const result = evaluate('=NOMINAL(0.05, 0)');
      217 |       expect(result).toBeInstanceOf(Error);
    > 218 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      219 |     });
      220 |
      221 |     test('NOMINAL truncates npery to integer', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:218:41)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ NOMINAL (Nominal Annual Rate) ‚Ä∫ NOMINAL truncates npery to integer

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: expected value must be a number

    Expected has type:  object
    Expected has value: [Error: #NAME?]

      223 |       const result1 = evaluate('=NOMINAL(0.050945, 4.7)');
      224 |       const result2 = evaluate('=NOMINAL(0.050945, 4)');
    > 225 |       expect(result1).toBeCloseTo(result2 as number, 6);
          |                       ^
      226 |     });
      227 |   });
      228 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:225:23)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ Integration: EFFECT and NOMINAL are inverses ‚Ä∫ EFFECT then NOMINAL returns original

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NAME?]

      234 |       const backToNominal = evaluate(`=NOMINAL(${effective}, ${npery})`) as number;
      235 |       
    > 236 |       expect(backToNominal).toBeCloseTo(nominal, 6);
          |                             ^
      237 |     });
      238 |
      239 |     test('NOMINAL then EFFECT returns original', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:236:29)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ Integration: EFFECT and NOMINAL are inverses ‚Ä∫ NOMINAL then EFFECT returns original

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NAME?]

      243 |       const backToEffective = evaluate(`=EFFECT(${nominal}, ${npery})`) as number;
      244 |       
    > 245 |       expect(backToEffective).toBeCloseTo(effective, 6);
          |                               ^
      246 |     });
      247 |   });
      248 |

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:245:31)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ Excel Compatibility ‚Ä∫ EFFECT matches Excel: =EFFECT(0.05, 4)

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NAME?]

      293 |     test('EFFECT matches Excel: =EFFECT(0.05, 4)', () => {
      294 |       const result = evaluate('=EFFECT(0.05, 4)');
    > 295 |       expect(result as number).toBeCloseTo(0.050945, 6);
          |                                ^
      296 |     });
      297 |
      298 |     test('NOMINAL matches Excel: =NOMINAL(0.053543, 4)', () => {

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:295:32)

  ‚óè Financial Functions - Extended Suite ‚Ä∫ Excel Compatibility ‚Ä∫ NOMINAL matches Excel: =NOMINAL(0.053543, 4)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      298 |     test('NOMINAL matches Excel: =NOMINAL(0.053543, 4)', () => {
      299 |       const result = evaluate('=NOMINAL(0.053543, 4)');
    > 300 |       expect(typeof result).toBe('number');
          |                             ^
      301 |       expect(result as number).toBeCloseTo(0.0525, 4);
      302 |     });
      303 |   });

      at Object.<anonymous> (__tests__/functions/financial-extended.test.ts:300:29)

FAIL packages/core/__tests__/conditional-formatting-engine.test.ts
  ‚óè ConditionalFormattingEngine ‚Ä∫ Duplicate/Unique rules ‚Ä∫ handles mixed text and number types

    expect(received).toBe(expected) // Object.is equality

    Expected: "#ff0000"
    Received: undefined

      411 | 			// 123 and '123' are treated as equal (string comparison)
      412 | 			const result1 = engine.applyRules(123, [rule], { address: { row: 1, col: 1 }, getValue: mockGetValue });
    > 413 | 			expect(result1.style?.fillColor).toBe('#ff0000');
          | 			                                 ^
      414 |
      415 | 			const result2 = engine.applyRules('123', [rule], { address: { row: 1, col: 2 }, getValue: mockGetValue });
      416 | 			expect(result2.style?.fillColor).toBe('#ff0000');

      at Object.<anonymous> (__tests__/conditional-formatting-engine.test.ts:413:37)

FAIL packages/core/__tests__/integration-week6-7.test.ts (5.099 s)
  ‚óè Week 6-7 Integration - Real-World Scenarios ‚Ä∫ Scenario 1: Monthly Payroll with Dates & Overtime ‚Ä∫ calculate days since hire date (date serial fix)

    expect(received).toBe(expected) // Object.is equality

    Expected: 24
    Received: 43

      57 |       const daysSinceHire = (today as number) - (aliceStart as number);
      58 |
    > 59 |       expect(daysSinceHire).toBe(24); // Jan 29 - Jan 5 = 24 days
         |                             ^
      60 |     });
      61 |
      62 |     test('calculate pay manually (testing formulas)', () => {

      at Object.<anonymous> (__tests__/integration-week6-7.test.ts:59:29)

FAIL packages/core/__tests__/information-type-checking.test.ts
  ‚óè Week 11 Day 1: Information & Type Checking Functions ‚Ä∫ ISBLANK Function ‚Ä∫ returns TRUE for empty string

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      103 |   describe('ISBLANK Function', () => {
      104 |     test('returns TRUE for empty string', () => {
    > 105 |       expect(engine.evaluate('=ISBLANK("")', context)).toBe(true);
          |                                                        ^
      106 |     });
      107 |
      108 |     test('returns TRUE for empty cells', () => {

      at Object.<anonymous> (__tests__/information-type-checking.test.ts:105:56)

  ‚óè Week 11 Day 1: Information & Type Checking Functions ‚Ä∫ ISBLANK Function ‚Ä∫ returns TRUE for empty cells

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      111 |       
      112 |       expect(engine.evaluate('=ISBLANK(A6)', context)).toBe(true);
    > 113 |       expect(engine.evaluate('=ISBLANK(A8)', context)).toBe(true);
          |                                                        ^
      114 |       // Row 7 (A7) not set, should also be blank
      115 |       expect(engine.evaluate('=ISBLANK(A7)', context)).toBe(true);
      116 |     });

      at Object.<anonymous> (__tests__/information-type-checking.test.ts:113:56)

  ‚óè Week 11 Day 1: Information & Type Checking Functions ‚Ä∫ Integration Tests ‚Ä∫ combining type checks with IF

    expect(received).toBe(expected) // Object.is equality

    Expected: "empty"
    Received: "filled"

      361 |       expect(engine.evaluate('=IF(ISNUMBER(100), "num", "other")', context)).toBe('num');
      362 |       expect(engine.evaluate('=IF(ISTEXT("hello"), "text", "other")', context)).toBe('text');
    > 363 |       expect(engine.evaluate('=IF(ISBLANK(""), "empty", "filled")', context)).toBe('empty');
          |                                                                               ^
      364 |     });
      365 |
      366 |     test('type checking with data validation', () => {

      at Object.<anonymous> (__tests__/information-type-checking.test.ts:363:79)

  ‚óè Week 11 Day 1: Information & Type Checking Functions ‚Ä∫ Integration Tests ‚Ä∫ ISBLANK for conditional formatting logic

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 3

      404 |         context
      405 |       );
    > 406 |       expect(countNonBlank).toBe(2);
          |                             ^
      407 |     });
      408 |
      409 |     test('ISNONTEXT for filtering numeric data', () => {

      at Object.<anonymous> (__tests__/information-type-checking.test.ts:406:29)

FAIL packages/core/__tests__/exotic/exotic-functions.test.ts (5.221 s)
  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ FORMULATEXT - Formula Inspection ‚Ä∫ should return formula text from cell containing formula (direct call)

    TypeError: (intermediate value) is not a function

      45 |       
      46 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 47 |       const result = (funcInfo?.handler as any)(context, addr);
         |                                                ^
      48 |       expect(result).toBe('=SUM(B1:B10)');
      49 |     });
      50 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:47:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ FORMULATEXT - Formula Inspection ‚Ä∫ should return #N/A for cell without formula

    TypeError: (intermediate value) is not a function

      59 |       
      60 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 61 |       const result = (funcInfo?.handler as any)(context, { row: 1, col: 1 });
         |                                                ^
      62 |       expect(result).toBeInstanceOf(Error);
      63 |       expect(String(result)).toContain('#N/A');
      64 |     });

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:61:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ FORMULATEXT - Formula Inspection ‚Ä∫ should return #N/A for empty cell

    TypeError: (intermediate value) is not a function

      72 |       
      73 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 74 |       const result = (funcInfo?.handler as any)(context, { row: 1, col: 1 });
         |                                                ^
      75 |       expect(result).toBeInstanceOf(Error);
      76 |       expect(String(result)).toContain('#N/A');
      77 |     });

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:74:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ FORMULATEXT - Formula Inspection ‚Ä∫ should work with complex formulas

    TypeError: (intermediate value) is not a function

      89 |       
      90 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 91 |       const result = (funcInfo?.handler as any)(context, addr);
         |                                                ^
      92 |       expect(result).toBe('=IF(A1>10, SUM(B1:B5), AVERAGE(C1:C5))');
      93 |     });
      94 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:91:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ FORMULATEXT - Formula Inspection ‚Ä∫ should distinguish between formula and string starting with =

    TypeError: (intermediate value) is not a function

      104 |       
      105 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 106 |       const result = (funcInfo?.handler as any)(context, { row: 3, col: 3 });
          |                                                ^
      107 |       // Should return the formula text since value starts with '='
      108 |       expect(result).toBe('=A1+A2');
      109 |     });

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:106:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ SHEET - Sheet Number ‚Ä∫ should return 1 for current sheet when no argument

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #NAME?]

      113 |     it('should return 1 for current sheet when no argument', () => {
      114 |       const result = evaluate('=SHEET()');
    > 115 |       expect(result).toBe(1);
          |                      ^
      116 |     });
      117 |
      118 |     it('should return 1 for current sheet name', () => {

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:115:22)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ SHEET - Sheet Number ‚Ä∫ should return 1 for current sheet name

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #NAME?]

      118 |     it('should return 1 for current sheet name', () => {
      119 |       const result = evaluate('=SHEET("TestSheet")');
    > 120 |       expect(result).toBe(1);
          |                      ^
      121 |     });
      122 |
      123 |     it('should return 1 for non-existent sheet (single-sheet implementation)', () => {

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:120:22)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ SHEET - Sheet Number ‚Ä∫ should return 1 for non-existent sheet (single-sheet implementation)

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      126 |       const result = evaluate('=SHEET("NonExistentSheet")');
      127 |       // For now, accept 1 (current behavior) or #REF! (future behavior)
    > 128 |       expect(result === 1 || (result instanceof Error && String(result).includes('#REF!'))).toBe(true);
          |                                                                                             ^
      129 |     });
      130 |   });
      131 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:128:93)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ SHEETS - Sheet Count ‚Ä∫ should return 1 for single sheet workbook

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #NAME?]

      133 |     it('should return 1 for single sheet workbook', () => {
      134 |       const result = evaluate('=SHEETS()');
    > 135 |       expect(result).toBe(1);
          |                      ^
      136 |     });
      137 |   });
      138 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:135:22)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ GETPIVOTDATA - Pivot Table Extraction ‚Ä∫ should return #REF! for pivot tables not supported

    expect(received).toContain(expected) // indexOf

    Expected substring: "#REF!"
    Received string:    "Error: #NAME?"

      142 |       const result = evaluate('=GETPIVOTDATA("Sales", A1)');
      143 |       expect(result).toBeInstanceOf(Error);
    > 144 |       expect(String(result)).toContain('#REF!');
          |                              ^
      145 |     });
      146 |   });
      147 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:144:30)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEMEMBER ‚Ä∫ should return #N/A when no cube connection

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      151 |         const result = evaluate('=CUBEMEMBER("SalesCube", "[Time].[Year].[2024]")');
      152 |         expect(result).toBeInstanceOf(Error);
    > 153 |         expect(String(result)).toContain('#N/A');
          |                                ^
      154 |       });
      155 |
      156 |       it('should accept optional caption', () => {

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:153:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEMEMBER ‚Ä∫ should accept optional caption

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      157 |         const result = evaluate('=CUBEMEMBER("SalesCube", "[Time].[Year].[2024]", "2024")');
      158 |         expect(result).toBeInstanceOf(Error);
    > 159 |         expect(String(result)).toContain('#N/A');
          |                                ^
      160 |       });
      161 |     });
      162 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:159:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBESET ‚Ä∫ should return #N/A when no cube connection

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      165 |         const result = evaluate('=CUBESET("SalesCube", "[Product].[Category].Members")');
      166 |         expect(result).toBeInstanceOf(Error);
    > 167 |         expect(String(result)).toContain('#N/A');
          |                                ^
      168 |       });
      169 |     });
      170 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:167:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEVALUE ‚Ä∫ should return #N/A when no cube connection

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      173 |         const result = evaluate('=CUBEVALUE("SalesCube", "[Time].[2024]", "[Measures].[Sales]")');
      174 |         expect(result).toBeInstanceOf(Error);
    > 175 |         expect(String(result)).toContain('#N/A');
          |                                ^
      176 |       });
      177 |
      178 |       it('should accept multiple member expressions', () => {

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:175:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEVALUE ‚Ä∫ should accept multiple member expressions

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      179 |         const result = evaluate('=CUBEVALUE("SalesCube", "[Time].[2024]", "[Product].[Bikes]", "[Region].[East]")');
      180 |         expect(result).toBeInstanceOf(Error);
    > 181 |         expect(String(result)).toContain('#N/A');
          |                                ^
      182 |       });
      183 |     });
      184 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:181:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBERANKEDMEMBER ‚Ä∫ should return #N/A for stub implementation

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      187 |         const result = evaluate('=CUBERANKEDMEMBER("SalesCube", "[Product].[Top10]", 1)');
      188 |         expect(result).toBeInstanceOf(Error);
    > 189 |         expect(String(result)).toContain('#N/A');
          |                                ^
      190 |       });
      191 |     });
      192 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:189:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEKPIMEMBER ‚Ä∫ should return #N/A for stub implementation

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      195 |         const result = evaluate('=CUBEKPIMEMBER("SalesCube", "SalesTarget", "Value")');
      196 |         expect(result).toBeInstanceOf(Error);
    > 197 |         expect(String(result)).toContain('#N/A');
          |                                ^
      198 |       });
      199 |     });
      200 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:197:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBEMEMBERPROPERTY ‚Ä∫ should return #N/A for stub implementation

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      203 |         const result = evaluate('=CUBEMEMBERPROPERTY("SalesCube", "[Product].[Bikes]", "Name")');
      204 |         expect(result).toBeInstanceOf(Error);
    > 205 |         expect(String(result)).toContain('#N/A');
          |                                ^
      206 |       });
      207 |     });
      208 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:205:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ CUBE Functions - OLAP Support ‚Ä∫ CUBESETCOUNT ‚Ä∫ should return #N/A for stub implementation

    expect(received).toContain(expected) // indexOf

    Expected substring: "#N/A"
    Received string:    "Error: #NAME?"

      211 |         const result = evaluate('=CUBESETCOUNT("[Product].[Top10]")');
      212 |         expect(result).toBeInstanceOf(Error);
    > 213 |         expect(String(result)).toContain('#N/A');
          |                                ^
      214 |       });
      215 |     });
      216 |   });

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:213:32)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ Integration - Exotic Functions in Formulas ‚Ä∫ should use FORMULATEXT in error checking (direct call)

    TypeError: (intermediate value) is not a function

      229 |       
      230 |       const funcInfo = engine.functions.getMetadata('FORMULATEXT');
    > 231 |       const result = (funcInfo?.handler as any)(context, addr);
          |                                                ^
      232 |       expect(typeof result).toBe('string');
      233 |       expect(result).toContain('SUM');
      234 |     });

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:231:48)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ Integration - Exotic Functions in Formulas ‚Ä∫ should combine SHEET with conditional logic

    expect(received).toBe(expected) // Object.is equality

    Expected: "First Sheet"
    Received: [Error: #NAME?]

      236 |     it('should combine SHEET with conditional logic', () => {
      237 |       const result = evaluate('=IF(SHEET()=1, "First Sheet", "Other Sheet")');
    > 238 |       expect(result).toBe('First Sheet');
          |                      ^
      239 |     });
      240 |
      241 |     it('should use SHEETS to detect single vs multi-sheet workbook', () => {

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:238:22)

  ‚óè Exotic Functions - Complete Excel Parity ‚Ä∫ Integration - Exotic Functions in Formulas ‚Ä∫ should use SHEETS to detect single vs multi-sheet workbook

    expect(received).toBe(expected) // Object.is equality

    Expected: "Single-sheet"
    Received: [Error: #NAME?]

      241 |     it('should use SHEETS to detect single vs multi-sheet workbook', () => {
      242 |       const result = evaluate('=IF(SHEETS()>1, "Multi-sheet", "Single-sheet")');
    > 243 |       expect(result).toBe('Single-sheet');
          |                      ^
      244 |     });
      245 |   });
      246 |

      at Object.<anonymous> (__tests__/exotic/exotic-functions.test.ts:243:22)

FAIL packages/core/__tests__/functions/text-enhancement-functions.test.ts (5.143 s)
  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ CONCAT function ‚Ä∫ should handle cell ranges

    expect(received).toBe(expected) // Object.is equality

    Expected: "HelloWorld!"
    Received: ""

      51 |       setCellValue('A2', 'World');
      52 |       setCellValue('A3', '!');
    > 53 |       expect(evaluate('=CONCAT(A1:A3)')).toBe('HelloWorld!');
         |                                          ^
      54 |     });
      55 |
      56 |     test('should handle mixed ranges and strings', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:53:42)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ CONCAT function ‚Ä∫ should handle mixed ranges and strings

    expect(received).toBe(expected) // Object.is equality

    Expected: "FirstSecond and more"
    Received: " and more"

      57 |       setCellValue('A1', 'First');
      58 |       setCellValue('A2', 'Second');
    > 59 |       expect(evaluate('=CONCAT(A1:A2, " and more")')).toBe('FirstSecond and more');
         |                                                       ^
      60 |     });
      61 |
      62 |     test('should ignore errors in arguments', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:59:55)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ CONCAT function ‚Ä∫ should ignore errors in arguments

    expect(received).toBe(expected) // Object.is equality

    Expected: "HelloWorld"
    Received: ""

      64 |       setCellValue('A2', new Error('#DIV/0!')); // Error
      65 |       setCellValue('A3', 'World');
    > 66 |       expect(evaluate('=CONCAT(A1:A3)')).toBe('HelloWorld');
         |                                          ^
      67 |     });
      68 |
      69 |     test('should treat empty cells as empty strings', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:66:42)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ CONCAT function ‚Ä∫ should treat empty cells as empty strings

    expect(received).toBe(expected) // Object.is equality

    Expected: "AC"
    Received: ""

      70 |       setCellValue('A1', 'A');
      71 |       setCellValue('A3', 'C');
    > 72 |       expect(evaluate('=CONCAT(A1:A3)')).toBe('AC');
         |                                          ^
      73 |     });
      74 |
      75 |     test('should handle single argument', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:72:42)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ PROPER function ‚Ä∫ should handle cell reference

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello World"
    Received: ""

      120 |     test('should handle cell reference', () => {
      121 |       setCellValue('A1', 'hello world');
    > 122 |       expect(evaluate('=PROPER(A1)')).toBe('Hello World');
          |                                       ^
      123 |     });
      124 |   });
      125 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:122:39)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ CLEAN function ‚Ä∫ should handle cell reference

    expect(received).toBe(expected) // Object.is equality

    Expected: "HelloWorld"
    Received: ""

      160 |     test('should handle cell reference', () => {
      161 |       setCellValue('A1', 'Hello\x07World'); // Bell character
    > 162 |       expect(evaluate('=CLEAN(A1)')).toBe('HelloWorld');
          |                                      ^
      163 |     });
      164 |   });
      165 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:162:38)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ UNICHAR function ‚Ä∫ should handle cell reference

    expect(received).toBe(expected) // Object.is equality

    Expected: "‚òÖ"
    Received: " "

      207 |     test('should handle cell reference', () => {
      208 |       setCellValue('A1', 9733);
    > 209 |       expect(evaluate('=UNICHAR(A1)')).toBe('‚òÖ');
          |                                        ^
      210 |     });
      211 |   });
      212 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:209:40)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ UNICODE function ‚Ä∫ should handle cell reference

    expect(received).toBe(expected) // Object.is equality

    Expected: 72
    Received: [Error: #VALUE!]

      247 |     test('should handle cell reference', () => {
      248 |       setCellValue('A1', 'Hello');
    > 249 |       expect(evaluate('=UNICODE(A1)')).toBe(72); // 'H'
          |                                        ^
      250 |     });
      251 |
      252 |     test('should be inverse of UNICHAR', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:249:40)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ DOLLAR function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: "$1,234.57"
    Received: "$0.00"

      301 |     test('should handle cell references', () => {
      302 |       setCellValue('A1', 1234.567);
    > 303 |       expect(evaluate('=DOLLAR(A1)')).toBe('$1,234.57');
          |                                       ^
      304 |     });
      305 |   });
      306 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:303:39)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should format with default settings

    expect(received).toBe(expected) // Object.is equality

    Expected: "1,234.57"
    Received: [Error: #NAME?]

      311 |   describe('FIXED function', () => {
      312 |     test('should format with default settings', () => {
    > 313 |       expect(evaluate('=FIXED(1234.567)')).toBe('1,234.57');
          |                                            ^
      314 |       expect(evaluate('=FIXED(1000)')).toBe('1,000.00');
      315 |     });
      316 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:313:44)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should format with specified decimal places

    expect(received).toBe(expected) // Object.is equality

    Expected: "1,234.6"
    Received: [Error: #NAME?]

      316 |
      317 |     test('should format with specified decimal places', () => {
    > 318 |       expect(evaluate('=FIXED(1234.567, 1)')).toBe('1,234.6');
          |                                               ^
      319 |       expect(evaluate('=FIXED(1234.567, 4)')).toBe('1,234.5670');
      320 |       expect(evaluate('=FIXED(1234.567, 0)')).toBe('1,235');
      321 |     });

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:318:47)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should handle negative decimals (round to left)

    expect(received).toBe(expected) // Object.is equality

    Expected: "1,230"
    Received: [Error: #NAME?]

      322 |
      323 |     test('should handle negative decimals (round to left)', () => {
    > 324 |       expect(evaluate('=FIXED(1234.567, -1)')).toBe('1,230');
          |                                                ^
      325 |       expect(evaluate('=FIXED(1234.567, -2)')).toBe('1,200');
      326 |       expect(evaluate('=FIXED(5678, -3)')).toBe('6,000');
      327 |     });

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:324:48)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should omit commas when no_commas is TRUE

    expect(received).toBe(expected) // Object.is equality

    Expected: "1234.6"
    Received: [Error: #NAME?]

      328 |
      329 |     test('should omit commas when no_commas is TRUE', () => {
    > 330 |       expect(evaluate('=FIXED(1234.567, 1, TRUE)')).toBe('1234.6');
          |                                                     ^
      331 |       expect(evaluate('=FIXED(1000, 2, TRUE)')).toBe('1000.00');
      332 |     });
      333 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:330:53)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should include commas when no_commas is FALSE

    expect(received).toBe(expected) // Object.is equality

    Expected: "1,234.6"
    Received: [Error: #NAME?]

      333 |
      334 |     test('should include commas when no_commas is FALSE', () => {
    > 335 |       expect(evaluate('=FIXED(1234.567, 1, FALSE)')).toBe('1,234.6');
          |                                                      ^
      336 |     });
      337 |
      338 |     test('should handle negative numbers', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:335:54)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should handle negative numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "-1,234.57"
    Received: [Error: #NAME?]

      337 |
      338 |     test('should handle negative numbers', () => {
    > 339 |       expect(evaluate('=FIXED(-1234.567)')).toBe('-1,234.57');
          |                                             ^
      340 |       expect(evaluate('=FIXED(-1234.567, 1, TRUE)')).toBe('-1234.6');
      341 |     });
      342 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:339:45)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0.00"
    Received: [Error: #NAME?]

      342 |
      343 |     test('should handle zero', () => {
    > 344 |       expect(evaluate('=FIXED(0)')).toBe('0.00');
          |                                     ^
      345 |       expect(evaluate('=FIXED(0, 4)')).toBe('0.0000');
      346 |     });
      347 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:344:37)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should return error for non-integer decimals

    expect(received).toBe(expected) // Object.is equality

    Expected: "#VALUE!"
    Received: "#NAME?"

      349 |       const result = evaluate('=FIXED(1234, 2.5)');
      350 |       expect(result).toBeInstanceOf(Error);
    > 351 |       expect((result as Error).message).toBe('#VALUE!');
          |                                         ^
      352 |     });
      353 |
      354 |     test('should handle cell references', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:351:41)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ FIXED function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: "1,234.6"
    Received: [Error: #NAME?]

      354 |     test('should handle cell references', () => {
      355 |       setCellValue('A1', 1234.567);
    > 356 |       expect(evaluate('=FIXED(A1, 1)')).toBe('1,234.6');
          |                                         ^
      357 |     });
      358 |   });
      359 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:356:41)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should extract text before first occurrence

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello"
    Received: [Error: #NAME?]

      364 |   describe('TEXTBEFORE function', () => {
      365 |     test('should extract text before first occurrence', () => {
    > 366 |       expect(evaluate('=TEXTBEFORE("Hello-World", "-")')).toBe('Hello');
          |                                                           ^
      367 |       expect(evaluate('=TEXTBEFORE("First:Second:Third", ":")')).toBe('First');
      368 |     });
      369 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:366:59)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should extract text before specified occurrence

    expect(received).toBe(expected) // Object.is equality

    Expected: "A:B"
    Received: [Error: #NAME?]

      369 |
      370 |     test('should extract text before specified occurrence', () => {
    > 371 |       expect(evaluate('=TEXTBEFORE("A:B:C:D", ":", 2)')).toBe('A:B');
          |                                                          ^
      372 |       expect(evaluate('=TEXTBEFORE("A:B:C:D", ":", 3)')).toBe('A:B:C');
      373 |     });
      374 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:371:58)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should handle negative instance (from end)

    expect(received).toBe(expected) // Object.is equality

    Expected: "A:B:C"
    Received: [Error: #NAME?]

      374 |
      375 |     test('should handle negative instance (from end)', () => {
    > 376 |       expect(evaluate('=TEXTBEFORE("A:B:C:D", ":", -1)')).toBe('A:B:C');
          |                                                           ^
      377 |       expect(evaluate('=TEXTBEFORE("A:B:C:D", ":", -2)')).toBe('A:B');
      378 |     });
      379 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:376:59)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should handle email addresses

    expect(received).toBe(expected) // Object.is equality

    Expected: "test"
    Received: [Error: #NAME?]

      379 |
      380 |     test('should handle email addresses', () => {
    > 381 |       expect(evaluate('=TEXTBEFORE("test@example.com", "@")')).toBe('test');
          |                                                                ^
      382 |     });
      383 |
      384 |     test('should handle file paths', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:381:64)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should handle file paths

    expect(received).toBe(expected) // Object.is equality

    Expected: "folder"
    Received: [Error: #NAME?]

      383 |
      384 |     test('should handle file paths', () => {
    > 385 |       expect(evaluate('=TEXTBEFORE("folder/subfolder/file.txt", "/")')).toBe('folder');
          |                                                                         ^
      386 |     });
      387 |
      388 |     test('should return error when delimiter not found', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:385:73)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should return error when delimiter not found

    expect(received).toBe(expected) // Object.is equality

    Expected: "#N/A"
    Received: "#NAME?"

      389 |       const result = evaluate('=TEXTBEFORE("Hello", "-")');
      390 |       expect(result).toBeInstanceOf(Error);
    > 391 |       expect((result as Error).message).toBe('#N/A');
          |                                         ^
      392 |     });
      393 |
      394 |     test('should return full text when match_end is non-zero and delimiter not found', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:391:41)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should return full text when match_end is non-zero and delimiter not found

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello"
    Received: [Error: #NAME?]

      393 |
      394 |     test('should return full text when match_end is non-zero and delimiter not found', () => {
    > 395 |       expect(evaluate('=TEXTBEFORE("Hello", "-", 1, 0, 1)')).toBe('Hello');
          |                                                              ^
      396 |     });
      397 |
      398 |     test('should use if_not_found parameter', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:395:62)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should use if_not_found parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: "NotFound"
    Received: [Error: #NAME?]

      397 |
      398 |     test('should use if_not_found parameter', () => {
    > 399 |       expect(evaluate('=TEXTBEFORE("Hello", "-", 1, 0, 0, "NotFound")')).toBe('NotFound');
          |                                                                          ^
      400 |     });
      401 |
      402 |     test('should handle case-insensitive matching', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:399:74)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should handle case-insensitive matching

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello-"
    Received: [Error: #NAME?]

      401 |
      402 |     test('should handle case-insensitive matching', () => {
    > 403 |       expect(evaluate('=TEXTBEFORE("Hello-WORLD", "world", 1, 1)')).toBe('Hello-');
          |                                                                     ^
      404 |     });
      405 |
      406 |     test('should return error for invalid instance number', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:403:69)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should return error for invalid instance number

    expect(received).toBe(expected) // Object.is equality

    Expected: "#VALUE!"
    Received: "#NAME?"

      407 |       const result1 = evaluate('=TEXTBEFORE("A:B:C", ":", 0)');
      408 |       expect(result1).toBeInstanceOf(Error);
    > 409 |       expect((result1 as Error).message).toBe('#VALUE!');
          |                                          ^
      410 |
      411 |       const result2 = evaluate('=TEXTBEFORE("A:B:C", ":", 1.5)');
      412 |       expect(result2).toBeInstanceOf(Error);

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:409:42)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTBEFORE function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello"
    Received: [Error: #NAME?]

      416 |     test('should handle cell references', () => {
      417 |       setCellValue('A1', 'Hello-World');
    > 418 |       expect(evaluate('=TEXTBEFORE(A1, "-")')).toBe('Hello');
          |                                                ^
      419 |     });
      420 |   });
      421 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:418:48)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should extract text after first occurrence

    expect(received).toBe(expected) // Object.is equality

    Expected: "World"
    Received: [Error: #NAME?]

      426 |   describe('TEXTAFTER function', () => {
      427 |     test('should extract text after first occurrence', () => {
    > 428 |       expect(evaluate('=TEXTAFTER("Hello-World", "-")')).toBe('World');
          |                                                          ^
      429 |       expect(evaluate('=TEXTAFTER("First:Second:Third", ":")')).toBe('Second:Third');
      430 |     });
      431 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:428:58)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should extract text after specified occurrence

    expect(received).toBe(expected) // Object.is equality

    Expected: "C:D"
    Received: [Error: #NAME?]

      431 |
      432 |     test('should extract text after specified occurrence', () => {
    > 433 |       expect(evaluate('=TEXTAFTER("A:B:C:D", ":", 2)')).toBe('C:D');
          |                                                         ^
      434 |       expect(evaluate('=TEXTAFTER("A:B:C:D", ":", 3)')).toBe('D');
      435 |     });
      436 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:433:57)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should handle negative instance (from end)

    expect(received).toBe(expected) // Object.is equality

    Expected: "D"
    Received: [Error: #NAME?]

      436 |
      437 |     test('should handle negative instance (from end)', () => {
    > 438 |       expect(evaluate('=TEXTAFTER("A:B:C:D", ":", -1)')).toBe('D');
          |                                                          ^
      439 |       expect(evaluate('=TEXTAFTER("A:B:C:D", ":", -2)')).toBe('C:D');
      440 |     });
      441 |

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:438:58)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should handle email addresses

    expect(received).toBe(expected) // Object.is equality

    Expected: "example.com"
    Received: [Error: #NAME?]

      441 |
      442 |     test('should handle email addresses', () => {
    > 443 |       expect(evaluate('=TEXTAFTER("user@example.com", "@")')).toBe('example.com');
          |                                                               ^
      444 |     });
      445 |
      446 |     test('should handle file paths', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:443:63)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should handle file paths

    expect(received).toBe(expected) // Object.is equality

    Expected: "file.txt"
    Received: [Error: #NAME?]

      445 |
      446 |     test('should handle file paths', () => {
    > 447 |       expect(evaluate('=TEXTAFTER("folder/subfolder/file.txt", "/", -1)')).toBe('file.txt');
          |                                                                            ^
      448 |     });
      449 |
      450 |     test('should return error when delimiter not found', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:447:76)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should return error when delimiter not found

    expect(received).toBe(expected) // Object.is equality

    Expected: "#N/A"
    Received: "#NAME?"

      451 |       const result = evaluate('=TEXTAFTER("Hello", "-")');
      452 |       expect(result).toBeInstanceOf(Error);
    > 453 |       expect((result as Error).message).toBe('#N/A');
          |                                         ^
      454 |     });
      455 |
      456 |     test('should return full text when match_end is non-zero and delimiter not found', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:453:41)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should return full text when match_end is non-zero and delimiter not found

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello"
    Received: [Error: #NAME?]

      455 |
      456 |     test('should return full text when match_end is non-zero and delimiter not found', () => {
    > 457 |       expect(evaluate('=TEXTAFTER("Hello", "-", 1, 0, 1)')).toBe('Hello');
          |                                                             ^
      458 |     });
      459 |
      460 |     test('should use if_not_found parameter', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:457:61)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should use if_not_found parameter

    expect(received).toBe(expected) // Object.is equality

    Expected: "NotFound"
    Received: [Error: #NAME?]

      459 |
      460 |     test('should use if_not_found parameter', () => {
    > 461 |       expect(evaluate('=TEXTAFTER("Hello", "-", 1, 0, 0, "NotFound")')).toBe('NotFound');
          |                                                                         ^
      462 |     });
      463 |
      464 |     test('should handle case-insensitive matching', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:461:73)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should handle case-insensitive matching

    expect(received).toBe(expected) // Object.is equality

    Expected: "-WORLD"
    Received: [Error: #NAME?]

      463 |
      464 |     test('should handle case-insensitive matching', () => {
    > 465 |       expect(evaluate('=TEXTAFTER("Hello-WORLD", "hello", 1, 1)')).toBe('-WORLD');
          |                                                                    ^
      466 |     });
      467 |
      468 |     test('should return error for invalid instance number', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:465:68)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should return error for invalid instance number

    expect(received).toBe(expected) // Object.is equality

    Expected: "#VALUE!"
    Received: "#NAME?"

      469 |       const result1 = evaluate('=TEXTAFTER("A:B:C", ":", 0)');
      470 |       expect(result1).toBeInstanceOf(Error);
    > 471 |       expect((result1 as Error).message).toBe('#VALUE!');
          |                                          ^
      472 |
      473 |       const result2 = evaluate('=TEXTAFTER("A:B:C", ":", 1.5)');
      474 |       expect(result2).toBeInstanceOf(Error);

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:471:42)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: "World"
    Received: [Error: #NAME?]

      478 |     test('should handle cell references', () => {
      479 |       setCellValue('A1', 'Hello-World');
    > 480 |       expect(evaluate('=TEXTAFTER(A1, "-")')).toBe('World');
          |                                               ^
      481 |     });
      482 |
      483 |     test('should work with TEXTBEFORE for text extraction', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:480:47)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ TEXTAFTER function ‚Ä∫ should work with TEXTBEFORE for text extraction

    expect(received).toBe(expected) // Object.is equality

    Expected: "john.doe"
    Received: [Error: #NAME?]

      486 |       
      487 |       // Extract username
    > 488 |       expect(evaluate('=TEXTBEFORE(A1, "@")')).toBe('john.doe');
          |                                                ^
      489 |       
      490 |       // Extract domain
      491 |       expect(evaluate('=TEXTAFTER(A1, "@")')).toBe('company.com');

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:488:48)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ Integration tests ‚Ä∫ CONCAT with PROPER for name formatting

    expect(received).toBe(expected) // Object.is equality

    Expected: "John Doe"
    Received: " "

      501 |       setCellValue('A1', 'john');
      502 |       setCellValue('B1', 'doe');
    > 503 |       expect(evaluate('=CONCAT(PROPER(A1), " ", PROPER(B1))')).toBe('John Doe');
          |                                                                ^
      504 |     });
      505 |
      506 |     test('UNICHAR and UNICODE are inverses', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:503:64)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ Integration tests ‚Ä∫ CLEAN with CONCAT for sanitizing data

    expect(received).toBe(expected) // Object.is equality

    Expected: "Hello World"
    Received: " "

      512 |       setCellValue('A1', 'Hello\x07');
      513 |       setCellValue('A2', 'World\x1B');
    > 514 |       expect(evaluate('=CONCAT(CLEAN(A1), " ", CLEAN(A2))')).toBe('Hello World');
          |                                                              ^
      515 |     });
      516 |
      517 |     test('TEXTBEFORE and TEXTAFTER for parsing', () => {

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:514:62)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ Integration tests ‚Ä∫ TEXTBEFORE and TEXTAFTER for parsing

    expect(received).toBe(expected) // Object.is equality

    Expected: "First"
    Received: [Error: #NAME?]

      517 |     test('TEXTBEFORE and TEXTAFTER for parsing', () => {
      518 |       setCellValue('A1', 'First-Middle-Last');
    > 519 |       expect(evaluate('=TEXTBEFORE(A1, "-")')).toBe('First');
          |                                                ^
      520 |       expect(evaluate('=TEXTAFTER(TEXTBEFORE(A1, "-", 2), "-")')).toBe('Middle');
      521 |       expect(evaluate('=TEXTAFTER(A1, "-", -1)')).toBe('Last');
      522 |     });

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:519:48)

  ‚óè Week 11 Day 3: Text Enhancement Functions ‚Ä∫ Integration tests ‚Ä∫ DOLLAR and FIXED for different formatting needs

    expect(received).toBe(expected) // Object.is equality

    Expected: "$1,234.57"
    Received: "$0.00"

      524 |     test('DOLLAR and FIXED for different formatting needs', () => {
      525 |       setCellValue('A1', 1234.567);
    > 526 |       expect(evaluate('=DOLLAR(A1)')).toBe('$1,234.57');
          |                                       ^
      527 |       expect(evaluate('=FIXED(A1, 1)')).toBe('1,234.6');
      528 |       expect(evaluate('=FIXED(A1, 1, TRUE)')).toBe('1234.6');
      529 |     });

      at Object.<anonymous> (__tests__/functions/text-enhancement-functions.test.ts:526:39)

FAIL packages/core/__tests__/functions/engineering.test.ts (5.614 s)
  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should perform bitwise AND on simple numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #NAME?]

      389 |     test('should perform bitwise AND on simple numbers', () => {
      390 |       const result = evaluate('=BITAND(5, 3)');
    > 391 |       expect(result).toBe(1); // 101 AND 011 = 001
          |                      ^
      392 |     });
      393 |
      394 |     test('should perform bitwise AND on larger numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:391:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should perform bitwise AND on larger numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 9
    Received: [Error: #NAME?]

      394 |     test('should perform bitwise AND on larger numbers', () => {
      395 |       const result = evaluate('=BITAND(13, 25)');
    > 396 |       expect(result).toBe(9); // 1101 AND 11001 = 01001
          |                      ^
      397 |     });
      398 |
      399 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:396:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      398 |
      399 |     test('should handle zero', () => {
    > 400 |       expect(evaluate('=BITAND(0, 0)')).toBe(0);
          |                                         ^
      401 |       expect(evaluate('=BITAND(15, 0)')).toBe(0);
      402 |       expect(evaluate('=BITAND(0, 15)')).toBe(0);
      403 |     });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:400:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should handle same numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      405 |     test('should handle same numbers', () => {
      406 |       const result = evaluate('=BITAND(42, 42)');
    > 407 |       expect(result).toBe(42);
          |                      ^
      408 |     });
      409 |
      410 |     test('should return #NUM! for negative numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:407:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should return #NUM! for negative numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      411 |       const result = evaluate('=BITAND(-1, 5)');
      412 |       expect(result).toBeInstanceOf(Error);
    > 413 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      414 |     });
      415 |
      416 |     test('should return #NUM! for non-integer', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:413:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should return #NUM! for non-integer

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      417 |       const result = evaluate('=BITAND(5.5, 3)');
      418 |       expect(result).toBeInstanceOf(Error);
    > 419 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      420 |     });
      421 |
      422 |     test('should return #NUM! for numbers exceeding 2^48-1', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:419:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should return #NUM! for numbers exceeding 2^48-1

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      424 |       const result = evaluate(`=BITAND(${MAX}, 1)`);
      425 |       expect(result).toBeInstanceOf(Error);
    > 426 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      427 |     });
      428 |
      429 |     test('should work with large safe numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:426:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITAND ‚Ä∫ should work with large safe numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 458752
    Received: [Error: #NAME?]

      429 |     test('should work with large safe numbers', () => {
      430 |       const result = evaluate('=BITAND(1000000, 500000)');
    > 431 |       expect(result).toBe(1000000 & 500000);
          |                      ^
      432 |     });
      433 |   });
      434 |

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:431:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should perform bitwise OR on simple numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 7
    Received: [Error: #NAME?]

      436 |     test('should perform bitwise OR on simple numbers', () => {
      437 |       const result = evaluate('=BITOR(5, 3)');
    > 438 |       expect(result).toBe(7); // 101 OR 011 = 111
          |                      ^
      439 |     });
      440 |
      441 |     test('should perform bitwise OR on larger numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:438:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should perform bitwise OR on larger numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 29
    Received: [Error: #NAME?]

      441 |     test('should perform bitwise OR on larger numbers', () => {
      442 |       const result = evaluate('=BITOR(13, 25)');
    > 443 |       expect(result).toBe(29); // 01101 OR 11001 = 11101
          |                      ^
      444 |     });
      445 |
      446 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:443:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      445 |
      446 |     test('should handle zero', () => {
    > 447 |       expect(evaluate('=BITOR(0, 0)')).toBe(0);
          |                                        ^
      448 |       expect(evaluate('=BITOR(15, 0)')).toBe(15);
      449 |       expect(evaluate('=BITOR(0, 15)')).toBe(15);
      450 |     });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:447:40)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should handle same numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      452 |     test('should handle same numbers', () => {
      453 |       const result = evaluate('=BITOR(42, 42)');
    > 454 |       expect(result).toBe(42);
          |                      ^
      455 |     });
      456 |
      457 |     test('should return #NUM! for negative numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:454:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should return #NUM! for negative numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      458 |       const result = evaluate('=BITOR(-1, 5)');
      459 |       expect(result).toBeInstanceOf(Error);
    > 460 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      461 |     });
      462 |
      463 |     test('should return #NUM! for non-integer', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:460:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should return #NUM! for non-integer

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      464 |       const result = evaluate('=BITOR(5.5, 3)');
      465 |       expect(result).toBeInstanceOf(Error);
    > 466 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      467 |     });
      468 |
      469 |     test('should work with large safe numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:466:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITOR ‚Ä∫ should work with large safe numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 1041248
    Received: [Error: #NAME?]

      469 |     test('should work with large safe numbers', () => {
      470 |       const result = evaluate('=BITOR(1000000, 500000)');
    > 471 |       expect(result).toBe(1000000 | 500000);
          |                      ^
      472 |     });
      473 |   });
      474 |

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:471:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should perform bitwise XOR on simple numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 6
    Received: [Error: #NAME?]

      476 |     test('should perform bitwise XOR on simple numbers', () => {
      477 |       const result = evaluate('=BITXOR(5, 3)');
    > 478 |       expect(result).toBe(6); // 101 XOR 011 = 110
          |                      ^
      479 |     });
      480 |
      481 |     test('should perform bitwise XOR on larger numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:478:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should perform bitwise XOR on larger numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 20
    Received: [Error: #NAME?]

      481 |     test('should perform bitwise XOR on larger numbers', () => {
      482 |       const result = evaluate('=BITXOR(13, 25)');
    > 483 |       expect(result).toBe(20); // 01101 XOR 11001 = 10100
          |                      ^
      484 |     });
      485 |
      486 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:483:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      485 |
      486 |     test('should handle zero', () => {
    > 487 |       expect(evaluate('=BITXOR(0, 0)')).toBe(0);
          |                                         ^
      488 |       expect(evaluate('=BITXOR(15, 0)')).toBe(15);
      489 |       expect(evaluate('=BITXOR(0, 15)')).toBe(15);
      490 |     });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:487:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should handle same numbers (result is 0)

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      492 |     test('should handle same numbers (result is 0)', () => {
      493 |       const result = evaluate('=BITXOR(42, 42)');
    > 494 |       expect(result).toBe(0);
          |                      ^
      495 |     });
      496 |
      497 |     test('should return #NUM! for negative numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:494:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should return #NUM! for negative numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      498 |       const result = evaluate('=BITXOR(-1, 5)');
      499 |       expect(result).toBeInstanceOf(Error);
    > 500 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      501 |     });
      502 |
      503 |     test('should return #NUM! for non-integer', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:500:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should return #NUM! for non-integer

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      504 |       const result = evaluate('=BITXOR(5.5, 3)');
      505 |       expect(result).toBeInstanceOf(Error);
    > 506 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      507 |     });
      508 |
      509 |     test('should work with large safe numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:506:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ should work with large safe numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 582496
    Received: [Error: #NAME?]

      509 |     test('should work with large safe numbers', () => {
      510 |       const result = evaluate('=BITXOR(1000000, 500000)');
    > 511 |       expect(result).toBe(1000000 ^ 500000);
          |                      ^
      512 |     });
      513 |
      514 |     test('XOR twice should return original', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:511:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITXOR ‚Ä∫ XOR twice should return original

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      516 |       const result1 = evaluate('=BITXOR(42, 17)');
      517 |       const result2 = evaluate(`=BITXOR(${result1}, 17)`);
    > 518 |       expect(result2).toBe(42);
          |                       ^
      519 |     });
      520 |   });
      521 |

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:518:23)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should shift left by specified bits

    expect(received).toBe(expected) // Object.is equality

    Expected: 20
    Received: [Error: #NAME?]

      523 |     test('should shift left by specified bits', () => {
      524 |       const result = evaluate('=BITLSHIFT(5, 2)');
    > 525 |       expect(result).toBe(20); // 101 << 2 = 10100
          |                      ^
      526 |     });
      527 |
      528 |     test('should shift left by 4 bits', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:525:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should shift left by 4 bits

    expect(received).toBe(expected) // Object.is equality

    Expected: 48
    Received: [Error: #NAME?]

      528 |     test('should shift left by 4 bits', () => {
      529 |       const result = evaluate('=BITLSHIFT(3, 4)');
    > 530 |       expect(result).toBe(48); // 11 << 4 = 110000
          |                      ^
      531 |     });
      532 |
      533 |     test('should handle zero shift', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:530:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should handle zero shift

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      533 |     test('should handle zero shift', () => {
      534 |       const result = evaluate('=BITLSHIFT(42, 0)');
    > 535 |       expect(result).toBe(42);
          |                      ^
      536 |     });
      537 |
      538 |     test('should handle zero value', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:535:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should handle zero value

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      538 |     test('should handle zero value', () => {
      539 |       const result = evaluate('=BITLSHIFT(0, 5)');
    > 540 |       expect(result).toBe(0);
          |                      ^
      541 |     });
      542 |
      543 |     test('should multiply by powers of 2', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:540:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should multiply by powers of 2

    expect(received).toBe(expected) // Object.is equality

    Expected: 14
    Received: [Error: #NAME?]

      543 |     test('should multiply by powers of 2', () => {
      544 |       // Left shift by N is equivalent to multiply by 2^N
    > 545 |       expect(evaluate('=BITLSHIFT(7, 1)')).toBe(14); // 7 * 2
          |                                            ^
      546 |       expect(evaluate('=BITLSHIFT(7, 2)')).toBe(28); // 7 * 4
      547 |       expect(evaluate('=BITLSHIFT(7, 3)')).toBe(56); // 7 * 8
      548 |     });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:545:44)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should return #NUM! for negative number

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      551 |       const result = evaluate('=BITLSHIFT(-5, 2)');
      552 |       expect(result).toBeInstanceOf(Error);
    > 553 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      554 |     });
      555 |
      556 |     test('should return #NUM! for non-integer', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:553:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should return #NUM! for non-integer

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      557 |       const result = evaluate('=BITLSHIFT(5.5, 2)');
      558 |       expect(result).toBeInstanceOf(Error);
    > 559 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      560 |     });
      561 |
      562 |     test('should return #NUM! if result exceeds 2^48-1', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:559:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ should return #NUM! if result exceeds 2^48-1

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      563 |       const result = evaluate('=BITLSHIFT(1000000000000, 10)');
      564 |       expect(result).toBeInstanceOf(Error);
    > 565 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      566 |     });
      567 |
      568 |     test('negative shift should perform right shift', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:565:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITLSHIFT ‚Ä∫ negative shift should perform right shift

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NAME?]

      568 |     test('negative shift should perform right shift', () => {
      569 |       const result = evaluate('=BITLSHIFT(20, -2)');
    > 570 |       expect(result).toBe(5); // Same as BITRSHIFT(20, 2)
          |                      ^
      571 |     });
      572 |   });
      573 |

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:570:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should shift right by specified bits

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NAME?]

      575 |     test('should shift right by specified bits', () => {
      576 |       const result = evaluate('=BITRSHIFT(20, 2)');
    > 577 |       expect(result).toBe(5); // 10100 >> 2 = 101
          |                      ^
      578 |     });
      579 |
      580 |     test('should shift right by 4 bits', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:577:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should shift right by 4 bits

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: [Error: #NAME?]

      580 |     test('should shift right by 4 bits', () => {
      581 |       const result = evaluate('=BITRSHIFT(48, 4)');
    > 582 |       expect(result).toBe(3); // 110000 >> 4 = 11
          |                      ^
      583 |     });
      584 |
      585 |     test('should handle zero shift', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:582:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should handle zero shift

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      585 |     test('should handle zero shift', () => {
      586 |       const result = evaluate('=BITRSHIFT(42, 0)');
    > 587 |       expect(result).toBe(42);
          |                      ^
      588 |     });
      589 |
      590 |     test('should handle zero value', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:587:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should handle zero value

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      590 |     test('should handle zero value', () => {
      591 |       const result = evaluate('=BITRSHIFT(0, 5)');
    > 592 |       expect(result).toBe(0);
          |                      ^
      593 |     });
      594 |
      595 |     test('should divide by powers of 2 (integer division)', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:592:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should divide by powers of 2 (integer division)

    expect(received).toBe(expected) // Object.is equality

    Expected: 7
    Received: [Error: #NAME?]

      595 |     test('should divide by powers of 2 (integer division)', () => {
      596 |       // Right shift by N is equivalent to integer division by 2^N
    > 597 |       expect(evaluate('=BITRSHIFT(14, 1)')).toBe(7); // 14 / 2
          |                                             ^
      598 |       expect(evaluate('=BITRSHIFT(28, 2)')).toBe(7); // 28 / 4
      599 |       expect(evaluate('=BITRSHIFT(56, 3)')).toBe(7); // 56 / 8
      600 |     });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:597:45)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should return #NUM! for negative number

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      603 |       const result = evaluate('=BITRSHIFT(-5, 2)');
      604 |       expect(result).toBeInstanceOf(Error);
    > 605 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      606 |     });
      607 |
      608 |     test('should return #NUM! for non-integer', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:605:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ should return #NUM! for non-integer

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      609 |       const result = evaluate('=BITRSHIFT(5.5, 2)');
      610 |       expect(result).toBeInstanceOf(Error);
    > 611 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      612 |     });
      613 |
      614 |     test('large shift should return 0', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:611:41)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ large shift should return 0

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #NAME?]

      614 |     test('large shift should return 0', () => {
      615 |       const result = evaluate('=BITRSHIFT(42, 100)');
    > 616 |       expect(result).toBe(0);
          |                      ^
      617 |     });
      618 |
      619 |     test('negative shift should perform left shift', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:616:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ BITRSHIFT ‚Ä∫ negative shift should perform left shift

    expect(received).toBe(expected) // Object.is equality

    Expected: 20
    Received: [Error: #NAME?]

      619 |     test('negative shift should perform left shift', () => {
      620 |       const result = evaluate('=BITRSHIFT(5, -2)');
    > 621 |       expect(result).toBe(20); // Same as BITLSHIFT(5, 2)
          |                      ^
      622 |     });
      623 |   });
      624 |

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:621:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ Bitwise integration tests ‚Ä∫ BITAND and BITOR relationship

    expect(received).toBe(expected) // Object.is equality

    If it should pass with deep equality, replace "toBe" with "toStrictEqual"

    Expected: [Error: #NAME?]
    Received: serializes to the same string

      632 |       const orFromParts = evaluate(`=BITOR(${andResult}, ${xorResult})`);
      633 |       const orDirect = evaluate(`=BITOR(${a}, ${b})`);
    > 634 |       expect(orFromParts).toBe(orDirect);
          |                           ^
      635 |     });
      636 |
      637 |     test('shift operations are inverse', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:634:27)

  ‚óè Bitwise Engineering Functions ‚Ä∫ Bitwise integration tests ‚Ä∫ shift operations are inverse

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      640 |       const shifted = evaluate(`=BITLSHIFT(${original}, 3)`);
      641 |       const restored = evaluate(`=BITRSHIFT(${shifted}, 3)`);
    > 642 |       expect(restored).toBe(original);
          |                        ^
      643 |     });
      644 |
      645 |     test('XOR with all 1s is equivalent to NOT', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:642:24)

  ‚óè Bitwise Engineering Functions ‚Ä∫ Bitwise integration tests ‚Ä∫ XOR with all 1s is equivalent to NOT

    expect(received).toBe(expected) // Object.is equality

    Expected: 213
    Received: [Error: #NAME?]

      648 |       const mask = 255;
      649 |       const result = evaluate(`=BITXOR(${a}, ${mask})`);
    > 650 |       expect(result).toBe(213); // ~42 in 8-bit = 213
          |                      ^
      651 |     });
      652 |
      653 |     test('combining operations', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:650:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ Bitwise integration tests ‚Ä∫ combining operations

    expect(received).toBe(expected) // Object.is equality

    Expected: 42
    Received: [Error: #NAME?]

      664 |       
      665 |       // Result should be A masked to 8 bits
    > 666 |       expect(result).toBe(a);
          |                      ^
      667 |     });
      668 |
      669 |     test('shift and AND for masking', () => {

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:666:22)

  ‚óè Bitwise Engineering Functions ‚Ä∫ Bitwise integration tests ‚Ä∫ shift and AND for masking

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NAME?]

      675 |       const masked = evaluate(`=BITAND(${shifted}, 7)`);
      676 |       
    > 677 |       expect(masked).toBe(5); // bits 2-4 are 101 = 5
          |                      ^
      678 |     });
      679 |   });
      680 | });

      at Object.<anonymous> (__tests__/functions/engineering.test.ts:677:22)

FAIL packages/core/__tests__/functions/engineering-advanced.test.ts (5.14 s)
  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should add two complex numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "4+6i"
    Received: [Error: #NAME?]

      30 |   describe('IMADD', () => {
      31 |     test('should add two complex numbers', () => {
    > 32 |       expect(evaluate('=IMADD("3+4i", "1+2i")')).toBe('4+6i');
         |                                                  ^
      33 |     });
      34 |
      35 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:32:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should handle j suffix

    expect(received).toBe(expected) // Object.is equality

    Expected: "4+6j"
    Received: [Error: #NAME?]

      34 |
      35 |     test('should handle j suffix', () => {
    > 36 |       expect(evaluate('=IMADD("3+4j", "1+2j")')).toBe('4+6j');
         |                                                  ^
      37 |     });
      38 |
      39 |     test('should handle negative imaginary parts', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:36:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should handle negative imaginary parts

    expect(received).toBe(expected) // Object.is equality

    Expected: "8-2i"
    Received: [Error: #NAME?]

      38 |
      39 |     test('should handle negative imaginary parts', () => {
    > 40 |       expect(evaluate('=IMADD("5+2i", "3-4i")')).toBe('8-2i');
         |                                                  ^
      41 |     });
      42 |
      43 |     test('should handle real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:40:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should handle real numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "8"
    Received: [Error: #NAME?]

      42 |
      43 |     test('should handle real numbers', () => {
    > 44 |       expect(evaluate('=IMADD("5", "3")')).toBe('8');
         |                                            ^
      45 |     });
      46 |
      47 |     test('should handle purely imaginary numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:44:44)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should handle purely imaginary numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "5i"
    Received: [Error: #NAME?]

      46 |
      47 |     test('should handle purely imaginary numbers', () => {
    > 48 |       expect(evaluate('=IMADD("3i", "2i")')).toBe('5i');
         |                                              ^
      49 |     });
      50 |
      51 |     test('should handle zero results', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:48:46)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMADD ‚Ä∫ should handle zero results

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      50 |
      51 |     test('should handle zero results', () => {
    > 52 |       expect(evaluate('=IMADD("3+2i", "-3-2i")')).toBe('0');
         |                                                   ^
      53 |     });
      54 |   });
      55 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:52:51)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should subtract two complex numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "3+3i"
    Received: [Error: #NAME?]

      59 |   describe('IMSUB', () => {
      60 |     test('should subtract two complex numbers', () => {
    > 61 |       expect(evaluate('=IMSUB("5+6i", "2+3i")')).toBe('3+3i');
         |                                                  ^
      62 |     });
      63 |
      64 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:61:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should handle j suffix

    expect(received).toBe(expected) // Object.is equality

    Expected: "3+3j"
    Received: [Error: #NAME?]

      63 |
      64 |     test('should handle j suffix', () => {
    > 65 |       expect(evaluate('=IMSUB("5+6j", "2+3j")')).toBe('3+3j');
         |                                                  ^
      66 |     });
      67 |
      68 |     test('should handle negative results', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:65:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should handle negative results

    expect(received).toBe(expected) // Object.is equality

    Expected: "-3-4i"
    Received: [Error: #NAME?]

      67 |
      68 |     test('should handle negative results', () => {
    > 69 |       expect(evaluate('=IMSUB("2+3i", "5+7i")')).toBe('-3-4i');
         |                                                  ^
      70 |     });
      71 |
      72 |     test('should handle real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:69:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should handle real numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "6"
    Received: [Error: #NAME?]

      71 |
      72 |     test('should handle real numbers', () => {
    > 73 |       expect(evaluate('=IMSUB("10", "4")')).toBe('6');
         |                                             ^
      74 |     });
      75 |
      76 |     test('should handle purely imaginary numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:73:45)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should handle purely imaginary numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "3i"
    Received: [Error: #NAME?]

      75 |
      76 |     test('should handle purely imaginary numbers', () => {
    > 77 |       expect(evaluate('=IMSUB("5i", "2i")')).toBe('3i');
         |                                              ^
      78 |     });
      79 |
      80 |     test('should handle zero results', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:77:46)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSUB ‚Ä∫ should handle zero results

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      79 |
      80 |     test('should handle zero results', () => {
    > 81 |       expect(evaluate('=IMSUB("3+2i", "3+2i")')).toBe('0');
         |                                                  ^
      82 |     });
      83 |   });
      84 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:81:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should multiply two complex numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "-5+14i"
    Received: [Error: #NAME?]

      88 |   describe('IMMULT', () => {
      89 |     test('should multiply two complex numbers', () => {
    > 90 |       expect(evaluate('=IMMULT("3+2i", "1+4i")')).toBe('-5+14i');
         |                                                   ^
      91 |     });
      92 |
      93 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:90:51)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should handle j suffix

    expect(received).toBe(expected) // Object.is equality

    Expected: "-5+14j"
    Received: [Error: #NAME?]

      92 |
      93 |     test('should handle j suffix', () => {
    > 94 |       expect(evaluate('=IMMULT("3+2j", "1+4j")')).toBe('-5+14j');
         |                                                   ^
      95 |     });
      96 |
      97 |     test('should handle i*i = -1', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:94:51)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should handle i*i = -1

    expect(received).toBe(expected) // Object.is equality

    Expected: "-1"
    Received: [Error: #NAME?]

       96 |
       97 |     test('should handle i*i = -1', () => {
    >  98 |       expect(evaluate('=IMMULT("i", "i")')).toBe('-1');
          |                                             ^
       99 |     });
      100 |
      101 |     test('should handle real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:98:45)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should handle real numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "15"
    Received: [Error: #NAME?]

      100 |
      101 |     test('should handle real numbers', () => {
    > 102 |       expect(evaluate('=IMMULT("5", "3")')).toBe('15');
          |                                             ^
      103 |     });
      104 |
      105 |     test('should handle multiplication by zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:102:45)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should handle multiplication by zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      104 |
      105 |     test('should handle multiplication by zero', () => {
    > 106 |       expect(evaluate('=IMMULT("3+2i", "0")')).toBe('0');
          |                                                ^
      107 |     });
      108 |
      109 |     test('should handle negative imaginary parts', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:106:48)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMMULT ‚Ä∫ should handle negative imaginary parts

    expect(received).toBe(expected) // Object.is equality

    Expected: "23+2i"
    Received: [Error: #NAME?]

      108 |
      109 |     test('should handle negative imaginary parts', () => {
    > 110 |       expect(evaluate('=IMMULT("2+3i", "4-5i")')).toBe('23+2i');
          |                                                   ^
      111 |     });
      112 |   });
      113 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:110:51)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should divide two complex numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "0.44+0.08i"
    Received: [Error: #NAME?]

      117 |   describe('IMDIV', () => {
      118 |     test('should divide two complex numbers', () => {
    > 119 |       expect(evaluate('=IMDIV("1+2i", "3+4i")')).toBe('0.44+0.08i');
          |                                                  ^
      120 |     });
      121 |
      122 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:119:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should handle j suffix

    expect(received).toBe(expected) // Object.is equality

    Expected: "0.44+0.08j"
    Received: [Error: #NAME?]

      121 |
      122 |     test('should handle j suffix', () => {
    > 123 |       expect(evaluate('=IMDIV("1+2j", "3+4j")')).toBe('0.44+0.08j');
          |                                                  ^
      124 |     });
      125 |
      126 |     test('should handle division by real number', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:123:50)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should handle division by real number

    expect(received).toMatch(expected)

    Expected pattern: /2\+1?i/
    Received string:  "Error: #NAME?"

      126 |     test('should handle division by real number', () => {
      127 |       const result = String(evaluate('=IMDIV("4+2i", "2")'));
    > 128 |       expect(result).toMatch(/2\+1?i/); // Handles both "2+i" and "2+1i"
          |                      ^
      129 |     });
      130 |
      131 |     test('should return error for division by zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:128:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should return error for division by zero

    expect(received).toMatch(expected)

    Expected pattern: /#NUM!/
    Received string:  "Error: #NAME?"

      131 |     test('should return error for division by zero', () => {
      132 |       const result = evaluate('=IMDIV("5+3i", "0")');
    > 133 |       expect(String(result)).toMatch(/#NUM!/);
          |                              ^
      134 |     });
      135 |
      136 |     test('should handle negative imaginary parts', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:133:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should handle negative imaginary parts

    expect(received).toBe(expected) // Object.is equality

    Expected: "4+2i"
    Received: [Error: #NAME?]

      135 |
      136 |     test('should handle negative imaginary parts', () => {
    > 137 |       expect(evaluate('=IMDIV("10", "2-i")')).toBe('4+2i');
          |                                               ^
      138 |     });
      139 |
      140 |     test('should handle purely imaginary divisor', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:137:47)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMDIV ‚Ä∫ should handle purely imaginary divisor

    expect(received).toBe(expected) // Object.is equality

    Expected: "-2i"
    Received: [Error: #NAME?]

      139 |
      140 |     test('should handle purely imaginary divisor', () => {
    > 141 |       expect(evaluate('=IMDIV("4", "2i")')).toBe('-2i');
          |                                             ^
      142 |     });
      143 |   });
      144 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:141:45)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should raise complex number to integer power

    expect(received).toMatch(expected)

    Expected pattern: /[\d.e\-+]+\+2(\.\d+)?i/
    Received string:  "Error: #NAME?"

      150 |       const result = String(evaluate('=IMPOWER("1+i", 2)'));
      151 |       // (1+i)^2 = 2i, allowing for floating point errors
    > 152 |       expect(result).toMatch(/[\d.e\-+]+\+2(\.\d+)?i/);
          |                      ^
      153 |     });
      154 |
      155 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:152:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /[\d.e\-+]+\+2(\.\d+)?j/
    Received string:  "Error: #NAME?"

      155 |     test('should handle j suffix', () => {
      156 |       const result = String(evaluate('=IMPOWER("1+j", 2)'));
    > 157 |       expect(result).toMatch(/[\d.e\-+]+\+2(\.\d+)?j/);
          |                      ^
      158 |     });
      159 |
      160 |     test('should handle power of 0', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:157:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should handle power of 0

    expect(received).toBe(expected) // Object.is equality

    Expected: "1"
    Received: [Error: #NAME?]

      159 |
      160 |     test('should handle power of 0', () => {
    > 161 |       expect(evaluate('=IMPOWER("3+4i", 0)')).toBe('1');
          |                                               ^
      162 |     });
      163 |
      164 |     test('should handle power of 1', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:161:47)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should handle power of 1

    expect(received).toMatch(expected)

    Expected pattern: /3(\.\d+)?\+3\.99\d+i|3\+4i/
    Received string:  "Error: #NAME?"

      165 |       const result = String(evaluate('=IMPOWER("3+4i", 1)'));
      166 |       // Should be 3+4i with possible floating point errors
    > 167 |       expect(result).toMatch(/3(\.\d+)?\+3\.99\d+i|3\+4i/);
          |                      ^
      168 |     });
      169 |
      170 |     test('should handle negative power', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:167:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should handle negative power

    expect(received).toBe(expected) // Object.is equality

    Expected: "0.5"
    Received: [Error: #NAME?]

      170 |     test('should handle negative power', () => {
      171 |       const result = evaluate('=IMPOWER("2", -1)');
    > 172 |       expect(result).toBe('0.5');
          |                      ^
      173 |     });
      174 |
      175 |     test('should handle fractional power', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:172:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMPOWER ‚Ä∫ should handle fractional power

    expect(received).toBe(expected) // Object.is equality

    Expected: "2"
    Received: [Error: #NAME?]

      175 |     test('should handle fractional power', () => {
      176 |       const result = evaluate('=IMPOWER("4", 0.5)');
    > 177 |       expect(result).toBe('2');
          |                      ^
      178 |     });
      179 |   });
      180 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:177:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSQRT ‚Ä∫ should calculate square root of complex number

    expect(received).toMatch(expected)

    Expected pattern: /1\.41421\d+\+1\.41421\d+i/
    Received string:  "Error: #NAME?"

      185 |     test('should calculate square root of complex number', () => {
      186 |       const result = String(evaluate('=IMSQRT("0+4i")'));
    > 187 |       expect(result).toMatch(/1\.41421\d+\+1\.41421\d+i/);
          |                      ^
      188 |     });
      189 |
      190 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:187:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSQRT ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /1\.41421\d+\+1\.41421\d+j/
    Received string:  "Error: #NAME?"

      190 |     test('should handle j suffix', () => {
      191 |       const result = String(evaluate('=IMSQRT("0+4j")'));
    > 192 |       expect(result).toMatch(/1\.41421\d+\+1\.41421\d+j/);
          |                      ^
      193 |     });
      194 |
      195 |     test('should handle real positive numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:192:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSQRT ‚Ä∫ should handle real positive numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "2"
    Received: [Error: #NAME?]

      194 |
      195 |     test('should handle real positive numbers', () => {
    > 196 |       expect(evaluate('=IMSQRT("4")')).toBe('2');
          |                                        ^
      197 |     });
      198 |
      199 |     test('should handle real negative numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:196:40)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSQRT ‚Ä∫ should handle real negative numbers

    expect(received).toMatch(expected)

    Expected pattern: /[\d.e\-+]*\+?2i/
    Received string:  "Error: #NAME?"

      200 |       const result = String(evaluate('=IMSQRT("-4")'));
      201 |       // Allow small real component near zero
    > 202 |       expect(result).toMatch(/[\d.e\-+]*\+?2i/);
          |                      ^
      203 |     });
      204 |
      205 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:202:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSQRT ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      204 |
      205 |     test('should handle zero', () => {
    > 206 |       expect(evaluate('=IMSQRT("0")')).toBe('0');
          |                                        ^
      207 |     });
      208 |   });
      209 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:206:40)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMEXP ‚Ä∫ should calculate exponential of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.54030\d+\+0\.84147\d+i/
    Received string:  "Error: #NAME?"

      214 |     test('should calculate exponential of complex number', () => {
      215 |       const result = evaluate('=IMEXP("0+i")');
    > 216 |       expect(String(result)).toMatch(/0\.54030\d+\+0\.84147\d+i/);
          |                              ^
      217 |     });
      218 |
      219 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:216:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMEXP ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.54030\d+\+0\.84147\d+j/
    Received string:  "Error: #NAME?"

      219 |     test('should handle j suffix', () => {
      220 |       const result = evaluate('=IMEXP("0+j")');
    > 221 |       expect(String(result)).toMatch(/0\.54030\d+\+0\.84147\d+j/);
          |                              ^
      222 |     });
      223 |
      224 |     test('should handle real numbers (e^x)', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:221:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMEXP ‚Ä∫ should handle real numbers (e^x)

    expect(received).toMatch(expected)

    Expected pattern: /2\.71828\d+/
    Received string:  "Error: #NAME?"

      224 |     test('should handle real numbers (e^x)', () => {
      225 |       const result = evaluate('=IMEXP("1")');
    > 226 |       expect(String(result)).toMatch(/2\.71828\d+/);
          |                              ^
      227 |     });
      228 |
      229 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:226:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMEXP ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "1"
    Received: [Error: #NAME?]

      228 |
      229 |     test('should handle zero', () => {
    > 230 |       expect(evaluate('=IMEXP("0")')).toBe('1');
          |                                       ^
      231 |     });
      232 |   });
      233 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:230:39)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLN ‚Ä∫ should calculate natural logarithm of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.34657\d+\+0\.78539\d+i/
    Received string:  "Error: #NAME?"

      238 |     test('should calculate natural logarithm of complex number', () => {
      239 |       const result = evaluate('=IMLN("1+i")');
    > 240 |       expect(String(result)).toMatch(/0\.34657\d+\+0\.78539\d+i/);
          |                              ^
      241 |     });
      242 |
      243 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:240:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLN ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.34657\d+\+0\.78539\d+j/
    Received string:  "Error: #NAME?"

      243 |     test('should handle j suffix', () => {
      244 |       const result = evaluate('=IMLN("1+j")');
    > 245 |       expect(String(result)).toMatch(/0\.34657\d+\+0\.78539\d+j/);
          |                              ^
      246 |     });
      247 |
      248 |     test('should handle positive real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:245:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLN ‚Ä∫ should handle positive real numbers

    expect(received).toMatch(expected)

    Expected pattern: /0\.99999\d+|1\.0+/
    Received string:  "Error: #NAME?"

      248 |     test('should handle positive real numbers', () => {
      249 |       const result = String(evaluate('=IMLN("2.71828")'));
    > 250 |       expect(result).toMatch(/0\.99999\d+|1\.0+/); // Close to 1
          |                      ^
      251 |     });
      252 |
      253 |     test('should handle negative real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:250:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLN ‚Ä∫ should handle negative real numbers

    expect(received).toMatch(expected)

    Expected pattern: /3\.14159\d+i/
    Received string:  "Error: #NAME?"

      254 |       const result = String(evaluate('=IMLN("-1")'));
      255 |       // May return just "3.14159...i" without leading "0+"
    > 256 |       expect(result).toMatch(/3\.14159\d+i/);
          |                      ^
      257 |     });
      258 |   });
      259 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:256:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG10 ‚Ä∫ should calculate base-10 logarithm of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.15051\d+\+0\.34109\d+i/
    Received string:  "Error: #NAME?"

      264 |     test('should calculate base-10 logarithm of complex number', () => {
      265 |       const result = evaluate('=IMLOG10("1+i")');
    > 266 |       expect(String(result)).toMatch(/0\.15051\d+\+0\.34109\d+i/);
          |                              ^
      267 |     });
      268 |
      269 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:266:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG10 ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.15051\d+\+0\.34109\d+j/
    Received string:  "Error: #NAME?"

      269 |     test('should handle j suffix', () => {
      270 |       const result = evaluate('=IMLOG10("1+j")');
    > 271 |       expect(String(result)).toMatch(/0\.15051\d+\+0\.34109\d+j/);
          |                              ^
      272 |     });
      273 |
      274 |     test('should handle powers of 10', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:271:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG10 ‚Ä∫ should handle powers of 10

    expect(received).toBe(expected) // Object.is equality

    Expected: "2"
    Received: [Error: #NAME?]

      273 |
      274 |     test('should handle powers of 10', () => {
    > 275 |       expect(evaluate('=IMLOG10("100")')).toBe('2');
          |                                           ^
      276 |     });
      277 |   });
      278 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:275:43)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG2 ‚Ä∫ should calculate base-2 logarithm of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.5(0+)?\d*\+1\.133\d+i/
    Received string:  "Error: #NAME?"

      283 |     test('should calculate base-2 logarithm of complex number', () => {
      284 |       const result = evaluate('=IMLOG2("1+i")');
    > 285 |       expect(String(result)).toMatch(/0\.5(0+)?\d*\+1\.133\d+i/);
          |                              ^
      286 |     });
      287 |
      288 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:285:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG2 ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.5(0+)?\d*\+1\.133\d+j/
    Received string:  "Error: #NAME?"

      288 |     test('should handle j suffix', () => {
      289 |       const result = evaluate('=IMLOG2("1+j")');
    > 290 |       expect(String(result)).toMatch(/0\.5(0+)?\d*\+1\.133\d+j/);
          |                              ^
      291 |     });
      292 |
      293 |     test('should handle powers of 2', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:290:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMLOG2 ‚Ä∫ should handle powers of 2

    expect(received).toBe(expected) // Object.is equality

    Expected: "3"
    Received: [Error: #NAME?]

      292 |
      293 |     test('should handle powers of 2', () => {
    > 294 |       expect(evaluate('=IMLOG2("8")')).toBe('3');
          |                                        ^
      295 |     });
      296 |   });
      297 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:294:40)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSIN ‚Ä∫ should calculate sine of complex number

    expect(received).toMatch(expected)

    Expected pattern: /1\.29845\d+\+0\.63496\d+i/
    Received string:  "Error: #NAME?"

      302 |     test('should calculate sine of complex number', () => {
      303 |       const result = evaluate('=IMSIN("1+i")');
    > 304 |       expect(String(result)).toMatch(/1\.29845\d+\+0\.63496\d+i/);
          |                              ^
      305 |     });
      306 |
      307 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:304:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSIN ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /1\.29845\d+\+0\.63496\d+j/
    Received string:  "Error: #NAME?"

      307 |     test('should handle j suffix', () => {
      308 |       const result = evaluate('=IMSIN("1+j")');
    > 309 |       expect(String(result)).toMatch(/1\.29845\d+\+0\.63496\d+j/);
          |                              ^
      310 |     });
      311 |
      312 |     test('should handle real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:309:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSIN ‚Ä∫ should handle real numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      312 |     test('should handle real numbers', () => {
      313 |       const result = evaluate('=IMSIN("0")');
    > 314 |       expect(result).toBe('0');
          |                      ^
      315 |     });
      316 |   });
      317 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:314:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOS ‚Ä∫ should calculate cosine of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.83373\d+-0\.98889\d+i/
    Received string:  "Error: #NAME?"

      322 |     test('should calculate cosine of complex number', () => {
      323 |       const result = evaluate('=IMCOS("1+i")');
    > 324 |       expect(String(result)).toMatch(/0\.83373\d+-0\.98889\d+i/);
          |                              ^
      325 |     });
      326 |
      327 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:324:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOS ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.83373\d+-0\.98889\d+j/
    Received string:  "Error: #NAME?"

      327 |     test('should handle j suffix', () => {
      328 |       const result = evaluate('=IMCOS("1+j")');
    > 329 |       expect(String(result)).toMatch(/0\.83373\d+-0\.98889\d+j/);
          |                              ^
      330 |     });
      331 |
      332 |     test('should handle real numbers', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:329:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOS ‚Ä∫ should handle real numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: "1"
    Received: [Error: #NAME?]

      332 |     test('should handle real numbers', () => {
      333 |       const result = evaluate('=IMCOS("0")');
    > 334 |       expect(result).toBe('1');
          |                      ^
      335 |     });
      336 |   });
      337 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:334:22)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMTAN ‚Ä∫ should calculate tangent of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.27175\d+\+1\.08392\d+i/
    Received string:  "Error: #NAME?"

      342 |     test('should calculate tangent of complex number', () => {
      343 |       const result = evaluate('=IMTAN("1+i")');
    > 344 |       expect(String(result)).toMatch(/0\.27175\d+\+1\.08392\d+i/);
          |                              ^
      345 |     });
      346 |
      347 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:344:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMTAN ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.27175\d+\+1\.08392\d+j/
    Received string:  "Error: #NAME?"

      347 |     test('should handle j suffix', () => {
      348 |       const result = evaluate('=IMTAN("1+j")');
    > 349 |       expect(String(result)).toMatch(/0\.27175\d+\+1\.08392\d+j/);
          |                              ^
      350 |     });
      351 |
      352 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:349:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMTAN ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      351 |
      352 |     test('should handle zero', () => {
    > 353 |       expect(evaluate('=IMTAN("0")')).toBe('0');
          |                                       ^
      354 |     });
      355 |   });
      356 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:353:39)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSEC ‚Ä∫ should calculate secant of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.49833\d+\+0\.59108\d+[ij]/
    Received string:  "Error: #NAME?"

      361 |     test('should calculate secant of complex number', () => {
      362 |       const result = evaluate('=IMSEC("1+i")');
    > 363 |       expect(String(result)).toMatch(/0\.49833\d+\+0\.59108\d+[ij]/);
          |                              ^
      364 |     });
      365 |
      366 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:363:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSEC ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.49833\d+\+0\.59108\d+[ij]/
    Received string:  "Error: #NAME?"

      366 |     test('should handle j suffix', () => {
      367 |       const result = evaluate('=IMSEC("1+j")');
    > 368 |       expect(String(result)).toMatch(/0\.49833\d+\+0\.59108\d+[ij]/);
          |                              ^
      369 |     });
      370 |   });
      371 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:368:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCSC ‚Ä∫ should calculate cosecant of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.62151\d+-0\.30393\d+[ij]/
    Received string:  "Error: #NAME?"

      376 |     test('should calculate cosecant of complex number', () => {
      377 |       const result = evaluate('=IMCSC("1+i")');
    > 378 |       expect(String(result)).toMatch(/0\.62151\d+-0\.30393\d+[ij]/);
          |                              ^
      379 |     });
      380 |
      381 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:378:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCSC ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.62151\d+-0\.30393\d+[ij]/
    Received string:  "Error: #NAME?"

      381 |     test('should handle j suffix', () => {
      382 |       const result = evaluate('=IMCSC("1+j")');
    > 383 |       expect(String(result)).toMatch(/0\.62151\d+-0\.30393\d+[ij]/);
          |                              ^
      384 |     });
      385 |   });
      386 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:383:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOT ‚Ä∫ should calculate cotangent of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.21762\d+-0\.86801\d+i/
    Received string:  "Error: #NAME?"

      391 |     test('should calculate cotangent of complex number', () => {
      392 |       const result = evaluate('=IMCOT("1+i")');
    > 393 |       expect(String(result)).toMatch(/0\.21762\d+-0\.86801\d+i/);
          |                              ^
      394 |     });
      395 |
      396 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:393:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOT ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.21762\d+-0\.86801\d+j/
    Received string:  "Error: #NAME?"

      396 |     test('should handle j suffix', () => {
      397 |       const result = evaluate('=IMCOT("1+j")');
    > 398 |       expect(String(result)).toMatch(/0\.21762\d+-0\.86801\d+j/);
          |                              ^
      399 |     });
      400 |   });
      401 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:398:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSINH ‚Ä∫ should calculate hyperbolic sine of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.63496\d+\+1\.29845\d+i/
    Received string:  "Error: #NAME?"

      406 |     test('should calculate hyperbolic sine of complex number', () => {
      407 |       const result = evaluate('=IMSINH("1+i")');
    > 408 |       expect(String(result)).toMatch(/0\.63496\d+\+1\.29845\d+i/);
          |                              ^
      409 |     });
      410 |
      411 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:408:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSINH ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.63496\d+\+1\.29845\d+j/
    Received string:  "Error: #NAME?"

      411 |     test('should handle j suffix', () => {
      412 |       const result = evaluate('=IMSINH("1+j")');
    > 413 |       expect(String(result)).toMatch(/0\.63496\d+\+1\.29845\d+j/);
          |                              ^
      414 |     });
      415 |
      416 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:413:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSINH ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "0"
    Received: [Error: #NAME?]

      415 |
      416 |     test('should handle zero', () => {
    > 417 |       expect(evaluate('=IMSINH("0")')).toBe('0');
          |                                        ^
      418 |     });
      419 |   });
      420 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:417:40)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOSH ‚Ä∫ should calculate hyperbolic cosine of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.83373\d+\+0\.98889\d+i/
    Received string:  "Error: #NAME?"

      425 |     test('should calculate hyperbolic cosine of complex number', () => {
      426 |       const result = evaluate('=IMCOSH("1+i")');
    > 427 |       expect(String(result)).toMatch(/0\.83373\d+\+0\.98889\d+i/);
          |                              ^
      428 |     });
      429 |
      430 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:427:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOSH ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.83373\d+\+0\.98889\d+j/
    Received string:  "Error: #NAME?"

      430 |     test('should handle j suffix', () => {
      431 |       const result = evaluate('=IMCOSH("1+j")');
    > 432 |       expect(String(result)).toMatch(/0\.83373\d+\+0\.98889\d+j/);
          |                              ^
      433 |     });
      434 |
      435 |     test('should handle zero', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:432:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCOSH ‚Ä∫ should handle zero

    expect(received).toBe(expected) // Object.is equality

    Expected: "1"
    Received: [Error: #NAME?]

      434 |
      435 |     test('should handle zero', () => {
    > 436 |       expect(evaluate('=IMCOSH("0")')).toBe('1');
          |                                        ^
      437 |     });
      438 |   });
      439 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:436:40)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSECH ‚Ä∫ should calculate hyperbolic secant of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.49833\d+-0\.59108\d+[ij]/
    Received string:  "Error: #NAME?"

      444 |     test('should calculate hyperbolic secant of complex number', () => {
      445 |       const result = evaluate('=IMSECH("1+i")');
    > 446 |       expect(String(result)).toMatch(/0\.49833\d+-0\.59108\d+[ij]/);
          |                              ^
      447 |     });
      448 |
      449 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:446:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMSECH ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.49833\d+-0\.59108\d+[ij]/
    Received string:  "Error: #NAME?"

      449 |     test('should handle j suffix', () => {
      450 |       const result = evaluate('=IMSECH("1+j")');
    > 451 |       expect(String(result)).toMatch(/0\.49833\d+-0\.59108\d+[ij]/);
          |                              ^
      452 |     });
      453 |   });
      454 |

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:451:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCSCH ‚Ä∫ should calculate hyperbolic cosecant of complex number

    expect(received).toMatch(expected)

    Expected pattern: /0\.30393\d+-0\.62151\d+[ij]/
    Received string:  "Error: #NAME?"

      459 |     test('should calculate hyperbolic cosecant of complex number', () => {
      460 |       const result = evaluate('=IMCSCH("1+i")');
    > 461 |       expect(String(result)).toMatch(/0\.30393\d+-0\.62151\d+[ij]/);
          |                              ^
      462 |     });
      463 |
      464 |     test('should handle j suffix', () => {

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:461:30)

  ‚óè Week 11 Day 4: Engineering Advanced Functions ‚Ä∫ IMCSCH ‚Ä∫ should handle j suffix

    expect(received).toMatch(expected)

    Expected pattern: /0\.30393\d+-0\.62151\d+[ij]/
    Received string:  "Error: #NAME?"

      464 |     test('should handle j suffix', () => {
      465 |       const result = evaluate('=IMCSCH("1+j")');
    > 466 |       expect(String(result)).toMatch(/0\.30393\d+-0\.62151\d+[ij]/);
          |                              ^
      467 |     });
      468 |   });
      469 | });

      at Object.<anonymous> (__tests__/functions/engineering-advanced.test.ts:466:30)

FAIL packages/core/__tests__/functions/financial-week1-day5.test.ts (5.141 s)
  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ AMORLINC - Linear Depreciation (French Accounting) ‚Ä∫ Oracle Test 1: First period depreciation

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      33 |       
      34 |       const result = evaluate('=AMORLINC(2400, 39679, 39813, 300, 1, 0.15, 1)');
    > 35 |       expect(typeof result).toBe('number');
         |                             ^
      36 |       expect(result as number).toBeGreaterThan(0);
      37 |     });
      38 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:35:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ AMORLINC - Linear Depreciation (French Accounting) ‚Ä∫ Oracle Test 2: Period 0 (prorated)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      39 |     test('Oracle Test 2: Period 0 (prorated)', () => {
      40 |       const result = evaluate('=AMORLINC(2400, 39679, 39813, 300, 0, 0.15, 1)');
    > 41 |       expect(typeof result).toBe('number');
         |                             ^
      42 |       expect(result as number).toBeGreaterThan(0);
      43 |     });
      44 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:41:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ AMORLINC - Linear Depreciation (French Accounting) ‚Ä∫ Oracle Test 3: Higher rate (shorter life)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      46 |       // Rate 0.25 means 4-year life
      47 |       const result = evaluate('=AMORLINC(10000, 39679, 39813, 1000, 1, 0.25, 1)');
    > 48 |       expect(typeof result).toBe('number');
         |                             ^
      49 |       expect(result as number).toBeGreaterThan(0);
      50 |     });
      51 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:48:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ AMORLINC - Linear Depreciation (French Accounting) ‚Ä∫ Oracle Test 4: Lower rate (longer life)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      53 |       // Rate 0.10 means 10-year life
      54 |       const result = evaluate('=AMORLINC(10000, 39679, 39813, 1000, 1, 0.10, 1)');
    > 55 |       expect(typeof result).toBe('number');
         |                             ^
      56 |       expect(result as number).toBeGreaterThan(0);
      57 |     });
      58 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:55:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ AMORLINC - Linear Depreciation (French Accounting) ‚Ä∫ Oracle Test 5: Later period

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      59 |     test('Oracle Test 5: Later period', () => {
      60 |       const result = evaluate('=AMORLINC(2400, 39679, 39813, 300, 3, 0.15, 1)');
    > 61 |       expect(typeof result).toBe('number');
         |                             ^
      62 |       expect(result as number).toBeGreaterThanOrEqual(0);
      63 |     });
      64 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:61:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINT - Accrued Interest (Periodic) ‚Ä∫ Oracle Test 1: Basic accrued interest

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      81 |       
      82 |       const result = evaluate('=ACCRINT(39494, 39535, 39600, 0.1, 1000, 2, 0)');
    > 83 |       expect(typeof result).toBe('number');
         |                             ^
      84 |       expect(result as number).toBeGreaterThan(0);
      85 |       expect(result as number).toBeLessThan(100); // Should be less than one period's interest
      86 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:83:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINT - Accrued Interest (Periodic) ‚Ä∫ Oracle Test 2: Different frequency (quarterly)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      88 |     test('Oracle Test 2: Different frequency (quarterly)', () => {
      89 |       const result = evaluate('=ACCRINT(39494, 39535, 39600, 0.1, 1000, 4, 0)');
    > 90 |       expect(typeof result).toBe('number');
         |                             ^
      91 |       expect(result as number).toBeGreaterThan(0);
      92 |     });
      93 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:90:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINT - Accrued Interest (Periodic) ‚Ä∫ Oracle Test 3: Annual payments

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      94 |     test('Oracle Test 3: Annual payments', () => {
      95 |       const result = evaluate('=ACCRINT(39494, 39535, 39600, 0.1, 1000, 1, 0)');
    > 96 |       expect(typeof result).toBe('number');
         |                             ^
      97 |       expect(result as number).toBeGreaterThan(0);
      98 |     });
      99 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:96:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINT - Accrued Interest (Periodic) ‚Ä∫ Oracle Test 4: Higher rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      100 |     test('Oracle Test 4: Higher rate', () => {
      101 |       const result = evaluate('=ACCRINT(39494, 39535, 39600, 0.15, 1000, 2, 0)');
    > 102 |       expect(typeof result).toBe('number');
          |                             ^
      103 |       expect(result as number).toBeGreaterThan(0);
      104 |     });
      105 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:102:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINT - Accrued Interest (Periodic) ‚Ä∫ Oracle Test 5: Different par value

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      106 |     test('Oracle Test 5: Different par value', () => {
      107 |       const result = evaluate('=ACCRINT(39494, 39535, 39600, 0.1, 5000, 2, 0)');
    > 108 |       expect(typeof result).toBe('number');
          |                             ^
      109 |       expect(result as number).toBeGreaterThan(0);
      110 |     });
      111 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:108:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINTM - Accrued Interest at Maturity ‚Ä∫ Oracle Test 1: Basic accrued interest at maturity

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      127 |       
      128 |       const result = evaluate('=ACCRINTM(39539, 39615, 0.1, 1000, 0)');
    > 129 |       expect(typeof result).toBe('number');
          |                             ^
      130 |       expect(result as number).toBeGreaterThan(0);
      131 |       expect(result as number).toBeLessThan(100); // Less than one year's interest
      132 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:129:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINTM - Accrued Interest at Maturity ‚Ä∫ Oracle Test 2: Higher rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      134 |     test('Oracle Test 2: Higher rate', () => {
      135 |       const result = evaluate('=ACCRINTM(39539, 39615, 0.15, 1000, 0)');
    > 136 |       expect(typeof result).toBe('number');
          |                             ^
      137 |       expect(result as number).toBeGreaterThan(0);
      138 |     });
      139 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:136:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINTM - Accrued Interest at Maturity ‚Ä∫ Oracle Test 3: Longer period

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      141 |       // One year period
      142 |       const result = evaluate('=ACCRINTM(39539, 39904, 0.1, 1000, 0)');
    > 143 |       expect(typeof result).toBe('number');
          |                             ^
      144 |       expect(result as number).toBeCloseTo(101.39, 2); // Actual accrued interest
      145 |     });
      146 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:143:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINTM - Accrued Interest at Maturity ‚Ä∫ Oracle Test 4: Different par value

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      147 |     test('Oracle Test 4: Different par value', () => {
      148 |       const result = evaluate('=ACCRINTM(39539, 39615, 0.1, 5000, 0)');
    > 149 |       expect(typeof result).toBe('number');
          |                             ^
      150 |       expect(result as number).toBeGreaterThan(0);
      151 |     });
      152 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:149:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ ACCRINTM - Accrued Interest at Maturity ‚Ä∫ Oracle Test 5: Different basis (actual/365)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      153 |     test('Oracle Test 5: Different basis (actual/365)', () => {
      154 |       const result = evaluate('=ACCRINTM(39539, 39615, 0.1, 1000, 3)');
    > 155 |       expect(typeof result).toBe('number');
          |                             ^
      156 |       expect(result as number).toBeGreaterThan(0);
      157 |     });
      158 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:155:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 1: Basic bond pricing

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      175 |       
      176 |       const result = evaluate('=PRICE(39508, 43054, 0.0575, 0.065, 100, 2, 0)');
    > 177 |       expect(typeof result).toBe('number');
          |                             ^
      178 |       expect(result as number).toBeGreaterThan(0);
      179 |       expect(result as number).toBeLessThan(150); // Reasonable price range
      180 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:177:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 2: Price at par (rate = yield)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      183 |       // When coupon rate equals yield, price should be close to redemption value
      184 |       const result = evaluate('=PRICE(39508, 43054, 0.065, 0.065, 100, 2, 0)');
    > 185 |       expect(typeof result).toBe('number');
          |                             ^
      186 |       expect(result as number).toBeCloseTo(100, 1);
      187 |     });
      188 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:185:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 3: Premium bond (rate > yield)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      190 |       // Higher coupon than yield = premium
      191 |       const result = evaluate('=PRICE(39508, 43054, 0.08, 0.065, 100, 2, 0)');
    > 192 |       expect(typeof result).toBe('number');
          |                             ^
      193 |       expect(result as number).toBeGreaterThan(100);
      194 |     });
      195 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:192:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 4: Discount bond (rate < yield)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      197 |       // Lower coupon than yield = discount
      198 |       const result = evaluate('=PRICE(39508, 43054, 0.05, 0.065, 100, 2, 0)');
    > 199 |       expect(typeof result).toBe('number');
          |                             ^
      200 |       expect(result as number).toBeLessThan(100);
      201 |     });
      202 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:199:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 5: Annual payments

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      203 |     test('Oracle Test 5: Annual payments', () => {
      204 |       const result = evaluate('=PRICE(39508, 43054, 0.0575, 0.065, 100, 1, 0)');
    > 205 |       expect(typeof result).toBe('number');
          |                             ^
      206 |       expect(result as number).toBeGreaterThan(0);
      207 |     });
      208 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:205:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ PRICE - Bond Price ‚Ä∫ Oracle Test 6: Quarterly payments

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      209 |     test('Oracle Test 6: Quarterly payments', () => {
      210 |       const result = evaluate('=PRICE(39508, 43054, 0.0575, 0.065, 100, 4, 0)');
    > 211 |       expect(typeof result).toBe('number');
          |                             ^
      212 |       expect(result as number).toBeGreaterThan(0);
      213 |     });
      214 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:211:29)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ Integration Tests ‚Ä∫ AMORLINC produces constant depreciation per period

    expect(received).toBeLessThan(expected)

    Expected: < 0.1
    Received:   NaN

      231 |       
      232 |       // Periods 1 and 2 should be similar (within 10%)
    > 233 |       expect(Math.abs(period1 - period2) / period1).toBeLessThan(0.1);
          |                                                     ^
      234 |     });
      235 |
      236 |     test('ACCRINT and ACCRINTM both calculate accrued interest', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:233:53)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ Integration Tests ‚Ä∫ ACCRINT and ACCRINTM both calculate accrued interest

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      239 |       const accrintm = evaluate('=ACCRINTM(39494, 39600, 0.1, 1000, 0)');
      240 |       
    > 241 |       expect(typeof accrint).toBe('number');
          |                              ^
      242 |       expect(typeof accrintm).toBe('number');
      243 |       expect(accrint as number).toBeGreaterThan(0);
      244 |       expect(accrintm as number).toBeGreaterThan(0);

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:241:30)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ Integration Tests ‚Ä∫ PRICE responds correctly to yield changes

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has type:  object
    Received has value: [Error: #NAME?]

      250 |       const priceYield7 = evaluate('=PRICE(39508, 43054, 0.0575, 0.07, 100, 2, 0)') as number;
      251 |       
    > 252 |       expect(priceYield5).toBeGreaterThan(priceYield7);
          |                           ^
      253 |     });
      254 |
      255 |     test('All functions handle valid inputs', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:252:27)

  ‚óè Financial Functions - Week 1 Day 5 (AMORLINC, ACCRINT, ACCRINTM, PRICE) ‚Ä∫ Integration Tests ‚Ä∫ All functions handle valid inputs

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      259 |       const price = evaluate('=PRICE(39508, 43054, 0.06, 0.065, 100, 2, 0)');
      260 |       
    > 261 |       expect(typeof amorlinc).toBe('number');
          |                               ^
      262 |       expect(typeof accrint).toBe('number');
      263 |       expect(typeof accrintm).toBe('number');
      264 |       expect(typeof price).toBe('number');

      at Object.<anonymous> (__tests__/functions/financial-week1-day5.test.ts:261:31)

FAIL packages/core/__tests__/functions/financial-irr.test.ts (5.259 s)
  ‚óè Financial Functions - Week 8 Day 5 (IRR/XIRR) ‚Ä∫ IRR (Internal Rate of Return) ‚Ä∫ IRR with equal cash flows (annuity)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      74 |       
      75 |       const result = evaluate('=IRR(D1:D6)');
    > 76 |       expect(typeof result).toBe('number');
         |                             ^
      77 |       expect(result as number).toBeGreaterThan(0);
      78 |     });
      79 |

      at Object.<anonymous> (__tests__/functions/financial-irr.test.ts:76:29)

  ‚óè Financial Functions - Week 8 Day 5 (IRR/XIRR) ‚Ä∫ IRR (Internal Rate of Return) ‚Ä∫ IRR returns #NUM! for all positive values

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

       95 |       const result = evaluate('=IRR({100, 200, 300})');
       96 |       expect(result).toBeInstanceOf(Error);
    >  97 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
       98 |     });
       99 |
      100 |     test('IRR returns #NUM! for all negative values', () => {

      at Object.<anonymous> (__tests__/functions/financial-irr.test.ts:97:41)

  ‚óè Financial Functions - Week 8 Day 5 (IRR/XIRR) ‚Ä∫ IRR (Internal Rate of Return) ‚Ä∫ IRR returns #NUM! for all negative values

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      101 |       const result = evaluate('=IRR({-100, -200, -300})');
      102 |       expect(result).toBeInstanceOf(Error);
    > 103 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      104 |     });
      105 |
      106 |     test('IRR returns #NUM! for insufficient values', () => {

      at Object.<anonymous> (__tests__/functions/financial-irr.test.ts:103:41)

FAIL packages/core/__tests__/conditional-formatting-batch-engine.test.ts
  ‚óè ConditionalFormattingBatchEngine - Step 2: Dirty Propagation Integration ‚Ä∫ 2Ô∏è‚É£ Replace Evaluate-on-render ‚Ä∫ should support legacy evaluateCellCF API but use dirty tracking internally

    expect(received).toBe(expected) // Object.is equality

    Expected: "#FFFF00"
    Received: undefined

      210 | 			// Use legacy API
      211 | 			const result1 = engine.evaluateCellCF({ row: 1, col: 1 }, { getValue });
    > 212 | 			expect(result1.style?.fillColor).toBe('#FFFF00');
          | 			                                 ^
      213 |
      214 | 			// Rule should now be clean
      215 | 			const state = engine.getRuleState('rule1');

      at Object.<anonymous> (__tests__/conditional-formatting-batch-engine.test.ts:212:37)

FAIL packages/core/__tests__/excel-oracle/excel-oracle.test.ts
  ‚óè Excel Oracle Validation - Wave 4 ‚Ä∫ Phase A: Test Infrastructure ‚Ä∫ should be able to load Excel files from test-data directory

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      37 |             // Verify test data directory exists
      38 |             const dirExists = fs.existsSync(testDataDir);
    > 39 |             expect(dirExists).toBe(true);
         |                               ^
      40 |
      41 |             if (dirExists) {
      42 |                 const files = fs.readdirSync(testDataDir);

      at Object.<anonymous> (__tests__/excel-oracle/excel-oracle.test.ts:39:31)

FAIL packages/core/__tests__/functions/financial-week1-day2.test.ts (5.015 s)
  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 1: Classic example from Excel docs

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      130 |       
      131 |       const result = evaluate('=FVSCHEDULE(1, A1:A3)');
    > 132 |       expect(typeof result).toBe('number');
          |                             ^
      133 |       expect(result as number).toBeCloseTo(1.33089, 5);
      134 |     });
      135 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:132:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 2: FVSCHEDULE with actual investment

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      143 |       
      144 |       const result = evaluate('=FVSCHEDULE(10000, A1:A4)');
    > 145 |       expect(typeof result).toBe('number');
          |                             ^
      146 |       // Manual: 10000 * 1.05 * 1.07 * 1.03 * 1.09 = 12,613.53
      147 |       expect(result as number).toBeCloseTo(12613.53, 2);
      148 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:145:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 3: FVSCHEDULE with negative rates (loss)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      157 |       
      158 |       const result = evaluate('=FVSCHEDULE(5000, A1:A4)');
    > 159 |       expect(typeof result).toBe('number');
          |                             ^
      160 |       // Manual: 5000 * 1.10 * 0.95 * 0.92 * 1.15 = 5,528.05
      161 |       expect(result as number).toBeCloseTo(5528.05, 2);
      162 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:159:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 4: FVSCHEDULE with empty schedule

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      167 |       
      168 |       // Empty cell should return principal unchanged
    > 169 |       expect(typeof result).toBe('number');
          |                             ^
      170 |       expect(result as number).toBeCloseTo(1000, 2);
      171 |     });
      172 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:169:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 5: FVSCHEDULE with single rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      175 |       
      176 |       const result = evaluate('=FVSCHEDULE(8000, A1)');
    > 177 |       expect(typeof result).toBe('number');
          |                             ^
      178 |       expect(result as number).toBeCloseTo(8960, 2); // 8000 * 1.12
      179 |     });
      180 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:177:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ FVSCHEDULE - Future Value with Variable Rates ‚Ä∫ Oracle Test 6: FVSCHEDULE precision with many periods

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      187 |       
      188 |       const result = evaluate('=FVSCHEDULE(1, A1:A10)');
    > 189 |       expect(typeof result).toBe('number');
          |                             ^
      190 |       // Calculate manually: 1 * product of (1 + rate)
      191 |       let expected = 1;
      192 |       rates.forEach(r => expected *= (1 + r));

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:189:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 1: Classic discount rate calculation

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      205 |       
      206 |       const result = evaluate(`=DISC(${settlement}, ${maturity}, 97.975, 100, 1)`);
    > 207 |       expect(typeof result).toBe('number');
          |                             ^
      208 |       // Expected based on implementation: (100-97.975)/100 * (365/141)
      209 |       expect(result as number).toBeCloseTo(0.0524, 3);
      210 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:207:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 2: DISC with 30/360 basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      215 |       
      216 |       const result = evaluate(`=DISC(${settlement}, ${maturity}, 95, 100, 0)`);
    > 217 |       expect(typeof result).toBe('number');
          |                             ^
      218 |       // (100-95)/100 * (360/365) = 0.0493
      219 |       expect(result as number).toBeCloseTo(0.0493, 3);
      220 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:217:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 3: DISC returns #NUM! when settlement >= maturity

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      223 |       const result = evaluate('=DISC(45657, 45292, 95, 100, 0)');
      224 |       expect(result).toBeInstanceOf(Error);
    > 225 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      226 |     });
      227 |
      228 |     test('Oracle Test 4: DISC returns #NUM! for negative price', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:225:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 4: DISC returns #NUM! for negative price

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      229 |       const result = evaluate('=DISC(45292, 45657, -95, 100, 0)');
      230 |       expect(result).toBeInstanceOf(Error);
    > 231 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      232 |     });
      233 |
      234 |     test('Oracle Test 5: DISC returns #NUM! for invalid basis', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:231:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 5: DISC returns #NUM! for invalid basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      235 |       const result = evaluate('=DISC(45292, 45657, 95, 100, 5)');
      236 |       expect(result).toBeInstanceOf(Error);
    > 237 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      238 |     });
      239 |
      240 |     test('Oracle Test 6: DISC with actual/360 basis', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:237:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ DISC - Discount Rate ‚Ä∫ Oracle Test 6: DISC with actual/360 basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      243 |       
      244 |       const result = evaluate(`=DISC(${settlement}, ${maturity}, 98, 100, 2)`);
    > 245 |       expect(typeof result).toBe('number');
          |                             ^
      246 |       // (100-98)/100 * (360/182) = 0.0396
      247 |       expect(result as number).toBeCloseTo(0.0396, 3);
      248 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:245:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 1: Classic INTRATE calculation

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      259 |       
      260 |       const result = evaluate(`=INTRATE(${settlement}, ${maturity}, 1000000, 1014420, 2)`);
    > 261 |       expect(typeof result).toBe('number');
          |                             ^
      262 |       // Expected based on implementation: (1014420-1000000)/1000000 * (360/89)
      263 |       expect(result as number).toBeCloseTo(0.0583, 3);
      264 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:261:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 2: INTRATE with 30/360 basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      269 |       
      270 |       const result = evaluate(`=INTRATE(${settlement}, ${maturity}, 10000, 10500, 0)`);
    > 271 |       expect(typeof result).toBe('number');
          |                             ^
      272 |       // (10500-10000)/10000 * (360/365) = 0.0493
      273 |       expect(result as number).toBeCloseTo(0.0493, 3);
      274 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:271:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 3: INTRATE returns #NUM! when settlement >= maturity

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      277 |       const result = evaluate('=INTRATE(45657, 45292, 10000, 10500, 0)');
      278 |       expect(result).toBeInstanceOf(Error);
    > 279 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      280 |     });
      281 |
      282 |     test('Oracle Test 4: INTRATE returns #NUM! for negative investment', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:279:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 4: INTRATE returns #NUM! for negative investment

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      283 |       const result = evaluate('=INTRATE(45292, 45657, -10000, 10500, 0)');
      284 |       expect(result).toBeInstanceOf(Error);
    > 285 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      286 |     });
      287 |
      288 |     test('Oracle Test 5: INTRATE returns #NUM! for invalid basis', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:285:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 5: INTRATE returns #NUM! for invalid basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "#NUM!"
    Received: "#NAME?"

      289 |       const result = evaluate('=INTRATE(45292, 45657, 10000, 10500, 6)');
      290 |       expect(result).toBeInstanceOf(Error);
    > 291 |       expect((result as Error).message).toBe('#NUM!');
          |                                         ^
      292 |     });
      293 |
      294 |     test('Oracle Test 6: INTRATE with actual/365 basis', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:291:41)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 6: INTRATE with actual/365 basis

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      297 |       
      298 |       const result = evaluate(`=INTRATE(${settlement}, ${maturity}, 5000, 5200, 3)`);
    > 299 |       expect(typeof result).toBe('number');
          |                             ^
      300 |       // (5200-5000)/5000 * (365/182) = 0.0802
      301 |       expect(result as number).toBeCloseTo(0.0802, 3);
      302 |     });

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:299:29)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ INTRATE - Interest Rate for Fully Invested Security ‚Ä∫ Oracle Test 7: INTRATE vs DISC comparison

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      310 |       const disc = evaluate(`=DISC(${settlement}, ${maturity}, 98, 100, 2)`) as number;
      311 |       
    > 312 |       expect(typeof intrate).toBe('number');
          |                              ^
      313 |       expect(typeof disc).toBe('number');
      314 |       
      315 |       // INTRATE uses investment as denominator, DISC uses redemption

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:312:30)

  ‚óè Financial Functions - Week 1 Day 2 (MIRR, FVSCHEDULE, DISC, INTRATE) ‚Ä∫ Integration Tests ‚Ä∫ FVSCHEDULE matches compound FV with single rate

    expect(received).toBeLessThan(expected)

    Expected: < 0.01
    Received:   NaN

      327 |       const fv = evaluate('=FV(0.08, 1, 0, -1000)') as number;
      328 |       
    > 329 |       expect(Math.abs(fvSchedule - fv)).toBeLessThan(0.01);
          |                                         ^
      330 |     });
      331 |
      332 |     test('MIRR with zero rates returns #NUM!', () => {

      at Object.<anonymous> (__tests__/functions/financial-week1-day2.test.ts:329:41)

FAIL packages/core/__tests__/functions/datetime-components.test.ts (5.164 s)
  ‚óè Date & Time Component Extraction ‚Ä∫ MONTH ‚Ä∫ extracts month from TODAY

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      148 |     test('extracts month from TODAY', () => {
      149 |       const result = evaluate('=MONTH(TODAY())');
    > 150 |       expect(result).toBe(1); // January
          |                      ^
      151 |     });
      152 |
      153 |     test('extracts month from NOW', () => {

      at Object.<anonymous> (__tests__/functions/datetime-components.test.ts:150:22)

  ‚óè Date & Time Component Extraction ‚Ä∫ MONTH ‚Ä∫ extracts month from NOW

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      153 |     test('extracts month from NOW', () => {
      154 |       const result = evaluate('=MONTH(NOW())');
    > 155 |       expect(result).toBe(1); // January
          |                      ^
      156 |     });
      157 |
      158 |     test('returns error for invalid date string', () => {

      at Object.<anonymous> (__tests__/functions/datetime-components.test.ts:155:22)

  ‚óè Date & Time Component Extraction ‚Ä∫ DAY ‚Ä∫ extracts day from TODAY

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 27
    Received:    17

      230 |       const result = evaluate('=DAY(TODAY())');
      231 |       // Should be around 28-29 for January 29, 2026
    > 232 |       expect(result).toBeGreaterThanOrEqual(27);
          |                      ^
      233 |       expect(result).toBeLessThanOrEqual(30);
      234 |     });
      235 |

      at Object.<anonymous> (__tests__/functions/datetime-components.test.ts:232:22)

  ‚óè Date & Time Component Extraction ‚Ä∫ DAY ‚Ä∫ extracts day from NOW

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 27
    Received:    17

      236 |     test('extracts day from NOW', () => {
      237 |       const result = evaluate('=DAY(NOW())');
    > 238 |       expect(result).toBeGreaterThanOrEqual(27);
          |                      ^
      239 |       expect(result).toBeLessThanOrEqual(30);
      240 |     });
      241 |

      at Object.<anonymous> (__tests__/functions/datetime-components.test.ts:238:22)

  ‚óè Date & Time Component Extraction ‚Ä∫ Integration Tests ‚Ä∫ extract all components from NOW

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      451 |       
      452 |       expect(year).toBe(2026);
    > 453 |       expect(month).toBe(1);
          |                     ^
      454 |       expect(day).toBeGreaterThanOrEqual(27);
      455 |       expect(day).toBeLessThanOrEqual(30);
      456 |       expect(hour).toBeGreaterThanOrEqual(0);

      at Object.<anonymous> (__tests__/functions/datetime-components.test.ts:453:21)

FAIL packages/core/__tests__/textsplit-textjoin.test.ts (5.658 s)
  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits by single character delimiter

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
        "Cherry",
    -   ],
      ]

      32 |         );
      33 |         
    > 34 |         expect(result).toEqual([['Apple', 'Banana', 'Cherry']]);
         |                        ^
      35 |       });
      36 |
      37 |       test('splits by multi-character delimiter', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:34:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits by multi-character delimiter

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
        "Cherry",
    -   ],
      ]

      41 |         );
      42 |         
    > 43 |         expect(result).toEqual([['Apple', 'Banana', 'Cherry']]);
         |                        ^
      44 |       });
      45 |
      46 |       test('splits with spaces in values', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:43:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits with spaces in values

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "First Name",
        "Last Name",
        "Email Address",
    -   ],
      ]

      50 |         );
      51 |         
    > 52 |         expect(result).toEqual([['First Name', 'Last Name', 'Email Address']]);
         |                        ^
      53 |       });
      54 |
      55 |       test('splits single value (no delimiter found)', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:52:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits single value (no delimiter found)

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "NoDelimiter",
    -   ],
      ]

      59 |         );
      60 |         
    > 61 |         expect(result).toEqual([['NoDelimiter']]);
         |                        ^
      62 |       });
      63 |
      64 |       test('splits with delimiter at start', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:61:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits with delimiter at start

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "",
        "Apple",
        "Banana",
    -   ],
      ]

      68 |         );
      69 |         
    > 70 |         expect(result).toEqual([['', 'Apple', 'Banana']]);
         |                        ^
      71 |       });
      72 |
      73 |       test('splits with delimiter at end', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:70:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ splits with delimiter at end

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
        "",
    -   ],
      ]

      77 |         );
      78 |         
    > 79 |         expect(result).toEqual([['Apple', 'Banana', '']]);
         |                        ^
      80 |       });
      81 |
      82 |       test('handles consecutive delimiters', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:79:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Basic Column Splitting ‚Ä∫ handles consecutive delimiters

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "",
        "Cherry",
    -   ],
      ]

      86 |         );
      87 |         
    > 88 |         expect(result).toEqual([['Apple', '', 'Cherry']]);
         |                        ^
      89 |       });
      90 |     });
      91 |

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:88:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Column Splitting with ignoreEmpty ‚Ä∫ ignores empty values when TRUE

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Cherry",
    -   ],
      ]

       97 |         );
       98 |         
    >  99 |         expect(result).toEqual([['Apple', 'Cherry']]);
          |                        ^
      100 |       });
      101 |
      102 |       test('keeps empty values when FALSE', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:99:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Column Splitting with ignoreEmpty ‚Ä∫ keeps empty values when FALSE

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "",
        "Cherry",
    -   ],
      ]

      106 |         );
      107 |         
    > 108 |         expect(result).toEqual([['Apple', '', 'Cherry']]);
          |                        ^
      109 |       });
      110 |
      111 |       test('ignores empty at edges', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:108:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Column Splitting with ignoreEmpty ‚Ä∫ ignores empty at edges

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
    -   ],
      ]

      115 |         );
      116 |         
    > 117 |         expect(result).toEqual([['Apple', 'Banana']]);
          |                        ^
      118 |       });
      119 |
      120 |       test('ignores multiple consecutive empty', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:117:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Column Splitting with ignoreEmpty ‚Ä∫ ignores multiple consecutive empty

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Cherry",
    -   ],
      ]

      124 |         );
      125 |         
    > 126 |         expect(result).toEqual([['Apple', 'Cherry']]);
          |                        ^
      127 |       });
      128 |     });
      129 |

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:126:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Case-Insensitive Matching ‚Ä∫ case-sensitive split (default)

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "banana",
        "cherry",
    -   ],
      ]

      200 |         );
      201 |         
    > 202 |         expect(result).toEqual([['Apple', 'banana', 'cherry']]);
          |                        ^
      203 |       });
      204 |
      205 |       test('case-insensitive split', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:202:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Case-Insensitive Matching ‚Ä∫ case-insensitive split

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "banana",
        "cherry",
    -   ],
      ]

      209 |         );
      210 |         
    > 211 |         expect(result).toEqual([['Apple', 'banana', 'cherry']]);
          |                        ^
      212 |       });
      213 |
      214 |       test('case-insensitive with mixed case delimiter', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:211:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Case-Insensitive Matching ‚Ä∫ case-insensitive with mixed case delimiter

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "banana",
        "cherry",
    -   ],
      ]

      218 |         );
      219 |         
    > 220 |         expect(result).toEqual([['Apple', 'banana', 'cherry']]);
          |                        ^
      221 |       });
      222 |     });
      223 |

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:220:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Edge Cases and Errors ‚Ä∫ handles empty string input

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "",
    -   ],
      ]

      239 |         );
      240 |         
    > 241 |         expect(result).toEqual([['']]);
          |                        ^
      242 |       });
      243 |
      244 |       test('handles empty string with ignoreEmpty', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:241:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Edge Cases and Errors ‚Ä∫ handles empty string with ignoreEmpty

    expect(received).toEqual(expected) // deep equality

    - Expected  - 3
    + Received  + 1

    - Array [
    -   Array [],
    - ]
    + Array []

      248 |         );
      249 |         
    > 250 |         expect(result).toEqual([[]]);
          |                        ^
      251 |       });
      252 |
      253 |       test('handles numeric values converted to string', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:250:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Edge Cases and Errors ‚Ä∫ handles numeric values converted to string

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "100",
        "200",
        "300",
    -   ],
      ]

      257 |         );
      258 |         
    > 259 |         expect(result).toEqual([['100', '200', '300']]);
          |                        ^
      260 |       });
      261 |
      262 |       test('splits with tab delimiter', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:259:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Edge Cases and Errors ‚Ä∫ splits with tab delimiter

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
        "Cherry",
    -   ],
      ]

      267 |         );
      268 |         
    > 269 |         expect(result).toEqual([['Apple', 'Banana', 'Cherry']]);
          |                        ^
      270 |       });
      271 |     });
      272 |

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:269:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Real-World Examples ‚Ä∫ splits full name into parts

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "John",
        "Michael",
        "Smith",
    -   ],
      ]

      278 |         );
      279 |         
    > 280 |         expect(result).toEqual([['John', 'Michael', 'Smith']]);
          |                        ^
      281 |       });
      282 |
      283 |       test('splits email address', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:280:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Real-World Examples ‚Ä∫ splits email address

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "user",
        "example.com",
    -   ],
      ]

      287 |         );
      288 |         
    > 289 |         expect(result).toEqual([['user', 'example.com']]);
          |                        ^
      290 |       });
      291 |
      292 |       test('splits file path', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:289:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Real-World Examples ‚Ä∫ splits file path

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "",
        "home",
        "user",
        "documents",
        "file.txt",
    -   ],
      ]

      296 |         );
      297 |         
    > 298 |         expect(result).toEqual([['', 'home', 'user', 'documents', 'file.txt']]);
          |                        ^
      299 |       });
      300 |
      301 |       test('splits file path ignoring empty', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:298:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Real-World Examples ‚Ä∫ splits file path ignoring empty

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "home",
        "user",
        "documents",
        "file.txt",
    -   ],
      ]

      305 |         );
      306 |         
    > 307 |         expect(result).toEqual([['home', 'user', 'documents', 'file.txt']]);
          |                        ^
      308 |       });
      309 |
      310 |       test('parses CSV line', () => {

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:307:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT Function ‚Ä∫ Real-World Examples ‚Ä∫ parses CSV line

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Product",
        "Price",
        "Quantity",
        "SKU",
    -   ],
      ]

      314 |         );
      315 |         
    > 316 |         expect(result).toEqual([['Product', 'Price', 'Quantity', 'SKU']]);
          |                        ^
      317 |       });
      318 |     });
      319 |   });

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:316:24)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT and TEXTJOIN Integration ‚Ä∫ split and rejoin with different delimiter

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "Apple",
        "Banana",
        "Cherry",
    -   ],
      ]

      565 |       ) as FormulaValue[][];
      566 |       
    > 567 |       expect(split).toEqual([['Apple', 'Banana', 'Cherry']]);
          |                     ^
      568 |       
      569 |       worksheet.setCellValue({ row: 2, col: 1 }, split[0][0] as string);
      570 |       worksheet.setCellValue({ row: 2, col: 2 }, split[0][1] as string);

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:567:21)

  ‚óè TEXTSPLIT and TEXTJOIN Functions ‚Ä∫ TEXTSPLIT and TEXTJOIN Integration ‚Ä∫ round-trip: join then split

    expect(received).toEqual(expected) // deep equality

    - Expected  - 2
    + Received  + 0

      Array [
    -   Array [
        "First",
        "Second",
        "Third",
    -   ],
      ]

      607 |       );
      608 |       
    > 609 |       expect(split).toEqual([['First', 'Second', 'Third']]);
          |                     ^
      610 |     });
      611 |   });
      612 | });

      at Object.<anonymous> (__tests__/textsplit-textjoin.test.ts:609:21)

FAIL packages/core/__tests__/functions/financial-basic.test.ts (5.681 s)
  ‚óè Financial Functions - Week 8 Day 4 ‚Ä∫ Integration Tests ‚Ä∫ Financial functions with range references

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      367 |       
      368 |       const npv = evaluate('=NPV(0.10, A1:A5)');
    > 369 |       expect(typeof npv).toBe('number');
          |                          ^
      370 |     });
      371 |   });
      372 |

      at Object.<anonymous> (__tests__/functions/financial-basic.test.ts:369:26)

FAIL packages/core/__tests__/functions/math-week2-day6.test.ts
  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ AGGREGATE ‚Ä∫ function 1: AVERAGE (option 0)

    expect(received).toBe(expected) // Object.is equality

    Expected: 5.5
    Received: [Error: #DIV/0!]

      141 |     test('function 1: AVERAGE (option 0)', () => {
      142 |       const result = engine.evaluate('=AGGREGATE(1, 0, A1:A10)', context);
    > 143 |       expect(result).toBe(5.5); // (1+2+...+10)/10
          |                      ^
      144 |     });
      145 |
      146 |     test('function 9: SUM (option 0)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:143:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ AGGREGATE ‚Ä∫ function 9: SUM (option 0)

    expect(received).toBe(expected) // Object.is equality

    Expected: 55
    Received: 0

      146 |     test('function 9: SUM (option 0)', () => {
      147 |       const result = engine.evaluate('=AGGREGATE(9, 0, A1:A10)', context);
    > 148 |       expect(result).toBe(55); // 1+2+...+10
          |                      ^
      149 |     });
      150 |
      151 |     test('function 4: MAX (option 0)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:148:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ AGGREGATE ‚Ä∫ function 4: MAX (option 0)

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 0

      151 |     test('function 4: MAX (option 0)', () => {
      152 |       const result = engine.evaluate('=AGGREGATE(4, 0, A1:A10)', context);
    > 153 |       expect(result).toBe(10);
          |                      ^
      154 |     });
      155 |
      156 |     test('function 5: MIN (option 0)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:153:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ AGGREGATE ‚Ä∫ function 5: MIN (option 0)

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

      156 |     test('function 5: MIN (option 0)', () => {
      157 |       const result = engine.evaluate('=AGGREGATE(5, 0, A1:A10)', context);
    > 158 |       expect(result).toBe(1);
          |                      ^
      159 |     });
      160 |
      161 |     test('function 2: COUNT (option 2, ignore errors)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:158:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ AGGREGATE ‚Ä∫ function 12: MEDIAN

    expect(received).toBe(expected) // Object.is equality

    Expected: 5.5
    Received: [Error: #NUM!]

      171 |     test('function 12: MEDIAN', () => {
      172 |       const result = engine.evaluate('=AGGREGATE(12, 0, A1:A10)', context);
    > 173 |       expect(result).toBe(5.5); // Median of 1-10
          |                      ^
      174 |     });
      175 |
      176 |     test('function 7: STDEV.S (sample standard deviation)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:173:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 9: SUM

    expect(received).toBe(expected) // Object.is equality

    Expected: 55
    Received: 0

      205 |     test('function 9: SUM', () => {
      206 |       const result = engine.evaluate('=SUBTOTAL(9, A1:A10)', context);
    > 207 |       expect(result).toBe(55); // 1+2+...+10
          |                      ^
      208 |     });
      209 |
      210 |     test('function 1: AVERAGE', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:207:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 1: AVERAGE

    expect(received).toBe(expected) // Object.is equality

    Expected: 5.5
    Received: [Error: #DIV/0!]

      210 |     test('function 1: AVERAGE', () => {
      211 |       const result = engine.evaluate('=SUBTOTAL(1, A1:A10)', context);
    > 212 |       expect(result).toBe(5.5);
          |                      ^
      213 |     });
      214 |
      215 |     test('function 4: MAX', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:212:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 4: MAX

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 0

      215 |     test('function 4: MAX', () => {
      216 |       const result = engine.evaluate('=SUBTOTAL(4, A1:A10)', context);
    > 217 |       expect(result).toBe(10);
          |                      ^
      218 |     });
      219 |
      220 |     test('function 5: MIN', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:217:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 5: MIN

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

      220 |     test('function 5: MIN', () => {
      221 |       const result = engine.evaluate('=SUBTOTAL(5, A1:A10)', context);
    > 222 |       expect(result).toBe(1);
          |                      ^
      223 |     });
      224 |
      225 |     test('function 109: SUM (ignore hidden and filtered)', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:222:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 109: SUM (ignore hidden and filtered)

    expect(received).toBe(expected) // Object.is equality

    Expected: 55
    Received: 0

      226 |       // 100-series codes behave same as 1-11 in our simplified implementation
      227 |       const result = engine.evaluate('=SUBTOTAL(109, A1:A10)', context);
    > 228 |       expect(result).toBe(55);
          |                      ^
      229 |     });
      230 |
      231 |     test('function 2: COUNT', () => {

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:228:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ SUBTOTAL ‚Ä∫ function 2: COUNT

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 0

      231 |     test('function 2: COUNT', () => {
      232 |       const result = engine.evaluate('=SUBTOTAL(2, A1:A10)', context);
    > 233 |       expect(result).toBe(10);
          |                      ^
      234 |     });
      235 |   });
      236 |

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:233:22)

  ‚óè Week 2 Day 6: Math Aggregation & Rounding ‚Ä∫ Integration Tests ‚Ä∫ AGGREGATE vs SUBTOTAL for basic SUM

    expect(received).toBe(expected) // Object.is equality

    Expected: 150
    Received: 0

      256 |       const subtotal = engine.evaluate('=SUBTOTAL(9, A1:A5)', context);
      257 |       
    > 258 |       expect(aggregate).toBe(150); // 10+20+30+40+50
          |                         ^
      259 |       expect(subtotal).toBe(150);  // Same result
      260 |     });
      261 |

      at Object.<anonymous> (__tests__/functions/math-week2-day6.test.ts:258:25)

FAIL packages/core/__tests__/functions/financial-week1-day4.test.ts (5.611 s)
  ‚óè Financial Functions - Week 1 Day 4 (SLN, SYD, VDB, AMORDEGRC) ‚Ä∫ AMORDEGRC - French Accounting Depreciation ‚Ä∫ Oracle Test 1: First period depreciation

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      182 |       
      183 |       const result = evaluate('=AMORDEGRC(2400, 39679, 39813, 300, 1, 0.15, 1)');
    > 184 |       expect(typeof result).toBe('number');
          |                             ^
      185 |       expect(result as number).toBeGreaterThan(0);
      186 |     });
      187 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day4.test.ts:184:29)

  ‚óè Financial Functions - Week 1 Day 4 (SLN, SYD, VDB, AMORDEGRC) ‚Ä∫ AMORDEGRC - French Accounting Depreciation ‚Ä∫ Oracle Test 2: Period 0 (prorated)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      188 |     test('Oracle Test 2: Period 0 (prorated)', () => {
      189 |       const result = evaluate('=AMORDEGRC(2400, 39679, 39813, 300, 0, 0.15, 1)');
    > 190 |       expect(typeof result).toBe('number');
          |                             ^
      191 |       expect(result as number).toBeGreaterThan(0);
      192 |     });
      193 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day4.test.ts:190:29)

  ‚óè Financial Functions - Week 1 Day 4 (SLN, SYD, VDB, AMORDEGRC) ‚Ä∫ AMORDEGRC - French Accounting Depreciation ‚Ä∫ Oracle Test 3: High depreciation rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      195 |       // Rate 0.25 (4-year life)
      196 |       const result = evaluate('=AMORDEGRC(10000, 39679, 39813, 1000, 1, 0.25, 1)');
    > 197 |       expect(typeof result).toBe('number');
          |                             ^
      198 |       expect(result as number).toBeGreaterThan(0);
      199 |     });
      200 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day4.test.ts:197:29)

  ‚óè Financial Functions - Week 1 Day 4 (SLN, SYD, VDB, AMORDEGRC) ‚Ä∫ AMORDEGRC - French Accounting Depreciation ‚Ä∫ Oracle Test 4: Low depreciation rate

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      202 |       // Rate 0.10 (10-year life)
      203 |       const result = evaluate('=AMORDEGRC(10000, 39679, 39813, 1000, 1, 0.10, 1)');
    > 204 |       expect(typeof result).toBe('number');
          |                             ^
      205 |       expect(result as number).toBeGreaterThan(0);
      206 |     });
      207 |

      at Object.<anonymous> (__tests__/functions/financial-week1-day4.test.ts:204:29)

  ‚óè Financial Functions - Week 1 Day 4 (SLN, SYD, VDB, AMORDEGRC) ‚Ä∫ AMORDEGRC - French Accounting Depreciation ‚Ä∫ Oracle Test 7: Later period

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      218 |     test('Oracle Test 7: Later period', () => {
      219 |       const result = evaluate('=AMORDEGRC(2400, 39679, 39813, 300, 3, 0.15, 1)');
    > 220 |       expect(typeof result).toBe('number');
          |                             ^
      221 |       expect(result as number).toBeGreaterThanOrEqual(0);
      222 |     });
      223 |   });

      at Object.<anonymous> (__tests__/functions/financial-week1-day4.test.ts:220:29)

FAIL packages/core/__tests__/functions/advanced-math-functions.test.ts
  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ MROUND function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: 9
    Received: [Error: #NUM!]

      73 |       setCellValue('A1', 10);
      74 |       setCellValue('B1', 3);
    > 75 |       expect(evaluate('=MROUND(A1, B1)')).toBe(9);
         |                                           ^
      76 |     });
      77 |   });
      78 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:75:43)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ QUOTIENT function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: 4
    Received: [Error: #DIV/0!]

      113 |       setCellValue('A1', 17);
      114 |       setCellValue('B1', 4);
    > 115 |       expect(evaluate('=QUOTIENT(A1, B1)')).toBe(4);
          |                                             ^
      116 |     });
      117 |   });
      118 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:115:45)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ PRODUCT function ‚Ä∫ should ignore text and logical values

    expect(received).toBe(expected) // Object.is equality

    Expected: 6
    Received: 0

      146 |       setCellValue('A2', 'text');
      147 |       setCellValue('A3', 3);
    > 148 |       expect(evaluate('=PRODUCT(A1:A3)')).toBe(6);
          |                                           ^
      149 |     });
      150 |
      151 |     test('should return 0 for empty input', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:148:43)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ PRODUCT function ‚Ä∫ should return 0 for empty input

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: undefined

      150 |
      151 |     test('should return 0 for empty input', () => {
    > 152 |       expect(evaluate('=PRODUCT()')).toBe(0);
          |                                      ^
      153 |     });
      154 |
      155 |     test('should handle cell references', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:152:38)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ PRODUCT function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: 24
    Received: 0

      157 |       setCellValue('A2', 3);
      158 |       setCellValue('A3', 4);
    > 159 |       expect(evaluate('=PRODUCT(A1:A3)')).toBe(24);
          |                                           ^
      160 |     });
      161 |   });
      162 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:159:43)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SQRTPI function ‚Ä∫ should handle cell references

    expect(received).toBeCloseTo(expected, precision)

    Expected: 3.0699801238394655
    Received: 0

    Expected precision:    5
    Expected difference: < 0.000005
    Received difference:   3.0699801238394655

      191 |       setCellValue('A1', 3);
      192 |       const result = evaluate('=SQRTPI(A1)');
    > 193 |       expect(result).toBeCloseTo(Math.sqrt(3 * Math.PI), 5);
          |                      ^
      194 |     });
      195 |   });
      196 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:193:22)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ MULTINOMIAL function ‚Ä∫ should handle cell references

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: [Error: #VALUE!]

      235 |       setCellValue('A1', 2);
      236 |       setCellValue('A2', 3);
    > 237 |       expect(evaluate('=MULTINOMIAL(A1, A2)')).toBe(10);
          |                                                ^
      238 |     });
      239 |   });
      240 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:237:48)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMX2MY2 function ‚Ä∫ should calculate sum of x¬≤ - y¬≤

    expect(received).toBe(expected) // Object.is equality

    Expected: -88
    Received: 146

      254 |       setCellValue('B2', 5);
      255 |       setCellValue('B3', 11);
    > 256 |       expect(evaluate('=SUMX2MY2(A1:A3, B1:B3)')).toBe(-88);
          |                                                   ^
      257 |     });
      258 |
      259 |     test('should handle positive results', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:256:51)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMX2MY2 function ‚Ä∫ should handle positive results

    expect(received).toBe(expected) // Object.is equality

    Expected: 28
    Received: 4

      263 |       setCellValue('B2', 2);
      264 |       // (25-9) + (16-4) = 16 + 12 = 28
    > 265 |       expect(evaluate('=SUMX2MY2(A1:A2, B1:B2)')).toBe(28);
          |                                                   ^
      266 |     });
      267 |
      268 |     test('should return error for mismatched array sizes', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:265:51)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMX2PY2 function ‚Ä∫ should calculate sum of x¬≤ + y¬≤

    expect(received).toBe(expected) // Object.is equality

    Expected: 276
    Received: 146

      296 |       setCellValue('B2', 5);
      297 |       setCellValue('B3', 11);
    > 298 |       expect(evaluate('=SUMX2PY2(A1:A3, B1:B3)')).toBe(276);
          |                                                   ^
      299 |     });
      300 |
      301 |     test('should handle zeros', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:298:51)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMX2PY2 function ‚Ä∫ should handle zeros

    expect(received).toBe(expected) // Object.is equality

    Expected: 25
    Received: 0

      305 |       setCellValue('B2', 0);
      306 |       // (0+16) + (9+0) = 16 + 9 = 25
    > 307 |       expect(evaluate('=SUMX2PY2(A1:A2, B1:B2)')).toBe(25);
          |                                                   ^
      308 |     });
      309 |
      310 |     test('should return error for mismatched array sizes', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:307:51)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMXMY2 function ‚Ä∫ should calculate sum of (x - y)¬≤

    expect(received).toBe(expected) // Object.is equality

    Expected: 24
    Received: 146

      337 |       setCellValue('B2', 5);
      338 |       setCellValue('B3', 11);
    > 339 |       expect(evaluate('=SUMXMY2(A1:A3, B1:B3)')).toBe(24);
          |                                                  ^
      340 |     });
      341 |
      342 |     test('should handle equal values (zero difference)', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:339:50)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMXMY2 function ‚Ä∫ should handle equal values (zero difference)

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: 9

      345 |       setCellValue('B1', 5);
      346 |       setCellValue('B2', 3);
    > 347 |       expect(evaluate('=SUMXMY2(A1:A2, B1:B2)')).toBe(0);
          |                                                  ^
      348 |     });
      349 |
      350 |     test('should return error for mismatched array sizes', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:347:50)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ SUMXMY2 function ‚Ä∫ should handle negative differences

    expect(received).toBe(expected) // Object.is equality

    Expected: 16
    Received: 0

      366 |       setCellValue('B1', 7);
      367 |       // (3-7)¬≤ = 16
    > 368 |       expect(evaluate('=SUMXMY2(A1, B1)')).toBe(16);
          |                                            ^
      369 |     });
      370 |   });
      371 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:368:44)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ Integration tests ‚Ä∫ should use MROUND with AVERAGE

    expect(received).toBe(expected) // Object.is equality

    Expected: 20
    Received: [Error: #DIV/0!]

      380 |       setCellValue('A3', 20);
      381 |       // AVERAGE = 15, MROUND(15, 10) = 20
    > 382 |       expect(evaluate('=MROUND(AVERAGE(A1:A3), 10)')).toBe(20);
          |                                                       ^
      383 |     });
      384 |
      385 |     test('should use QUOTIENT with PRODUCT', () => {

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:382:55)

  ‚óè Week 11 Day 2: Advanced Math Functions ‚Ä∫ Integration tests ‚Ä∫ should combine SUM functions

    expect(received).toBe(expected) // Object.is equality

    Expected: 30
    Received: 4

      404 |       // (9+1) + (16+4) = 30
      405 |       // (9-1) + (16-4) = 20
    > 406 |       expect(sumPlus).toBe(30);
          |                       ^
      407 |       expect(sumMinus).toBe(20);
      408 |     });
      409 |

      at Object.<anonymous> (__tests__/functions/advanced-math-functions.test.ts:406:23)

FAIL packages/core/__tests__/functions/statistical-week2-day2.test.ts
  ‚óè Statistical Functions - Week 2 Day 2 (F-Distribution) ‚Ä∫ F.TEST - F-Test for Equal Variances ‚Ä∫ Oracle Test 2: Similar variances

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      253 |       // F.TEST with arrays of similar variance
      254 |       const result = evaluate('=F.TEST(A1:A9, C1:C9)');
    > 255 |       expect(typeof result).toBe('number');
          |                             ^
      256 |       expect(result as number).toBeGreaterThan(0);
      257 |       expect(result as number).toBeLessThan(1);
      258 |       // With similar variance, p-value should be relatively high

      at Object.<anonymous> (__tests__/functions/statistical-week2-day2.test.ts:255:29)

  ‚óè Statistical Functions - Week 2 Day 2 (F-Distribution) ‚Ä∫ F.TEST - F-Test for Equal Variances ‚Ä∫ Oracle Test 7: Large variance ratio

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      301 |       
      302 |       const result = evaluate('=F.TEST(A1:A9, E1:E9)');
    > 303 |       expect(typeof result).toBe('number');
          |                             ^
      304 |       expect(result as number).toBeGreaterThan(0);
      305 |       expect(result as number).toBeLessThan(0.1); // Very low p-value
      306 |     });

      at Object.<anonymous> (__tests__/functions/statistical-week2-day2.test.ts:303:29)

FAIL packages/core/__tests__/unique.test.ts
  ‚óè FormulaEngine - UNIQUE Function ‚Ä∫ Error Handling ‚Ä∫ returns #CALC! when array is empty

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error
    Received constructor: Array

      258 |     test('returns #CALC! when array is empty', () => {
      259 |       const result = testUNIQUE([]);
    > 260 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      261 |       expect((result as Error).message).toBe('#CALC!');
      262 |     });
      263 |

      at Object.<anonymous> (__tests__/unique.test.ts:260:22)

FAIL packages/core/__tests__/functions/statistical-basic.test.ts
  ‚óè Statistical Functions - Week 8 Day 1 ‚Ä∫ AVERAGEA ‚Ä∫ returns #DIV/0! for no values

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: undefined

      93 |     test('returns #DIV/0! for no values', () => {
      94 |       const result = evaluate('=AVERAGEA()');
    > 95 |       expect(result).toBeInstanceOf(Error);
         |                      ^
      96 |       expect((result as Error).message).toBe('#DIV/0!');
      97 |     });
      98 |   });

      at Object.<anonymous> (__tests__/functions/statistical-basic.test.ts:95:22)

  ‚óè Statistical Functions - Week 8 Day 1 ‚Ä∫ MEDIAN ‚Ä∫ returns #NUM! for no values

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: undefined

      136 |     test('returns #NUM! for no values', () => {
      137 |       const result = evaluate('=MEDIAN()');
    > 138 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      139 |       expect((result as Error).message).toBe('#NUM!');
      140 |     });
      141 |   });

      at Object.<anonymous> (__tests__/functions/statistical-basic.test.ts:138:22)

  ‚óè Statistical Functions - Week 8 Day 1 ‚Ä∫ Integration with Dynamic Arrays ‚Ä∫ AVERAGE with FILTER

    expect(received).toBe(expected) // Object.is equality

    Expected: 30
    Received: [Error: #VALUE!]

      358 |       
      359 |       const result = evaluate('=AVERAGE(FILTER(A1:A4, A1:A4>15))');
    > 360 |       expect(result).toBe(30); // Average of 20, 30, 40
          |                      ^
      361 |     });
      362 |
      363 |     test('MEDIAN with SEQUENCE', () => {

      at Object.<anonymous> (__tests__/functions/statistical-basic.test.ts:360:22)

  ‚óè Statistical Functions - Week 8 Day 1 ‚Ä∫ Integration with Dynamic Arrays ‚Ä∫ VAR.P with FILTER and condition

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #VALUE!]

      388 |       
      389 |       const result = evaluate('=VAR.P(FILTER(A1:A4, A1:A4>=10))');
    > 390 |       expect(result).toBeCloseTo(16.666666, 5); // Variance of 10,15,20
          |                      ^
      391 |     });
      392 |   });
      393 |

      at Object.<anonymous> (__tests__/functions/statistical-basic.test.ts:390:22)

  ‚óè Statistical Functions - Week 8 Day 1 ‚Ä∫ Edge Cases and Robustness ‚Ä∫ all functions handle empty arrays gracefully

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: undefined

      415 |       const varResult = evaluate('=VAR.S()');
      416 |       
    > 417 |       expect(avgResult).toBeInstanceOf(Error);
          |                         ^
      418 |       expect(medianResult).toBeInstanceOf(Error);
      419 |       expect(varResult).toBeInstanceOf(Error);
      420 |     });

      at Object.<anonymous> (__tests__/functions/statistical-basic.test.ts:417:25)

FAIL packages/core/__tests__/error-engine-behavior.test.ts
  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ SKIP_ERRORS: SUM - Filter Errors, Aggregate Non-Errors ‚Ä∫ filters multiple errors, returns sum of remaining values

    expect(received).toBe(expected) // Object.is equality

    Expected: 15
    Received: 0

      281 |       const result = engine.evaluate('=SUM(1/0, B2, 1/"text", C2)', context);
      282 |       
    > 283 |       expect(result).toBe(15);
          |                      ^
      284 |       expect(result).not.toBeInstanceOf(Error);
      285 |     });
      286 |

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:283:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ SKIP_ERRORS: SUM - Filter Errors, Aggregate Non-Errors ‚Ä∫ handles mixed numeric, null, and error values

    expect(received).toBe(expected) // Object.is equality

    Expected: 15
    Received: 0

      310 |       const result = engine.evaluate('=SUM(B2, C2, 1/0, D2)', context);
      311 |       
    > 312 |       expect(result).toBe(15);
          |                      ^
      313 |     });
      314 |
      315 |     test('returns 0 when all arguments filtered (errors only)', () => {

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:312:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ SKIP_ERRORS: Edge Cases and Boundary Conditions ‚Ä∫ does not mutate original arguments

    expect(received).toBe(expected) // Object.is equality

    Expected: 15
    Received: 10

      444 |       const result = engine.evaluate('=SUM(B2, 1/0, 10)', context);
      445 |       
    > 446 |       expect(result).toBe(15); // Should work identically on second call
          |                      ^
      447 |     });
      448 |
      449 |     test('handles nested errors correctly', () => {

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:446:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ FINANCIAL_STRICT: PV - Present Value Function ‚Ä∫ rejects NaN argument

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: 1000

      505 |       const result = engine.evaluate('=PV(B2, 10, -100)', context);
      506 |       
    > 507 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      508 |       expect((result as Error).message).toContain('#VALUE!');
      509 |     });
      510 |

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:507:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ FINANCIAL_STRICT: PV - Present Value Function ‚Ä∫ rejects Infinity argument

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: 1000

      514 |       const result = engine.evaluate('=PV(B2, 10, -100)', context);
      515 |       
    > 516 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      517 |       expect((result as Error).message).toContain('#DIV/0!');
      518 |     });
      519 |

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:516:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ FINANCIAL_STRICT: NPV - Net Present Value ‚Ä∫ rejects NaN in cash flows

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: 316.3035311795642

      564 |       const result = engine.evaluate('=NPV(0.1, 100, B2, 300)', context);
      565 |       
    > 566 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      567 |       expect((result as Error).message).toContain('#VALUE!');
      568 |     });
      569 |

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:566:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ FINANCIAL_STRICT: NPV - Net Present Value ‚Ä∫ rejects Infinity in rate

    expect(received).toBeInstanceOf(expected)

    Expected constructor: Error

    Received value has no prototype
    Received value: 300

      573 |       const result = engine.evaluate('=NPV(B2, 100, 200)', context);
      574 |       
    > 575 |       expect(result).toBeInstanceOf(Error);
          |                      ^
      576 |       expect((result as Error).message).toContain('#DIV/0!');
      577 |     });
      578 |   });

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:575:22)

  ‚óè Wave 0 Day 4 - Phase 3: SKIP_ERRORS Behavioral Validation ‚Ä∫ Phase 5: LOOKUP_STRICT - VLOOKUP #N/A Pass-Through (CRITICAL) ‚Ä∫ INDEX passes through #N/A when handler returns it

    expect(received).toBe(expected) // Object.is equality

    Expected: "data"
    Received: null

      689 |         expect(result).toBeInstanceOf(Error);
      690 |       } else {
    > 691 |         expect(result).toBe('data');
          |                        ^
      692 |       }
      693 |     });
      694 |   });

      at Object.<anonymous> (__tests__/error-engine-behavior.test.ts:691:24)

FAIL packages/core/__tests__/functions/datetime-arithmetic.test.ts
  ‚óè Date Arithmetic Functions ‚Ä∫ EDATE ‚Ä∫ adds months to a date

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 15
    Received:    16

      33 |       expect(month).toBe(2);
      34 |       expect(day).toBeGreaterThanOrEqual(13);
    > 35 |       expect(day).toBeLessThanOrEqual(15);
         |                   ^
      36 |     });
      37 |
      38 |     test('subtracts months from a date', () => {

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:35:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EDATE ‚Ä∫ subtracts months from a date

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 15
    Received:    16

      43 |       expect(month).toBe(2);
      44 |       expect(day).toBeGreaterThanOrEqual(13);
    > 45 |       expect(day).toBeLessThanOrEqual(15);
         |                   ^
      46 |     });
      47 |
      48 |     test('handles day 31 to month with 28 days (Feb non-leap)', () => {

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:45:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ returns last day of current month

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 30
    Received:    1

      133 |       
      134 |       // January has 31 days
    > 135 |       expect(day).toBeGreaterThanOrEqual(30);
          |                   ^
      136 |       expect(day).toBeLessThanOrEqual(31);
      137 |     });
      138 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:135:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ returns last day of next month

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 3

      143 |       
      144 |       // February 2026 (non-leap) has 28 days
    > 145 |       expect(month).toBe(2);
          |                     ^
      146 |       expect(day).toBeGreaterThanOrEqual(27);
      147 |       expect(day).toBeLessThanOrEqual(29);
      148 |     });

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:145:21)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ returns last day of previous month

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      154 |       
      155 |       // January has 31 days
    > 156 |       expect(month).toBe(1);
          |                     ^
      157 |       expect(day).toBeGreaterThanOrEqual(30);
      158 |       expect(day).toBeLessThanOrEqual(31);
      159 |     });

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:156:21)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ handles leap year February

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 28
    Received:    1

      164 |       
      165 |       // February 2024 (leap year) has 29 days
    > 166 |       expect(day).toBeGreaterThanOrEqual(28);
          |                   ^
      167 |       expect(day).toBeLessThanOrEqual(29);
      168 |     });
      169 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:166:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ handles non-leap year February

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 27
    Received:    1

      173 |       
      174 |       // February 2026 (non-leap) has 28 days
    > 175 |       expect(day).toBeGreaterThanOrEqual(27);
          |                   ^
      176 |       expect(day).toBeLessThanOrEqual(29);
      177 |     });
      178 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:175:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ handles months with 30 days

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 29
    Received:    1

      182 |       
      183 |       // April has 30 days
    > 184 |       expect(day).toBeGreaterThanOrEqual(29);
          |                   ^
      185 |       expect(day).toBeLessThanOrEqual(30);
      186 |     });
      187 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:184:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ handles year rollover (forward)

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 2

      192 |       
      193 |       expect(year).toBe(2026);
    > 194 |       expect(month).toBe(1);
          |                     ^
      195 |     });
      196 |
      197 |     test('handles year rollover (backward)', () => {

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:194:21)

  ‚óè Date Arithmetic Functions ‚Ä∫ EOMONTH ‚Ä∫ works with TODAY

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 3
    Received:    4

      211 |       // Should be February or March depending on current date
      212 |       expect(month).toBeGreaterThanOrEqual(2);
    > 213 |       expect(month).toBeLessThanOrEqual(3);
          |                     ^
      214 |     });
      215 |
      216 |     test('returns error for non-numeric date', () => {

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:213:21)

  ‚óè Date Arithmetic Functions ‚Ä∫ Integration Tests ‚Ä∫ next month end from today

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 3
    Received:    4

      368 |       // February or March
      369 |       expect(month).toBeGreaterThanOrEqual(2);
    > 370 |       expect(month).toBeLessThanOrEqual(3);
          |                     ^
      371 |     });
      372 |
      373 |     test('project duration in workdays', () => {

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:370:21)

  ‚óè Date Arithmetic Functions ‚Ä∫ Integration Tests ‚Ä∫ days until year end

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 330
    Received:    317

      380 |       const result = evaluate('=DAYS(DATE(2026, 12, 31), TODAY())');
      381 |       // From Jan 29 to Dec 31 is about 336 days
    > 382 |       expect(result).toBeGreaterThanOrEqual(330);
          |                      ^
      383 |       expect(result).toBeLessThanOrEqual(340);
      384 |     });
      385 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:382:22)

  ‚óè Date Arithmetic Functions ‚Ä∫ Integration Tests ‚Ä∫ add 3 months then get month end

    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 28
    Received:    1

      393 |       expect(month).toBeGreaterThanOrEqual(4);
      394 |       expect(month).toBeLessThanOrEqual(5);
    > 395 |       expect(day).toBeGreaterThanOrEqual(28);
          |                   ^
      396 |       expect(day).toBeLessThanOrEqual(31);
      397 |     });
      398 |

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:395:19)

  ‚óè Date Arithmetic Functions ‚Ä∫ Integration Tests ‚Ä∫ quarter end dates

    expect(received).toBeLessThanOrEqual(expected)

    Expected: <= 3
    Received:    4

      418 |       // Q1: Jan + 2 months = March (allow tolerance for off-by-one)
      419 |       expect(q1Month).toBeGreaterThanOrEqual(2);
    > 420 |       expect(q1Month).toBeLessThanOrEqual(3);
          |                       ^
      421 |       // Q2: Apr + 2 months = June (allow tolerance)
      422 |       expect(q2Month).toBeGreaterThanOrEqual(5);
      423 |       expect(q2Month).toBeLessThanOrEqual(6);

      at Object.<anonymous> (__tests__/functions/datetime-arithmetic.test.ts:420:23)

FAIL packages/core/__tests__/functions/statistical-advanced.test.ts
  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ calculates 50th percentile (median)

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: [Error: #NUM!]

      51 |       const range = setupData([1, 2, 3, 4, 5]);
      52 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.5)`);
    > 53 |       expect(result).toBe(3);
         |                      ^
      54 |     });
      55 |
      56 |     test('calculates 25th percentile', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:53:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ calculates 25th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: [Error: #NUM!]

      57 |       const range = setupData([1, 2, 3, 4, 5]);
      58 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.25)`);
    > 59 |       expect(result).toBe(2);
         |                      ^
      60 |     });
      61 |
      62 |     test('calculates 75th percentile', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:59:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ calculates 75th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 4
    Received: [Error: #NUM!]

      63 |       const range = setupData([1, 2, 3, 4, 5]);
      64 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.75)`);
    > 65 |       expect(result).toBe(4);
         |                      ^
      66 |     });
      67 |
      68 |     test('handles interpolation for non-exact percentiles', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:65:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ handles interpolation for non-exact percentiles

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NUM!]

      69 |       const range = setupData([10, 20, 30, 40]);
      70 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.3)`);
    > 71 |       expect(result).toBeCloseTo(19, 5);
         |                      ^
      72 |     });
      73 |
      74 |     test('accepts k=0 (minimum value)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:71:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ accepts k=0 (minimum value)

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NUM!]

      75 |       const range = setupData([5, 10, 15, 20]);
      76 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0)`);
    > 77 |       expect(result).toBe(5);
         |                      ^
      78 |     });
      79 |
      80 |     test('accepts k=1 (maximum value)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:77:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ accepts k=1 (maximum value)

    expect(received).toBe(expected) // Object.is equality

    Expected: 20
    Received: [Error: #NUM!]

      81 |       const range = setupData([5, 10, 15, 20]);
      82 |       const result = evaluate(`=PERCENTILE.INC(${range}, 1)`);
    > 83 |       expect(result).toBe(20);
         |                      ^
      84 |     });
      85 |
      86 |     test('works with unsorted data', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:83:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ works with unsorted data

    expect(received).toBe(expected) // Object.is equality

    Expected: 30
    Received: [Error: #NUM!]

      87 |       const range = setupData([50, 10, 30, 20, 40]);
      88 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.5)`);
    > 89 |       expect(result).toBe(30);
         |                      ^
      90 |     });
      91 |
      92 |     test('handles duplicates', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:89:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ handles duplicates

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: [Error: #NUM!]

      93 |       const range = setupData([1, 2, 2, 3, 4]);
      94 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.5)`);
    > 95 |       expect(result).toBe(2);
         |                      ^
      96 |     });
      97 |
      98 |     test('returns #NUM! for k < 0', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:95:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.INC (Inclusive Method) ‚Ä∫ matches Excel reference values

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NUM!]

      117 |       const range = setupData([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);
      118 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.3)`);
    > 119 |       expect(result).toBeCloseTo(3.7, 5);
          |                      ^
      120 |     });
      121 |   });
      122 |

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:119:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.EXC (Exclusive Method) ‚Ä∫ calculates 50th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: [Error: #NUM!]

      125 |       const range = setupData([1, 2, 3, 4, 5]);
      126 |       const result = evaluate(`=PERCENTILE.EXC(${range}, 0.5)`);
    > 127 |       expect(result).toBe(3);
          |                      ^
      128 |     });
      129 |
      130 |     test('calculates 25th percentile', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:127:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE.EXC (Exclusive Method) ‚Ä∫ calculates 25th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: [Error: #NUM!]

      131 |       const range = setupData([1, 2, 3, 4, 5, 6, 7]);
      132 |       const result = evaluate(`=PERCENTILE.EXC(${range}, 0.25)`);
    > 133 |       expect(result).toBe(2);
          |                      ^
      134 |     });
      135 |
      136 |     test('returns #NUM! for k=0 (exclusive boundaries)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:133:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ PERCENTILE (Alias for PERCENTILE.INC) ‚Ä∫ behaves identically to PERCENTILE.INC

    expect(received).toBe(expected) // Object.is equality

    If it should pass with deep equality, replace "toBe" with "toStrictEqual"

    Expected: [Error: #NUM!]
    Received: serializes to the same string

      171 |       const percentile = evaluate(`=PERCENTILE(${range}, 0.75)`);
      172 |       const percentile_inc = evaluate(`=PERCENTILE.INC(${range}, 0.75)`);
    > 173 |       expect(percentile).toBe(percentile_inc);
          |                          ^
      174 |     });
      175 |   });
      176 |

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:173:26)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ Q0 returns minimum

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #NUM!]

      182 |       const range = setupData([1, 2, 3, 4, 5]);
      183 |       const result = evaluate(`=QUARTILE.INC(${range}, 0)`)
    > 184 |       expect(result).toBe(1);
          |                      ^
      185 |     });
      186 |
      187 |     test('Q1 returns 25th percentile', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:184:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ Q1 returns 25th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: [Error: #NUM!]

      188 |       const range = setupData([1, 2, 3, 4, 5]);
      189 |       const result = evaluate(`=QUARTILE.INC(${range}, 1)`)
    > 190 |       expect(result).toBe(2);
          |                      ^
      191 |     });
      192 |
      193 |     test('Q2 returns median (50th percentile)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:190:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ Q2 returns median (50th percentile)

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: [Error: #NUM!]

      194 |       const range = setupData([1, 2, 3, 4, 5]);
      195 |       const result = evaluate(`=QUARTILE.INC(${range}, 2)`)
    > 196 |       expect(result).toBe(3);
          |                      ^
      197 |     });
      198 |
      199 |     test('Q3 returns 75th percentile', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:196:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ Q3 returns 75th percentile

    expect(received).toBe(expected) // Object.is equality

    Expected: 4
    Received: [Error: #NUM!]

      200 |       const range = setupData([1, 2, 3, 4, 5]);
      201 |       const result = evaluate(`=QUARTILE.INC(${range}, 3)`)
    > 202 |       expect(result).toBe(4);
          |                      ^
      203 |     });
      204 |
      205 |     test('Q4 returns maximum', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:202:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ Q4 returns maximum

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NUM!]

      206 |       const range = setupData([1, 2, 3, 4, 5]);
      207 |       const result = evaluate(`=QUARTILE.INC(${range}, 4)`)
    > 208 |       expect(result).toBe(5);
          |                      ^
      209 |     });
      210 |
      211 |     test('returns #NUM! for quart < 0', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:208:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.INC ‚Ä∫ matches Excel reference values

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #NUM!]

      231 |       const range = setupData([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);
      232 |       const result = evaluate(`=QUARTILE.INC(${range}, 1)`)
    > 233 |       expect(result).toBeCloseTo(3.25, 5);
          |                      ^
      234 |     });
      235 |   });
      236 |

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:233:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.EXC ‚Ä∫ Q1 returns 25th percentile (exclusive)

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: [Error: #NUM!]

      239 |       const range = setupData([1, 2, 3, 4, 5, 6, 7]);
      240 |       const result = evaluate(`=QUARTILE.EXC(${range}, 1)`)
    > 241 |       expect(result).toBe(2);
          |                      ^
      242 |     });
      243 |
      244 |     test('Q2 returns median', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:241:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.EXC ‚Ä∫ Q2 returns median

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: [Error: #NUM!]

      245 |       const range = setupData([1, 2, 3, 4, 5]);
      246 |       const result = evaluate(`=QUARTILE.EXC(${range}, 2)`)
    > 247 |       expect(result).toBe(3);
          |                      ^
      248 |     });
      249 |
      250 |     test('Q3 returns 75th percentile (exclusive)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:247:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ QUARTILE.EXC ‚Ä∫ Q3 returns 75th percentile (exclusive)

    expect(received).toBe(expected) // Object.is equality

    Expected: 6
    Received: [Error: #NUM!]

      251 |       const range = setupData([1, 2, 3, 4, 5, 6, 7]);
      252 |       const result = evaluate(`=QUARTILE.EXC(${range}, 3)`)
    > 253 |       expect(result).toBe(6);
          |                      ^
      254 |     });
      255 |
      256 |     test('returns #NUM! for quart=0 (exclusive)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:253:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ Edge Cases ‚Ä∫ handles single-element arrays

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #NUM!]

      683 |     test('handles single-element arrays', () => {
      684 |       const range = setupData([5]);
    > 685 |       expect(evaluate(`=PERCENTILE.INC(${range}, 0.5)`)).toBe(5);
          |                                                          ^
      686 |       expect(evaluate(`=QUARTILE.INC(${range}, 2)`)).toBe(5);
      687 |       // TODO: LARGE and SMALL have broadcasting issue, skipping
      688 |       // expect(evaluate(`=LARGE(${range}, 1)`)).toBe(5);

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:685:58)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ Edge Cases ‚Ä∫ handles negative numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: -1
    Received: [Error: #NUM!]

      692 |     test('handles negative numbers', () => {
      693 |       const range1 = setupData([-5, -3, -1, 0, 1]);
    > 694 |       expect(evaluate(`=PERCENTILE.INC(${range1}, 0.5)`)).toBe(-1);
          |                                                           ^
      695 |       
      696 |       // TODO: RANK.EQ has broadcasting issue, skipping
      697 |       // const range2 = setupData([-5, -3, -1, 0, 1]);

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:694:59)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ Edge Cases ‚Ä∫ handles very large numbers

    expect(received).toBe(expected) // Object.is equality

    Expected: 2000000
    Received: [Error: #NUM!]

      702 |       const range = setupData([1000000, 2000000, 3000000]);
      703 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.5)`)
    > 704 |       expect(result).toBe(2000000);
          |                      ^
      705 |     });
      706 |
      707 |     test('handles decimal values', () => {

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:704:22)

  ‚óè Week 10 Day 1-2: Advanced Statistical Functions ‚Ä∫ Edge Cases ‚Ä∫ handles decimal values

    expect(received).toBe(expected) // Object.is equality

    Expected: 3.3
    Received: [Error: #NUM!]

      708 |       const range = setupData([1.1, 2.2, 3.3, 4.4, 5.5]);
      709 |       const result = evaluate(`=PERCENTILE.INC(${range}, 0.5)`)
    > 710 |       expect(result).toBe(3.3);
          |                      ^
      711 |     });
      712 |   });
      713 | });

      at Object.<anonymous> (__tests__/functions/statistical-advanced.test.ts:710:22)

FAIL packages/core/__tests__/functions/statistical-correlation.test.ts
  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ CORREL (Correlation Coefficient) ‚Ä∫ perfect positive correlation (y=2x)

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      41 |       setupData([1, 2, 3, 4, 5], [2, 4, 6, 8, 10]);
      42 |       const result = evaluate('=CORREL(A1:A5, B1:B5)');
    > 43 |       expect(result).toBeCloseTo(1.0, 10);
         |                      ^
      44 |     });
      45 |
      46 |     test('perfect negative correlation (y=-x+6)', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:43:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ CORREL (Correlation Coefficient) ‚Ä∫ perfect negative correlation (y=-x+6)

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      47 |       setupData([1, 2, 3, 4, 5], [5, 4, 3, 2, 1]);
      48 |       const result = evaluate('=CORREL(A1:A5, B1:B5)');
    > 49 |       expect(result).toBeCloseTo(-1.0, 10);
         |                      ^
      50 |     });
      51 |
      52 |     test('partial correlation', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:49:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ CORREL (Correlation Coefficient) ‚Ä∫ partial correlation

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has type:  object
    Received has value: [Error: #N/A]

      53 |       setupData([1, 2, 3, 4, 5], [2, 3, 5, 6, 9]);
      54 |       const result = evaluate('=CORREL(A1:A5, B1:B5)');
    > 55 |       expect(result).toBeGreaterThan(0.9);
         |                      ^
      56 |       expect(result).toBeLessThan(1.0);
      57 |     });
      58 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:55:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ CORREL (Correlation Coefficient) ‚Ä∫ zero variance returns error

    expect(received).toBe(expected) // Object.is equality

    Expected: "#DIV/0!"
    Received: "#N/A"

      68 |       const result = evaluate('=CORREL(A1:A3, B1:B3)');
      69 |       expect(result).toBeInstanceOf(Error);
    > 70 |       expect((result as Error).message).toBe('#DIV/0!');
         |                                         ^
      71 |     });
      72 |   });
      73 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:70:41)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ PEARSON (Alias for CORREL) ‚Ä∫ returns same result as CORREL

    expect(received).toBe(expected) // Object.is equality

    If it should pass with deep equality, replace "toBe" with "toStrictEqual"

    Expected: [Error: #N/A]
    Received: serializes to the same string

      77 |       const correl = evaluate('=CORREL(A1:A5, B1:B5)');
      78 |       const pearson = evaluate('=PEARSON(A1:A5, B1:B5)');
    > 79 |       expect(pearson).toBe(correl);
         |                       ^
      80 |     });
      81 |   });
      82 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:79:23)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ COVARIANCE.P (Population Covariance) ‚Ä∫ calculates positive covariance

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      85 |       setupData([1, 2, 3], [4, 5, 6]);
      86 |       const result = evaluate('=COVARIANCE.P(A1:A3, B1:B3)');
    > 87 |       expect(result).toBeCloseTo(0.6666666, 5);
         |                      ^
      88 |     });
      89 |
      90 |     test('calculates negative covariance', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:87:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ COVARIANCE.P (Population Covariance) ‚Ä∫ calculates negative covariance

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      91 |       setupData([1, 2, 3], [6, 5, 4]);
      92 |       const result = evaluate('=COVARIANCE.P(A1:A3, B1:B3)');
    > 93 |       expect(result).toBeCloseTo(-0.6666666, 5);
         |                      ^
      94 |     });
      95 |
      96 |     test('zero covariance for constant Y', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:93:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ COVARIANCE.P (Population Covariance) ‚Ä∫ zero covariance for constant Y

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #N/A]

       97 |       setupData([1, 2, 3], [2, 2, 2]);
       98 |       const result = evaluate('=COVARIANCE.P(A1:A3, B1:B3)');
    >  99 |       expect(result).toBe(0);
          |                      ^
      100 |     });
      101 |   });
      102 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:99:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ COVARIANCE.S (Sample Covariance) ‚Ä∫ calculates sample covariance

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: [Error: #N/A]

      105 |       setupData([1, 2, 3], [4, 5, 6]);
      106 |       const result = evaluate('=COVARIANCE.S(A1:A3, B1:B3)');
    > 107 |       expect(result).toBe(1);
          |                      ^
      108 |     });
      109 |
      110 |     test('different from population covariance', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:107:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ COVARIANCE.S (Sample Covariance) ‚Ä∫ different from population covariance

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has type:  object
    Received has value: [Error: #N/A]

      112 |       const covP = evaluate('=COVARIANCE.P(A1:A3, B1:B3)');
      113 |       const covS = evaluate('=COVARIANCE.S(A1:A3, B1:B3)');
    > 114 |       expect(covS).toBeGreaterThan(covP as number);
          |                    ^
      115 |     });
      116 |   });
      117 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:114:20)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ RSQ (R-Squared) ‚Ä∫ perfect fit returns 1

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      120 |       setupData([1, 2, 3, 4, 5], [2, 4, 6, 8, 10]);
      121 |       const result = evaluate('=RSQ(B1:B5, A1:A5)');
    > 122 |       expect(result).toBeCloseTo(1.0, 10);
          |                      ^
      123 |     });
      124 |
      125 |     test('perfect inverse returns 1', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:122:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ RSQ (R-Squared) ‚Ä∫ perfect inverse returns 1

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      126 |       setupData([1, 2, 3, 4, 5], [5, 4, 3, 2, 1]);
      127 |       const result = evaluate('=RSQ(B1:B5, A1:A5)');
    > 128 |       expect(result).toBeCloseTo(1.0, 10);
          |                      ^
      129 |     });
      130 |
      131 |     test('equals square of correlation', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:128:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ RSQ (R-Squared) ‚Ä∫ equals square of correlation

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      133 |       const correl = evaluate('=CORREL(B1:B4, A1:A4)') as number;
      134 |       const rsq = evaluate('=RSQ(B1:B4, A1:A4)');
    > 135 |       expect(rsq).toBeCloseTo(correl * correl, 10);
          |                   ^
      136 |     });
      137 |   });
      138 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:135:19)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ SLOPE (Linear Regression Slope) ‚Ä∫ calculates slope of y=2x

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      141 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      142 |       const result = evaluate('=SLOPE(B1:B4, A1:A4)');
    > 143 |       expect(result).toBeCloseTo(2.0, 10);
          |                      ^
      144 |     });
      145 |
      146 |     test('calculates slope of y=0.5x', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:143:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ SLOPE (Linear Regression Slope) ‚Ä∫ calculates slope of y=0.5x

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      147 |       setupData([1, 2, 3, 4], [0.5, 1, 1.5, 2]);
      148 |       const result = evaluate('=SLOPE(B1:B4, A1:A4)');
    > 149 |       expect(result).toBeCloseTo(0.5, 10);
          |                      ^
      150 |     });
      151 |
      152 |     test('negative slope', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:149:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ SLOPE (Linear Regression Slope) ‚Ä∫ negative slope

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      153 |       setupData([1, 2, 3, 4], [4, 3, 2, 1]);
      154 |       const result = evaluate('=SLOPE(B1:B4, A1:A4)');
    > 155 |       expect(result).toBeCloseTo(-1.0, 10);
          |                      ^
      156 |     });
      157 |
      158 |     test('horizontal line has zero slope', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:155:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ SLOPE (Linear Regression Slope) ‚Ä∫ horizontal line has zero slope

    expect(received).toBe(expected) // Object.is equality

    Expected: 0
    Received: [Error: #N/A]

      159 |       setupData([1, 2, 3, 4], [5, 5, 5, 5]);
      160 |       const result = evaluate('=SLOPE(B1:B4, A1:A4)');
    > 161 |       expect(result).toBe(0);
          |                      ^
      162 |     });
      163 |
      164 |     test('vertical line returns error', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:161:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ SLOPE (Linear Regression Slope) ‚Ä∫ vertical line returns error

    expect(received).toBe(expected) // Object.is equality

    Expected: "#DIV/0!"
    Received: "#N/A"

      166 |       const result = evaluate('=SLOPE(B1:B4, A1:A4)');
      167 |       expect(result).toBeInstanceOf(Error);
    > 168 |       expect((result as Error).message).toBe('#DIV/0!');
          |                                         ^
      169 |     });
      170 |   });
      171 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:168:41)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ INTERCEPT (Y-Intercept) ‚Ä∫ y=2x intercept is 0

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      174 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      175 |       const result = evaluate('=INTERCEPT(B1:B4, A1:A4)');
    > 176 |       expect(result).toBeCloseTo(0, 10);
          |                      ^
      177 |     });
      178 |
      179 |     test('y=2x+3 intercept is 3', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:176:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ INTERCEPT (Y-Intercept) ‚Ä∫ y=2x+3 intercept is 3

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      180 |       setupData([1, 2, 3, 4], [5, 7, 9, 11]);
      181 |       const result = evaluate('=INTERCEPT(B1:B4, A1:A4)');
    > 182 |       expect(result).toBeCloseTo(3, 10);
          |                      ^
      183 |     });
      184 |
      185 |     test('negative intercept', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:182:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ INTERCEPT (Y-Intercept) ‚Ä∫ negative intercept

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      186 |       setupData([1, 2, 3, 4], [-1, 1, 3, 5]);
      187 |       const result = evaluate('=INTERCEPT(B1:B4, A1:A4)');
    > 188 |       expect(result).toBeCloseTo(-3, 10);
          |                      ^
      189 |     });
      190 |
      191 |     test('horizontal line', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:188:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ INTERCEPT (Y-Intercept) ‚Ä∫ horizontal line

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: [Error: #N/A]

      192 |       setupData([1, 2, 3, 4], [5, 5, 5, 5]);
      193 |       const result = evaluate('=INTERCEPT(B1:B4, A1:A4)');
    > 194 |       expect(result).toBe(5);
          |                      ^
      195 |     });
      196 |   });
      197 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:194:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST.LINEAR (Linear Prediction) ‚Ä∫ predicts on y=2x line

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      200 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      201 |       const result = evaluate('=FORECAST.LINEAR(5, B1:B4, A1:A4)');
    > 202 |       expect(result).toBeCloseTo(10, 10);
          |                      ^
      203 |     });
      204 |
      205 |     test('predicts on y=2x+3 line', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:202:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST.LINEAR (Linear Prediction) ‚Ä∫ predicts on y=2x+3 line

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      206 |       setupData([1, 2, 3, 4], [5, 7, 9, 11]);
      207 |       const result = evaluate('=FORECAST.LINEAR(5, B1:B4, A1:A4)');
    > 208 |       expect(result).toBeCloseTo(13, 10);
          |                      ^
      209 |     });
      210 |
      211 |     test('interpolation within range', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:208:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST.LINEAR (Linear Prediction) ‚Ä∫ interpolation within range

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      212 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      213 |       const result = evaluate('=FORECAST.LINEAR(2.5, B1:B4, A1:A4)');
    > 214 |       expect(result).toBeCloseTo(5, 10);
          |                      ^
      215 |     });
      216 |
      217 |     test('extrapolation beyond range', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:214:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST.LINEAR (Linear Prediction) ‚Ä∫ extrapolation beyond range

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      218 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      219 |       const result = evaluate('=FORECAST.LINEAR(10, B1:B4, A1:A4)');
    > 220 |       expect(result).toBeCloseTo(20, 10);
          |                      ^
      221 |     });
      222 |
      223 |     test('negative x value', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:220:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST.LINEAR (Linear Prediction) ‚Ä∫ negative x value

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      224 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      225 |       const result = evaluate('=FORECAST.LINEAR(-1, B1:B4, A1:A4)');
    > 226 |       expect(result).toBeCloseTo(-2, 10);
          |                      ^
      227 |     });
      228 |   });
      229 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:226:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ FORECAST (Alias) ‚Ä∫ returns same result as FORECAST.LINEAR

    expect(received).toBe(expected) // Object.is equality

    If it should pass with deep equality, replace "toBe" with "toStrictEqual"

    Expected: [Error: #N/A]
    Received: serializes to the same string

      233 |       const linear = evaluate('=FORECAST.LINEAR(5, B1:B4, A1:A4)');
      234 |       const forecast = evaluate('=FORECAST(5, B1:B4, A1:A4)');
    > 235 |       expect(forecast).toBe(linear);
          |                        ^
      236 |     });
      237 |   });
      238 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:235:24)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ STEYX (Standard Error) ‚Ä∫ perfect fit has zero error

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      241 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      242 |       const result = evaluate('=STEYX(B1:B4, A1:A4)');
    > 243 |       expect(result).toBeCloseTo(0, 10);
          |                      ^
      244 |     });
      245 |
      246 |     test('calculates error for imperfect fit', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:243:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ STEYX (Standard Error) ‚Ä∫ calculates error for imperfect fit

    expect(received).toBeGreaterThan(expected)

    Matcher error: received value must be a number or bigint

    Received has type:  object
    Received has value: [Error: #N/A]

      247 |       setupData([1, 2, 3, 4], [2, 3, 5, 6]);
      248 |       const result = evaluate('=STEYX(B1:B4, A1:A4)');
    > 249 |       expect(result).toBeGreaterThan(0);
          |                      ^
      250 |       expect(result).toBeLessThan(1);
      251 |     });
      252 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:249:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ STEYX (Standard Error) ‚Ä∫ requires at least 3 points

    expect(received).toBe(expected) // Object.is equality

    Expected: "#DIV/0!"
    Received: "#N/A"

      255 |       const result = evaluate('=STEYX(B1:B2, A1:A2)');
      256 |       expect(result).toBeInstanceOf(Error);
    > 257 |       expect((result as Error).message).toBe('#DIV/0!');
          |                                         ^
      258 |     });
      259 |   });
      260 |

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:257:41)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ TREND (Linear Trend) ‚Ä∫ returns fitted values for known X

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      263 |       setupData([1, 2, 3, 4], [2, 4, 6, 8]);
      264 |       const result = evaluate('=TREND(B1:B4, A1:A4)');
    > 265 |       expect(Array.isArray(result)).toBe(true);
          |                                     ^
      266 |       if (Array.isArray(result)) {
      267 |         expect(result.length).toBe(4);
      268 |         expect(result[0]).toBeCloseTo(2, 10);

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:265:37)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ TREND (Linear Trend) ‚Ä∫ predicts for new X values

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      277 |       worksheet.setCellValue({ row: 2, col: 3 }, 6);
      278 |       const result = evaluate('=TREND(B1:B4, A1:A4, C1:C2)');
    > 279 |       expect(Array.isArray(result)).toBe(true);
          |                                     ^
      280 |       if (Array.isArray(result)) {
      281 |         expect(result[0]).toBeCloseTo(10, 10);
      282 |         expect(result[1]).toBeCloseTo(12, 10);

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:279:37)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Integration Tests ‚Ä∫ complete regression analysis (y=3x+2)

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      294 |       const forecast = evaluate('=FORECAST.LINEAR(6, B1:B5, A1:A5)');
      295 |       
    > 296 |       expect(slope).toBeCloseTo(3, 10);
          |                     ^
      297 |       expect(intercept).toBeCloseTo(2, 10);
      298 |       expect(rsq).toBeCloseTo(1, 10);
      299 |       expect(forecast).toBeCloseTo(20, 10);

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:296:21)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Integration Tests ‚Ä∫ correlation and covariance relationship

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      306 |       const covS = evaluate('=COVARIANCE.S(A1:A5, B1:B5)');
      307 |       
    > 308 |       expect(correl).toBeCloseTo(1, 10);
          |                      ^
      309 |       expect(covS).toBeGreaterThan(0);
      310 |     });
      311 |   });

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:308:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Edge Cases ‚Ä∫ handles negative values

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      321 |       setupData([1, 2, 3], [-2, -4, -6]);
      322 |       const slope = evaluate('=SLOPE(B1:B3, A1:A3)');
    > 323 |       expect(slope).toBeCloseTo(-2, 10);
          |                     ^
      324 |     });
      325 |
      326 |     test('handles mixed positive/negative', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:323:21)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Edge Cases ‚Ä∫ handles mixed positive/negative

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      327 |       setupData([-1, 0, 1], [-2, 0, 2]);
      328 |       const correl = evaluate('=CORREL(A1:A3, B1:B3)');
    > 329 |       expect(correl).toBeCloseTo(1, 10);
          |                      ^
      330 |     });
      331 |
      332 |     test('large numbers maintain precision', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:329:22)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Edge Cases ‚Ä∫ large numbers maintain precision

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      333 |       setupData([1, 2, 3], [1000000, 2000000, 3000000]);
      334 |       const slope = evaluate('=SLOPE(B1:B3, A1:A3)');
    > 335 |       expect(slope).toBeCloseTo(1000000, 5);
          |                     ^
      336 |     });
      337 |
      338 |     test('decimal precision', () => {

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:335:21)

  ‚óè Statistical Functions - Correlation & Regression (Week 8 Day 2-3) ‚Ä∫ Edge Cases ‚Ä∫ decimal precision

    expect(received).toBeCloseTo(expected, precision)

    Matcher error: received value must be a number

    Received has type:  object
    Received has value: [Error: #N/A]

      339 |       setupData([1, 2, 3], [0.1, 0.2, 0.3]);
      340 |       const slope = evaluate('=SLOPE(B1:B3, A1:A3)');
    > 341 |       expect(slope).toBeCloseTo(0.1, 10);
          |                     ^
      342 |     });
      343 |   });
      344 | });

      at Object.<anonymous> (__tests__/functions/statistical-correlation.test.ts:341:21)

FAIL packages/core/__tests__/functions/statistical-week2-day1.test.ts
  ‚óè Statistical Functions - Week 2 Day 1 (T-Distribution) ‚Ä∫ T.TEST - Student's T-Test ‚Ä∫ Oracle Test 1: Paired two-tailed test

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      231 |       // T.TEST with paired samples, two-tailed
      232 |       const result = evaluate('=T.TEST(A1:A9, B1:B9, 2, 1)');
    > 233 |       expect(typeof result).toBe('number');
          |                             ^
      234 |       expect(result as number).toBeGreaterThan(0);
      235 |       expect(result as number).toBeLessThan(1);
      236 |     });

      at Object.<anonymous> (__tests__/functions/statistical-week2-day1.test.ts:233:29)

  ‚óè Statistical Functions - Week 2 Day 1 (T-Distribution) ‚Ä∫ T.TEST - Student's T-Test ‚Ä∫ Oracle Test 2: Two-sample equal variance

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      239 |       // T.TEST with equal variance assumption
      240 |       const result = evaluate('=T.TEST(A1:A9, B1:B9, 2, 2)');
    > 241 |       expect(typeof result).toBe('number');
          |                             ^
      242 |       expect(result as number).toBeGreaterThan(0);
      243 |       expect(result as number).toBeLessThan(1);
      244 |     });

      at Object.<anonymous> (__tests__/functions/statistical-week2-day1.test.ts:241:29)

  ‚óè Statistical Functions - Week 2 Day 1 (T-Distribution) ‚Ä∫ T.TEST - Student's T-Test ‚Ä∫ Oracle Test 3: Two-sample unequal variance (Welch)

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      247 |       // T.TEST with unequal variance (Welch's t-test)
      248 |       const result = evaluate('=T.TEST(A1:A9, B1:B9, 2, 3)');
    > 249 |       expect(typeof result).toBe('number');
          |                             ^
      250 |       expect(result as number).toBeGreaterThan(0);
      251 |       expect(result as number).toBeLessThan(1);
      252 |     });

      at Object.<anonymous> (__tests__/functions/statistical-week2-day1.test.ts:249:29)

  ‚óè Statistical Functions - Week 2 Day 1 (T-Distribution) ‚Ä∫ T.TEST - Student's T-Test ‚Ä∫ Oracle Test 4: One-tailed test

    expect(received).toBe(expected) // Object.is equality

    Expected: "number"
    Received: "object"

      255 |       // T.TEST with one tail
      256 |       const result = evaluate('=T.TEST(A1:A9, B1:B9, 1, 2)');
    > 257 |       expect(typeof result).toBe('number');
          |                             ^
      258 |       expect(result as number).toBeGreaterThan(0);
      259 |       expect(result as number).toBeLessThan(1);
      260 |     });

      at Object.<anonymous> (__tests__/functions/statistical-week2-day1.test.ts:257:29)

FAIL packages/core/test/benchmarks/hashFunction.bench.test.ts
  ‚óè Hash Function Quality Benchmarks ‚Ä∫ Hash Performance ‚Ä∫ Hash computation <0.01ms avg

    expect(received).toBeLessThan(expected)

    Expected: < 0.01
    Received:   0.04497176800000125

      189 |       console.log('[Performance] Total time:', (end - start).toFixed(2) + 'ms for 1000 styles');
      190 |       
    > 191 |       expect(avgTime).toBeLessThan(0.01); // <0.01ms per hash
          |                       ^
      192 |     });
      193 |   });
      194 | });

      at Object.<anonymous> (test/benchmarks/hashFunction.bench.test.ts:191:23)

FAIL packages/core/test/benchmarks/styleCache.step2.bench.test.ts (11.252 s)
  ‚óè StyleCache with Freeze (Step 2.2) ‚Ä∫ Typical workload: 100k cells, 50 unique styles WITH deep freeze

    expect(received).toBeLessThan(expected)

    Expected: < 0.005
    Received:   0.011593552700000828

      56 |     
      57 |     // Gate: Intern avg ‚â§ 5¬µs
    > 58 |     expect(avgIntern).toBeLessThan(0.005);
         |                       ^
      59 |     
      60 |     // Gate: Hit rate ‚â•99.95%
      61 |     expect(hitRate).toBeGreaterThanOrEqual(0.9995);

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:58:23)

  ‚óè StyleCache with Freeze (Step 2.2) ‚Ä∫ High diversity: 500k cells, 5000 unique styles (Rich Text Phase 2 scenario)

    expect(received).toBeLessThan(expected)

    Expected: < 0.005
    Received:   0.01175183478400137

      108 |     
      109 |     // Gate: Intern avg ‚â§ 5¬µs
    > 110 |     expect(avgIntern).toBeLessThan(0.005);
          |                       ^
      111 |     
      112 |     // Gate: Hit rate ‚â•99% (relaxed for high diversity)
      113 |     expect(hitRate).toBeGreaterThanOrEqual(0.99);

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:110:23)

  ‚óè StyleCache with Freeze (Step 2.2) ‚Ä∫ Memory leak check: 10 cycles of 10k interns + clear

    expect(received).toBeLessThan(expected)

    Expected: < 102400
    Received:   5288000

      200 |     
      201 |     // Gate: Memory growth <100 KB (acceptable for GC noise)
    > 202 |     expect(Math.abs(memoryGrowth)).toBeLessThan(100 * 1024);
          |                                    ^
      203 |   });
      204 |   
      205 |   // ============================================================

      at Object.<anonymous> (test/benchmarks/styleCache.step2.bench.test.ts:202:36)

FAIL packages/renderer-canvas/__tests__/chart-manager.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/chart-manager.test.ts[0m:[93m9[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ChartCreateParams'.

    [7m9[0m import type { ChartCreateParams, ChartObject } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/__tests__/chart-manager.test.ts[0m:[93m9[0m:[93m34[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ChartObject'.

    [7m9[0m import type { ChartCreateParams, ChartObject } from '@cyber-sheet/core';
    [7m [0m [91m                                 ~~~~~~~~~~~[0m

FAIL packages/core/__tests__/registry/autocomplete.test.ts
  ‚óè Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (../../node_modules/@jest/core/build/TestScheduler.js:133:18)
      at ../../node_modules/@jest/core/build/TestScheduler.js:254:19
      at ../../node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (../../node_modules/emittery/index.js:361:23)

FAIL packages/core/__tests__/debug-correlation.test.ts
  ‚óè Test suite failed to run

    Your test suite must contain at least one test.

      at onResult (../../node_modules/@jest/core/build/TestScheduler.js:133:18)
      at ../../node_modules/@jest/core/build/TestScheduler.js:254:19
      at ../../node_modules/emittery/index.js:363:13
          at Array.map (<anonymous>)
      at Emittery.emit (../../node_modules/emittery/index.js:361:23)

FAIL packages/renderer-canvas/__tests__/advanced-chart-renderer.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/advanced-chart-renderer.test.ts[0m:[93m9[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ComboChartConfig'.

    [7m9[0m import type { ComboChartConfig, AdvancedChartOptions } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/__tests__/advanced-chart-renderer.test.ts[0m:[93m9[0m:[93m33[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AdvancedChartOptions'.

    [7m9[0m import type { ComboChartConfig, AdvancedChartOptions } from '@cyber-sheet/core';
    [7m [0m [91m                                ~~~~~~~~~~~~~~~~~~~~[0m

FAIL packages/core/test/benchmarks/layout.bench.test.ts
  ‚óè Test suite failed to run

    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m45[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m45[0m     const input: LayoutInput = {
    [7m  [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m88[0m:[93m13[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m88[0m       const input: LayoutInput = {
    [7m  [0m [91m            ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m112[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m112[0m     const input: LayoutInput = {
    [7m   [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m149[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m149[0m     const input1: LayoutInput = { value: 'Test', style: style1, width: 100 };
    [7m   [0m [91m          ~~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m150[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m150[0m     const input2: LayoutInput = { value: 'Test', style: style2, width: 100 };
    [7m   [0m [91m          ~~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m151[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m151[0m     const input3: LayoutInput = { value: 'Test', style: style3, width: 100 };
    [7m   [0m [91m          ~~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m175[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m175[0m     const input: LayoutInput = { value: 'Test', style, width: 100 };
    [7m   [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m188[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m188[0m     const input: LayoutInput = { value: '', style, width: 100 };
    [7m   [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m203[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m203[0m     const input: LayoutInput = { value: 'Test', style, width: 100 };
    [7m   [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.
    [96mpackages/core/test/benchmarks/layout.bench.test.ts[0m:[93m211[0m:[93m11[0m - [91merror[0m[90m TS2741: [0mProperty 'height' is missing in type '{ value: string; style: CellStyle; width: number; }' but required in type 'LayoutInput'.

    [7m211[0m     const input: LayoutInput = {
    [7m   [0m [91m          ~~~~~[0m

      [96mpackages/core/src/CellLayout.ts[0m:[93m44[0m:[93m12[0m
        [7m44[0m   readonly height: number;  // Cell height for vertical alignment
        [7m  [0m [96m           ~~~~~~[0m
        'height' is declared here.

FAIL packages/core/__tests__/ChartBuilderController.test.ts
  ‚óè Test suite failed to run

    [96mpackages/core/__tests__/ChartBuilderController.test.ts[0m:[93m9[0m:[93m27[0m - [91merror[0m[90m TS2307: [0mCannot find module '@cyber-sheet/core' or its corresponding type declarations.

    [7m9[0m import { Worksheet } from '@cyber-sheet/core';
    [7m [0m [91m                          ~~~~~~~~~~~~~~~~~~~[0m

FAIL packages/renderer-canvas/__tests__/trendline-calculator.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/src/TrendlineCalculator.ts[0m:[93m8[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'TrendlineType'.

    [7m8[0m import type { TrendlineType, TrendlineResult } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/TrendlineCalculator.ts[0m:[93m8[0m:[93m30[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'TrendlineResult'.

    [7m8[0m import type { TrendlineType, TrendlineResult } from '@cyber-sheet/core';
    [7m [0m [91m                             ~~~~~~~~~~~~~~~[0m

FAIL packages/renderer-canvas/__tests__/axis-scaler.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/axis-scaler.test.ts[0m:[93m9[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AxisScale'.

    [7m9[0m import type { AxisScale, AxisBounds, AxisConfig } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~[0m
    [96mpackages/renderer-canvas/__tests__/axis-scaler.test.ts[0m:[93m9[0m:[93m26[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AxisBounds'.

    [7m9[0m import type { AxisScale, AxisBounds, AxisConfig } from '@cyber-sheet/core';
    [7m [0m [91m                         ~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/__tests__/axis-scaler.test.ts[0m:[93m9[0m:[93m38[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AxisConfig'.

    [7m9[0m import type { AxisScale, AxisBounds, AxisConfig } from '@cyber-sheet/core';
    [7m [0m [91m                                     ~~~~~~~~~~[0m

FAIL packages/renderer-canvas/__tests__/chart-data-adapter.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/chart-data-adapter.test.ts[0m:[93m9[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'CellRange'.

    [7m9[0m import type { CellRange } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~[0m

FAIL packages/renderer-canvas/__tests__/chart-engine-integration.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m14[0m:[93m3[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ExtendedChartType'.

    [7m14[0m   ExtendedChartType,
    [7m  [0m [91m  ~~~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m15[0m:[93m3[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AdvancedChartOptions'.

    [7m15[0m   AdvancedChartOptions,
    [7m  [0m [91m  ~~~~~~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m16[0m:[93m3[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'TrendlineConfig'.

    [7m16[0m   TrendlineConfig,
    [7m  [0m [91m  ~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m17[0m:[93m3[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'AxisConfig'.

    [7m17[0m   AxisConfig,
    [7m  [0m [91m  ~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m18[0m:[93m3[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ComboChartConfig'.

    [7m18[0m   ComboChartConfig
    [7m  [0m [91m  ~~~~~~~~~~~~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m176[0m:[93m33[0m - [91merror[0m[90m TS7006: [0mParameter 'point' implicitly has an 'any' type.

    [7m176[0m       trendline.points.forEach((point, idx) => {
    [7m   [0m [91m                                ~~~~~[0m
    [96mpackages/renderer-canvas/src/ChartEngineIntegration.ts[0m:[93m176[0m:[93m40[0m - [91merror[0m[90m TS7006: [0mParameter 'idx' implicitly has an 'any' type.

    [7m176[0m       trendline.points.forEach((point, idx) => {
    [7m   [0m [91m                                       ~~~[0m

FAIL packages/renderer-canvas/__tests__/chart-renderer.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/chart-renderer.test.ts[0m:[93m8[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ChartObject'.

    [7m8[0m import type { ChartObject } from '@cyber-sheet/core';
    [7m [0m [91m              ~~~~~~~~~~~[0m

FAIL packages/renderer-canvas/__tests__/phase1-ui-performance.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/__tests__/phase1-ui-performance.test.ts[0m:[93m22[0m:[93m13[0m - [91merror[0m[90m TS2554: [0mExpected 1-5 arguments, but got 0.

    [7m22[0m     sheet = new Worksheet();
    [7m  [0m [91m            ~~~~~~~~~~~~~~~[0m

      [96mpackages/core/src/worksheet.ts[0m:[93m23[0m:[93m15[0m
        [7m23[0m   constructor(name: string, rows = 1000, cols = 26, engine?: IFormulaEngine, workbook?: any) {
        [7m  [0m [96m              ~~~~~~~~~~~~[0m
        An argument for 'name' was not provided.
    [96mpackages/renderer-canvas/__tests__/phase1-ui-performance.test.ts[0m:[93m53[0m:[93m15[0m - [91merror[0m[90m TS2551: [0mProperty 'setCell' does not exist on type 'Worksheet'. Did you mean 'getCell'?

    [7m53[0m         sheet.setCell({ row, col }, {
    [7m  [0m [91m              ~~~~~~~[0m

      [96mpackages/core/src/worksheet.ts[0m:[93m35[0m:[93m3[0m
        [7m35[0m   getCell(addr: Address): Cell | undefined {
        [7m  [0m [96m  ~~~~~~~[0m
        'getCell' is declared here.
    [96mpackages/renderer-canvas/__tests__/phase1-ui-performance.test.ts[0m:[93m109[0m:[93m15[0m - [91merror[0m[90m TS2551: [0mProperty 'setCell' does not exist on type 'Worksheet'. Did you mean 'getCell'?

    [7m109[0m         sheet.setCell({ row, col }, {
    [7m   [0m [91m              ~~~~~~~[0m

      [96mpackages/core/src/worksheet.ts[0m:[93m35[0m:[93m3[0m
        [7m35[0m   getCell(addr: Address): Cell | undefined {
        [7m  [0m [96m  ~~~~~~~[0m
        'getCell' is declared here.
    [96mpackages/renderer-canvas/__tests__/phase1-ui-performance.test.ts[0m:[93m160[0m:[93m15[0m - [91merror[0m[90m TS2551: [0mProperty 'setCell' does not exist on type 'Worksheet'. Did you mean 'getCell'?

    [7m160[0m         sheet.setCell({ row, col }, {
    [7m   [0m [91m              ~~~~~~~[0m

      [96mpackages/core/src/worksheet.ts[0m:[93m35[0m:[93m3[0m
        [7m35[0m   getCell(addr: Address): Cell | undefined {
        [7m  [0m [96m  ~~~~~~~[0m
        'getCell' is declared here.

FAIL packages/renderer-canvas/__tests__/chart-interaction-manager.test.ts
  ‚óè Test suite failed to run

    [96mpackages/renderer-canvas/src/ChartInteractionManager.ts[0m:[93m10[0m:[93m15[0m - [91merror[0m[90m TS2305: [0mModule '"@cyber-sheet/core"' has no exported member 'ChartObject'.

    [7m10[0m import type { ChartObject } from '@cyber-sheet/core';
    [7m  [0m [91m              ~~~~~~~~~~~[0m

FAIL packages/core/test/benchmarks/styleCache.stress.bench.test.ts (16.342 s)
  ‚óè StyleCache Final Stress Test (Production Scale) ‚Ä∫ 1M cells, typical enterprise patterns (50 unique styles)

    expect(received).toBeLessThan(expected)

    Expected: < 5000
    Received:   6370.253398

      76 |     
      77 |     // Gate: Performance <5s
    > 78 |     expect(elapsed).toBeLessThan(5000);
         |                     ^
      79 |     
      80 |     // Gate: Avg intern <5¬µs
      81 |     expect(avgIntern).toBeLessThan(0.005);

      at Object.<anonymous> (test/benchmarks/styleCache.stress.bench.test.ts:78:21)


Test Suites: 52 failed, 101 passed, 153 total
Tests:       525 failed, 63 skipped, 9 todo, 4101 passed, 4698 total
Snapshots:   0 total
Time:        18.286 s
Ran all test suites in 3 projects.
